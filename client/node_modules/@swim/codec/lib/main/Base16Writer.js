import { __extends } from "tslib";
import { WriterException } from "./WriterException";
import { Writer } from "./Writer";
import { Base16 } from "./Base16";
var Base16Writer = (function (_super) {
    __extends(Base16Writer, _super);
    function Base16Writer(value, input, base16, index, step) {
        if (index === void 0) { index = 0; }
        if (step === void 0) { step = 1; }
        var _this = _super.call(this) || this;
        _this._value = value;
        _this._input = input;
        _this._base16 = base16;
        _this._index = index;
        _this._step = step;
        return _this;
    }
    Base16Writer.prototype.feed = function (value) {
        if (value instanceof Uint8Array) {
            return new Base16Writer(undefined, value, this._base16);
        }
        else {
            throw new TypeError("" + value);
        }
    };
    Base16Writer.prototype.pull = function (output) {
        return Base16Writer.write(output, this._value, this._input, this._base16, this._index, this._step);
    };
    Base16Writer.write = function (output, value, input, base16, index, step) {
        if (index === void 0) { index = 0; }
        if (step === void 0) { step = 1; }
        while (index < input.length) {
            var x = input[index];
            if (step === 1 && output.isCont()) {
                output = output.write(base16.encodeDigit(x >>> 4));
                step = 2;
            }
            if (step === 2 && output.isCont()) {
                output = output.write(base16.encodeDigit(x & 0x0f));
                index += 1;
                step = 1;
            }
        }
        if (index === input.length) {
            return Writer.done(value);
        }
        else if (output.isDone()) {
            return Writer.error(new WriterException("truncated"));
        }
        else if (output.isError()) {
            return Writer.error(output.trap());
        }
        return new Base16Writer(value, input, base16, index, step);
    };
    return Base16Writer;
}(Writer));
export { Base16Writer };
Base16.Writer = Base16Writer;
//# sourceMappingURL=Base16Writer.js.map