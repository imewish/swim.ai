import { __extends } from "tslib";
import { WriterException } from "./WriterException";
import { Writer } from "./Writer";
var StringWriter = (function (_super) {
    __extends(StringWriter, _super);
    function StringWriter(value, input, index) {
        if (index === void 0) { index = 0; }
        var _this = _super.call(this) || this;
        _this._value = value;
        _this._input = input;
        _this._index = index;
        return _this;
    }
    StringWriter.prototype.feed = function (input) {
        return new StringWriter(input, "" + input);
    };
    StringWriter.prototype.pull = function (output) {
        return StringWriter.write(output, this._value, this._input, this._index);
    };
    StringWriter.write = function (output, value, input, index) {
        if (index === void 0) { index = 0; }
        var length = input.length;
        while (index < length && output.isCont()) {
            var c = input.codePointAt(index);
            if (c === void 0) {
                c = input.charCodeAt(index);
            }
            output = output.write(c);
            index = input.offsetByCodePoints(index, 1);
        }
        if (index === length) {
            return Writer.done(value);
        }
        if (output.isDone()) {
            return Writer.error(new WriterException("truncated"));
        }
        else if (output.isError()) {
            return Writer.error(output.trap());
        }
        return new StringWriter(value, input, index);
    };
    return StringWriter;
}(Writer));
export { StringWriter };
//# sourceMappingURL=StringWriter.js.map