{"version":3,"file":"swim-client.js","sources":["../../main/host/Host.ts","../../../../../node_modules/tslib/tslib.es6.js","../../main/host/RemoteHost.ts","../../main/host/WebSocketHost.ts","../../main/downlink/DownlinkModel.ts","../../main/downlink/Downlink.ts","../../main/downlink/EventDownlinkModel.ts","../../main/downlink/EventDownlink.ts","../../main/downlink/ListDownlinkModel.ts","../../main/downlink/ListDownlink.ts","../../main/downlink/MapDownlinkModel.ts","../../main/downlink/MapDownlink.ts","../../main/downlink/ValueDownlinkModel.ts","../../main/downlink/ValueDownlink.ts","../../main/downlink/DownlinkRecord.ts","../../main/downlink/ListDownlinkRecord.ts","../../main/downlink/MapDownlinkRecord.ts","../../main/downlink/ValueDownlinkRecord.ts","../../main/downlink/DownlinkTransmuter.ts","../../main/downlink/DownlinkStreamlet.ts","../../main/ref/BaseRef.ts","../../main/ref/LaneRef.ts","../../main/ref/NodeRef.ts","../../main/ref/HostRef.ts","../../main/WarpClient.ts","../../main/index.ts"],"sourcesContent":["// Copyright 2015-2020 SWIM.AI inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {AnyUri, Uri} from \"@swim/uri\";\nimport {AnyValue, Value} from \"@swim/structure\";\nimport {Envelope} from \"@swim/warp\";\nimport {HostDownlink} from \"./HostDownlink\";\n\nexport interface HostOptions {\n  credentials?: Value;\n  unlinkDelay?: number;\n  maxReconnectTimeout?: number;\n  idleTimeout?: number;\n  sendBufferSize?: number;\n}\n\n/** @hidden */\nexport abstract class Host {\n  abstract hostUri(): Uri;\n\n  abstract unlinkDelay(): number;\n\n  abstract isConnected(): boolean;\n\n  abstract isAuthenticated(): boolean;\n\n  abstract session(): Value;\n\n  abstract resolve(relative: AnyUri): Uri;\n\n  abstract unresolve(absolute: AnyUri): Uri;\n\n  abstract authenticate(credentials: AnyValue): void;\n\n  abstract openDownlink(downlink: HostDownlink): void;\n\n  abstract unlinkDownlink(downlink: HostDownlink): void;\n\n  abstract closeDownlink(downlink: HostDownlink): void;\n\n  abstract command(nodeUri: AnyUri, laneUri: AnyUri, body: AnyValue): void;\n\n  abstract open(): void;\n\n  abstract close(): void;\n\n  abstract closeUp(): void;\n\n  abstract push(envelope: Envelope): void;\n}\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n    if (m) return m.call(o);\r\n    return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n","// Copyright 2015-2020 SWIM.AI inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {BTree} from \"@swim/collections\";\nimport {AnyUri, Uri, UriCache} from \"@swim/uri\";\nimport {AnyValue, Value} from \"@swim/structure\";\nimport {\n  Envelope,\n  EventMessage,\n  CommandMessage,\n  LinkRequest,\n  LinkedResponse,\n  SyncRequest,\n  SyncedResponse,\n  UnlinkRequest,\n  UnlinkedResponse,\n  AuthRequest,\n  AuthedResponse,\n  DeauthRequest,\n  DeauthedResponse,\n} from \"@swim/warp\";\nimport {HostDownlink} from \"./HostDownlink\";\nimport {HostContext} from \"./HostContext\";\nimport {HostOptions, Host} from \"./Host\";\n\nconst UNLINK_DELAY = 0;\nconst MAX_RECONNECT_TIMEOUT = 30000;\nconst IDLE_TIMEOUT = 1000;\nconst SEND_BUFFER_SIZE = 1024;\n\n/** @hidden */\nexport abstract class RemoteHost extends Host {\n  /** @hidden */\n  readonly _context: HostContext;\n  /** @hidden */\n  readonly _hostUri: Uri;\n  /** @hidden */\n  readonly _options: HostOptions;\n  /** @hidden */\n  _downlinks: BTree<Uri, BTree<Uri, HostDownlink>>;\n  /** @hidden */\n  _downlinkCount: number;\n  /** @hidden */\n  _authenticated: boolean;\n  /** @hidden */\n  _session: Value;\n  /** @hidden */\n  _uriCache: UriCache;\n  /** @hidden */\n  _sendBuffer: Envelope[];\n  /** @hidden */\n  _reconnectTimer: number;\n  /** @hidden */\n  _reconnectTimeout: number;\n  /** @hidden */\n  _idleTimer: number;\n\n  constructor(context: HostContext, hostUri: Uri, options: HostOptions = {}) {\n    super();\n    this._context = context;\n    this._hostUri = hostUri;\n    this._options = options;\n    this._downlinks = new BTree();\n    this._downlinkCount = 0;\n    this._authenticated = false;\n    this._session = Value.absent();\n    this._uriCache = new UriCache(hostUri);\n    this._sendBuffer = [];\n    this._reconnectTimer = 0;\n    this._reconnectTimeout = 0;\n    this._idleTimer = 0;\n  }\n\n  hostUri(): Uri {\n    return this._hostUri;\n  }\n\n  credentials(): Value {\n    return this._options.credentials || Value.absent();\n  }\n\n  unlinkDelay(): number {\n    const unlinkDelay = this._options.unlinkDelay;\n    return typeof unlinkDelay === \"number\" ? unlinkDelay : UNLINK_DELAY;\n  }\n\n  maxReconnectTimeout(): number {\n    return this._options.maxReconnectTimeout || MAX_RECONNECT_TIMEOUT;\n  }\n\n  idleTimeout(): number {\n    return this._options.idleTimeout || IDLE_TIMEOUT;\n  }\n\n  sendBufferSize(): number {\n    return this._options.sendBufferSize || SEND_BUFFER_SIZE;\n  }\n\n  abstract isConnected(): boolean;\n\n  isAuthenticated(): boolean {\n    return this._authenticated;\n  }\n\n  session(): Value {\n    return this._session;\n  }\n\n  isIdle(): boolean {\n    return !this._sendBuffer.length && !this._downlinkCount;\n  }\n\n  resolve(relative: AnyUri): Uri {\n    return this._uriCache.resolve(relative);\n  }\n\n  unresolve(absolute: AnyUri): Uri {\n    return this._uriCache.unresolve(absolute);\n  }\n\n  authenticate(credentials: AnyValue): void {\n    credentials = Value.fromAny(credentials);\n    if (!credentials.equals(this._options.credentials)) {\n      this._options.credentials = credentials;\n      if (this.isConnected()) {\n        const request = AuthRequest.of(credentials);\n        this.push(request);\n      } else {\n        this.open();\n      }\n    }\n  }\n\n  openDownlink(downlink: HostDownlink): void {\n    this.clearIdle();\n    const nodeUri = this.resolve(downlink.nodeUri());\n    const laneUri = downlink.laneUri();\n    if (!this._downlinkCount) {\n      this.open();\n    }\n    let nodeDownlinks = this._downlinks.get(nodeUri);\n    if (!nodeDownlinks) {\n      nodeDownlinks = new BTree();\n      this._downlinks.set(nodeUri, nodeDownlinks);\n    }\n    if (nodeDownlinks.get(laneUri)) {\n      throw new Error(\"duplicate downlink\");\n    }\n    nodeDownlinks.set(laneUri, downlink);\n    this._downlinkCount += 1;\n    downlink.openUp(this);\n    if (this.isConnected()) {\n      downlink.hostDidConnect(this);\n    }\n  }\n\n  unlinkDownlink(downlink: HostDownlink): void {\n    const nodeUri = this.resolve(downlink.nodeUri());\n    const laneUri = downlink.laneUri();\n    const nodeDownlinks = this._downlinks.get(nodeUri);\n    if (nodeDownlinks && nodeDownlinks.get(laneUri) && this.isConnected()) {\n      const request = UnlinkRequest.of(this.unresolve(nodeUri), laneUri);\n      downlink.onUnlinkRequest(request, this);\n      this.push(request);\n    }\n  }\n\n  closeDownlink(downlink: HostDownlink): void {\n    const nodeUri = this.resolve(downlink.nodeUri());\n    const laneUri = downlink.laneUri();\n    const nodeDownlinks = this._downlinks.get(nodeUri);\n    if (nodeDownlinks) {\n      if (nodeDownlinks.get(laneUri)) {\n        this._downlinkCount -= 1;\n        nodeDownlinks.delete(laneUri);\n        if (nodeDownlinks.isEmpty()) {\n          this._downlinks.delete(nodeUri);\n        }\n        if (!this._downlinkCount) {\n          this.watchIdle();\n        }\n        downlink.closeUp(this);\n      }\n    }\n  }\n\n  command(nodeUri: AnyUri, laneUri: AnyUri, body: AnyValue): void {\n    nodeUri = Uri.fromAny(nodeUri);\n    nodeUri = this.resolve(nodeUri);\n    laneUri = Uri.fromAny(laneUri);\n    body = Value.fromAny(body);\n    const message = CommandMessage.of(this.unresolve(nodeUri), laneUri, body);\n    this.push(message);\n  }\n\n  protected onEnvelope(envelope: Envelope): void {\n    if (envelope instanceof EventMessage) {\n      this.onEventMessage(envelope);\n    } else if (envelope instanceof CommandMessage) {\n      this.onCommandMessage(envelope);\n    } else if (envelope instanceof LinkRequest) {\n      this.onLinkRequest(envelope);\n    } else if (envelope instanceof LinkedResponse) {\n      this.onLinkedResponse(envelope);\n    } else if (envelope instanceof SyncRequest) {\n      this.onSyncRequest(envelope);\n    } else if (envelope instanceof SyncedResponse) {\n      this.onSyncedResponse(envelope);\n    } else if (envelope instanceof UnlinkRequest) {\n      this.onUnlinkRequest(envelope);\n    } else if (envelope instanceof UnlinkedResponse) {\n      this.onUnlinkedResponse(envelope);\n    } else if (envelope instanceof AuthRequest) {\n      this.onAuthRequest(envelope);\n    } else if (envelope instanceof AuthedResponse) {\n      this.onAuthedResponse(envelope);\n    } else if (envelope instanceof DeauthRequest) {\n      this.onDeauthRequest(envelope);\n    } else if (envelope instanceof DeauthedResponse) {\n      this.onDeauthedResponse(envelope);\n    } else {\n      this.onUnknownEnvelope(envelope);\n    }\n  }\n\n  protected onEventMessage(message: EventMessage): void {\n    const nodeUri = this.resolve(message.node());\n    const laneUri = message.lane();\n    const nodeDownlinks = this._downlinks.get(nodeUri);\n    if (nodeDownlinks) {\n      const downlink = nodeDownlinks.get(laneUri);\n      if (downlink) {\n        const resolvedMessage = message.node(nodeUri);\n        downlink.onEventMessage(resolvedMessage, this);\n      }\n    }\n  }\n\n  protected onCommandMessage(message: CommandMessage): void {\n    // TODO: client agents\n  }\n\n  protected onLinkRequest(request: LinkRequest): void {\n    // TODO: client agents\n  }\n\n  protected onLinkedResponse(response: LinkedResponse): void {\n    const nodeUri = this.resolve(response.node());\n    const laneUri = response.lane();\n    const nodeDownlinks = this._downlinks.get(nodeUri);\n    if (nodeDownlinks) {\n      const downlink = nodeDownlinks.get(laneUri);\n      if (downlink) {\n        const resolvedResponse = response.node(nodeUri);\n        downlink.onLinkedResponse(resolvedResponse, this);\n      }\n    }\n  }\n\n  protected onSyncRequest(request: SyncRequest): void {\n    // TODO: client agents\n  }\n\n  protected onSyncedResponse(response: SyncedResponse): void {\n    const nodeUri = this.resolve(response.node());\n    const laneUri = response.lane();\n    const nodeDownlinks = this._downlinks.get(nodeUri);\n    if (nodeDownlinks) {\n      const downlink = nodeDownlinks.get(laneUri);\n      if (downlink) {\n        const resolvedResponse = response.node(nodeUri);\n        downlink.onSyncedResponse(resolvedResponse, this);\n      }\n    }\n  }\n\n  protected onUnlinkRequest(request: UnlinkRequest): void {\n    // TODO: client agents\n  }\n\n  protected onUnlinkedResponse(response: UnlinkedResponse): void {\n    const nodeUri = this.resolve(response.node());\n    const laneUri = response.lane();\n    const nodeDownlinks = this._downlinks.get(nodeUri);\n    if (nodeDownlinks) {\n      const downlink = nodeDownlinks.get(laneUri);\n      if (downlink) {\n        const resolvedResponse = response.node(nodeUri);\n        downlink.onUnlinkedResponse(resolvedResponse, this);\n      }\n    }\n  }\n\n  protected onAuthRequest(request: AuthRequest): void {\n    // TODO: client agents\n  }\n\n  protected onAuthedResponse(response: AuthedResponse): void {\n    this._authenticated = true;\n    this._session = response.body();\n    this._context.hostDidAuthenticate(response.body(), this);\n  }\n\n  protected onDeauthRequest(request: DeauthRequest): void {\n    // TODO: client agents\n  }\n\n  protected onDeauthedResponse(response: DeauthedResponse): void {\n    this._authenticated = false;\n    this._session = Value.absent();\n    this._context.hostDidDeauthenticate(response.body(), this);\n  }\n\n  protected onUnknownEnvelope(envelope: Envelope | string): void {\n    // nop\n  }\n\n  protected onConnect(): void {\n    this._reconnectTimeout = 0;\n    this._context.hostDidConnect(this);\n    this._downlinks.forEach(function (nodeUri: Uri, nodeDownlinks: BTree<Uri, HostDownlink>): void {\n      nodeDownlinks.forEach(function (laneUri: Uri, downlink: HostDownlink): void {\n        downlink.hostDidConnect(this);\n      }, this);\n    }, this);\n  }\n\n  protected onDisconnect(): void {\n    this._authenticated = false;\n    this._session = Value.absent();\n    this._context.hostDidDisconnect(this);\n    this._downlinks.forEach(function (nodeUri: Uri, nodeDownlinks: BTree<Uri, HostDownlink>): void {\n      nodeDownlinks.forEach(function (laneUri: Uri, downlink: HostDownlink): void {\n        downlink.hostDidDisconnect(this);\n      }, this);\n    }, this);\n  }\n\n  protected onError(error?: unknown): void {\n    this._context.hostDidFail(error, this);\n    this._downlinks.forEach(function (nodeUri: Uri, nodeDownlinks: BTree<Uri, HostDownlink>): void {\n      nodeDownlinks.forEach(function (laneUri: Uri, downlink: HostDownlink): void {\n        downlink.hostDidFail(error, this);\n      }, this);\n    }, this);\n  }\n\n  protected reconnect(): void {\n    if (!this._reconnectTimer) {\n      if (!this._reconnectTimeout) {\n        this._reconnectTimeout = Math.floor(500 + 1000 * Math.random());\n      } else {\n        this._reconnectTimeout = Math.min(Math.floor(1.8 * this._reconnectTimeout), this.maxReconnectTimeout());\n      }\n      this._reconnectTimer = setTimeout(this.open.bind(this), this._reconnectTimeout) as any;\n    }\n  }\n\n  protected clearReconnect(): void {\n    if (this._reconnectTimer) {\n      clearTimeout(this._reconnectTimer);\n      this._reconnectTimer = 0;\n    }\n  }\n\n  protected watchIdle(): void {\n    if (!this._idleTimer && this.isConnected() && this.isIdle()) {\n      this._idleTimer = setTimeout(this.checkIdle.bind(this), this.idleTimeout()) as any;\n    }\n  }\n\n  protected clearIdle(): void {\n    if (this._idleTimer) {\n      clearTimeout(this._idleTimer);\n      this._idleTimer = 0;\n    }\n  }\n\n  protected checkIdle(): void {\n    if (this.isConnected() && this.isIdle()) {\n      this.close();\n    }\n  }\n\n  abstract open(): void;\n\n  close(): void {\n    this._context.closeHost(this);\n  }\n\n  closeUp(): void {\n    this._downlinks.forEach(function (nodeUri: Uri, nodeDownlinks: BTree<Uri, HostDownlink>): void {\n      nodeDownlinks.forEach(function (laneUri: Uri, downlink: HostDownlink): void {\n        downlink.closeUp(this);\n      }, this);\n    }, this);\n  }\n\n  abstract push(envelope: Envelope): void;\n}\n","// Copyright 2015-2020 SWIM.AI inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Uri} from \"@swim/uri\";\nimport {Envelope, CommandMessage, AuthRequest} from \"@swim/warp\";\nimport {HostContext} from \"./HostContext\";\nimport {HostOptions} from \"./Host\";\nimport {RemoteHost} from \"./RemoteHost\";\n\n/** @hidden */\nexport type WebSocketConstructor = {new(url: string, protocols?: string | string[]): WebSocket};\n\nexport interface WebSocketHostOptions extends HostOptions {\n  protocols?: string | string[];\n  WebSocket?: WebSocketConstructor;\n}\n\n/** @hidden */\nexport class WebSocketHost extends RemoteHost {\n  /** @hidden */\n  readonly _options: WebSocketHostOptions;\n  /** @hidden */\n  _socket: WebSocket | undefined;\n\n  constructor(context: HostContext, hostUri: Uri, options: WebSocketHostOptions = {}) {\n    super(context, hostUri, options);\n  }\n\n  get WebSocket(): WebSocketConstructor | undefined {\n    return this._options.WebSocket\n        || typeof WebSocket !== \"undefined\" && WebSocket\n        || typeof require === \"function\" && require(\"ws\") as WebSocketConstructor\n        || void 0;\n  }\n\n  isConnected(): boolean {\n    return this._socket ? this._socket.readyState === this._socket.OPEN : false;\n  }\n\n  open(): void {\n    this.clearReconnect();\n    if (!this._socket) {\n      const WebSocket = this.WebSocket;\n      if (!WebSocket) {\n        throw new Error(\"WebSocket undefined\");\n      }\n      let hostUri = this._hostUri;\n      const schemeName = hostUri.schemeName();\n      if (schemeName === \"warp\" || schemeName === \"swim\") {\n        hostUri = hostUri.scheme(\"ws\");\n      } else if (schemeName === \"warps\" || schemeName === \"swims\") {\n        hostUri = hostUri.scheme(\"wss\");\n      }\n      if (this._options.protocols) {\n        this._socket = new WebSocket(hostUri.toString(), this._options.protocols);\n      } else {\n        this._socket = new WebSocket(hostUri.toString());\n      }\n      this._socket.onopen = this.onWebSocketOpen.bind(this);\n      this._socket.onmessage = this.onWebSocketMessage.bind(this);\n      this._socket.onclose = this.onWebSocketClose.bind(this);\n      this._socket.onerror = this.onWebSocketError.bind(this);\n    }\n  }\n\n  close(): void {\n    this.clearReconnect();\n    this.clearIdle();\n    if (this._socket) {\n      this._socket.close();\n      if (!this._context.isOnline()) {\n        this.onWebSocketClose(); // force close event\n      }\n    } else {\n      super.close();\n    }\n  }\n\n  push(envelope: Envelope): void {\n    if (this.isConnected()) {\n      this.clearIdle();\n      const text = envelope.toRecon();\n      this._socket!.send(text);\n      this.watchIdle();\n    } else if (envelope instanceof CommandMessage) {\n      if (this._sendBuffer.length < this.sendBufferSize()) {\n        this._sendBuffer.push(envelope);\n      } else {\n        throw new Error(\"send buffer overflow\");\n      }\n      this.open();\n    }\n  }\n\n  protected onWebSocketOpen(): void {\n    if (this.isConnected()) {\n      const credentials = this.credentials();\n      if (credentials.isDefined()) {\n        const request = new AuthRequest(credentials);\n        this.push(request);\n      }\n      this.onConnect();\n      let envelope;\n      while ((envelope = this._sendBuffer.shift()) && this.isConnected()) {\n        this.push(envelope);\n      }\n      this.watchIdle();\n    } else {\n      this.close();\n    }\n  }\n\n  protected onWebSocketMessage(message: MessageEvent): void {\n    const data = message.data;\n    if (typeof data === \"string\") {\n      const envelope = Envelope.parseRecon(data);\n      if (envelope) {\n        this.onEnvelope(envelope);\n      } else {\n        this.onUnknownEnvelope(data);\n      }\n    }\n  }\n\n  protected onWebSocketClose(): void {\n    if (this._socket) {\n      this._socket.onopen = null;\n      this._socket.onmessage = null;\n      this._socket.onclose = null;\n      this._socket.onerror = null;\n      this._socket = void 0;\n    }\n    this.onDisconnect();\n    this.clearIdle();\n    if (!this.isIdle()) {\n      if (this._context.isOnline()) {\n        this.reconnect();\n      }\n    } else {\n      this.close();\n    }\n  }\n\n  protected onWebSocketError(): void {\n    if (this._socket) {\n      this._socket.close();\n      if (!this._context.isOnline()) {\n        this.onWebSocketClose(); // force close event\n      } else {\n        this.onError();\n      }\n    }\n  }\n}\n","// Copyright 2015-2020 SWIM.AI inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Uri} from \"@swim/uri\";\nimport {AnyValue, Value} from \"@swim/structure\";\nimport {\n  EventMessage,\n  LinkRequest,\n  LinkedResponse,\n  SyncRequest,\n  SyncedResponse,\n  UnlinkRequest,\n  UnlinkedResponse,\n} from \"@swim/warp\";\nimport {HostDownlink} from \"../host/HostDownlink\";\nimport {Host} from \"../host/Host\";\nimport {DownlinkContext} from \"./DownlinkContext\";\nimport {DownlinkType, Downlink} from \"./Downlink\";\n\nconst LINKING = 1;\nconst LINKED = 2;\nconst SYNCING = 4;\nconst SYNCED = 8;\nconst UNLINKING = 16;\n\n/** @hidden */\nexport abstract class DownlinkModel implements HostDownlink {\n   /** @hidden */\n  readonly _context: DownlinkContext;\n   /** @hidden */\n  readonly _hostUri: Uri;\n   /** @hidden */\n  readonly _nodeUri: Uri;\n   /** @hidden */\n  readonly _laneUri: Uri;\n   /** @hidden */\n  readonly _prio: number;\n   /** @hidden */\n  readonly _rate: number;\n   /** @hidden */\n  readonly _body: Value;\n  /** @hidden */\n  _views: Downlink[];\n  /** @hidden */\n  _host: Host | null;\n  /** @hidden */\n  _status: number;\n\n  constructor(context: DownlinkContext, hostUri: Uri, nodeUri: Uri, laneUri: Uri,\n              prio: number = 0, rate: number = 0, body: Value = Value.absent()) {\n    this._context = context;\n    this._hostUri = hostUri;\n    this._nodeUri = nodeUri;\n    this._laneUri = laneUri;\n    this._prio = prio;\n    this._rate = rate;\n    this._body = body;\n    this._views = [];\n    this._host = null;\n    this._status = 0;\n  }\n\n  hostUri(): Uri {\n    return this._hostUri;\n  }\n\n  nodeUri(): Uri {\n    return this._nodeUri;\n  }\n\n  laneUri(): Uri {\n    return this._laneUri;\n  }\n\n  prio(): number {\n    return this._prio;\n  }\n\n  rate(): number {\n    return this._rate;\n  }\n\n  body(): Value {\n    return this._body;\n  }\n\n  abstract type(): DownlinkType;\n\n  keepLinked(): boolean {\n    for (let i = 0; i < this._views.length; i += 1) {\n      if (this._views[i].keepLinked()) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  keepSynced(): boolean {\n    for (let i = 0; i < this._views.length; i += 1) {\n      if (this._views[i].keepSynced()) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  unlinkDelay(): number {\n    return this._host ? this._host.unlinkDelay() : 0;\n  }\n\n  isConnected(): boolean {\n    return !!(this._host && this._host.isConnected());\n  }\n\n  isAuthenticated(): boolean {\n    return !!(this._host && this._host.isAuthenticated());\n  }\n\n  isLinked(): boolean {\n    return (this._status & LINKED) !== 0;\n  }\n\n  isSynced(): boolean {\n    return (this._status & SYNCED) !== 0;\n  }\n\n  session(): Value {\n    return this._host ? this._host.session() : Value.absent();\n  }\n\n  addDownlink(view: Downlink): void {\n    this._views.push(view);\n  }\n\n  removeDownlink(view: Downlink): void {\n    for (let i = 0; i < this._views.length; i += 1) {\n      if (this._views[i] === view) {\n        this._views.splice(i, 1);\n        view.closeUp();\n      }\n    }\n    if (this._views.length === 0) {\n      const unlinkDelay = this.unlinkDelay();\n      if (unlinkDelay < 0) {\n        this.unlink();\n      } else {\n        setTimeout(this.doUnlink.bind(this), unlinkDelay);\n      }\n    }\n  }\n\n  onEventMessage(message: EventMessage, host: Host): void {\n    for (let i = 0; i < this._views.length; i += 1) {\n      this._views[i].onEventMessage(message);\n    }\n  }\n\n  onCommandMessage(body: Value): void {\n    for (let i = 0; i < this._views.length; i += 1) {\n      this._views[i].onCommandMessage(body);\n    }\n  }\n\n  onLinkRequest(request: LinkRequest): void {\n    this._status |= LINKING;\n    for (let i = 0; i < this._views.length; i += 1) {\n      this._views[i].onLinkRequest(request);\n    }\n  }\n\n  onLinkedResponse(response: LinkedResponse, host: Host): void {\n    this._status = this._status & ~LINKING | LINKED;\n    for (let i = 0; i < this._views.length; i += 1) {\n      this._views[i].onLinkedResponse(response);\n    }\n  }\n\n  onSyncRequest(request: SyncRequest): void {\n    this._status |= SYNCING;\n    for (let i = 0; i < this._views.length; i += 1) {\n      this._views[i].onSyncRequest(request);\n    }\n  }\n\n  onSyncedResponse(response: SyncedResponse, host: Host): void {\n    this._status = this._status & ~SYNCING | SYNCED;\n    for (let i = 0; i < this._views.length; i += 1) {\n      this._views[i].onSyncedResponse(response);\n    }\n  }\n\n  onUnlinkRequest(request: UnlinkRequest, host: Host): void {\n    this._status = this._status & ~(LINKING | SYNCING) | UNLINKING;\n    for (let i = 0; i < this._views.length; i += 1) {\n      this._views[i].onUnlinkRequest(request);\n    }\n  }\n\n  onUnlinkedResponse(response: UnlinkedResponse, host: Host): void {\n    this._status &= ~UNLINKING;\n    if (this._views.length === 0 || this._status !== 0) {\n      for (let i = 0; i < this._views.length; i += 1) {\n        this._views[i].onUnlinkedResponse(response);\n      }\n      this.close();\n    } else { // concurrently relinked\n      if (this.keepSynced()) {\n        this.sync();\n      } else {\n        this.link();\n      }\n    }\n  }\n\n  hostDidConnect(host: Host): void {\n    for (let i = 0; i < this._views.length; i += 1) {\n      this._views[i].hostDidConnect();\n    }\n    if (this.keepSynced()) {\n      this.sync();\n    } else {\n      this.link();\n    }\n  }\n\n  hostDidDisconnect(host: Host): void {\n    this._status = 0;\n    let keepLinked = false;\n    for (let i = 0; i < this._views.length; i += 1) {\n      const view = this._views[i];\n      view.hostDidDisconnect();\n      keepLinked = keepLinked || view.keepLinked();\n    }\n    if (!keepLinked) {\n      this.close();\n    }\n  }\n\n  hostDidFail(error: unknown, host: Host): void {\n    for (let i = 0; i < this._views.length; i += 1) {\n      this._views[i].hostDidFail(error);\n    }\n  }\n\n  command(body: AnyValue): void {\n    body = Value.fromAny(body);\n    this.onCommandMessage(body);\n    this._host!.command(this._nodeUri, this._laneUri, body);\n  }\n\n  sync(): void {\n    const nodeUri = this._host!.unresolve(this._nodeUri);\n    const request = SyncRequest.of(nodeUri, this._laneUri, this._prio, this._rate, this._body);\n    this.onSyncRequest(request);\n    this._host!.push(request);\n  }\n\n  link(): void {\n    const nodeUri = this._host!.unresolve(this._nodeUri);\n    const request = LinkRequest.of(nodeUri, this._laneUri, this._prio, this._rate, this._body);\n    this.onLinkRequest(request);\n    this._host!.push(request);\n  }\n\n  unlink(): void {\n    this._status = UNLINKING;\n    this._context.unlinkDownlink(this);\n  }\n\n  protected doUnlink(): void {\n    if (this._views.length === 0) {\n      this.unlink();\n    }\n  }\n\n  close(): void {\n    this._context.closeDownlink(this);\n  }\n\n  openUp(host: Host): void {\n    this._host = host;\n    for (let i = 0; i < this._views.length; i += 1) {\n      this._views[i].openUp(host);\n    }\n  }\n\n  closeUp(): void {\n    const views = this._views;\n    this._views = [];\n    for (let i = 0; i < views.length; i += 1) {\n      views[i].closeUp();\n    }\n  }\n}\n","// Copyright 2015-2020 SWIM.AI inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {AnyUri, Uri} from \"@swim/uri\";\nimport {Item, Attr, AnyValue, Value, Record, Form} from \"@swim/structure\";\nimport {\n  EventMessage,\n  LinkRequest,\n  LinkedResponse,\n  SyncRequest,\n  SyncedResponse,\n  UnlinkRequest,\n  UnlinkedResponse,\n} from \"@swim/warp\";\nimport {Host} from \"../host/Host\";\nimport {DownlinkOwner} from \"./DownlinkOwner\";\nimport {DownlinkContext} from \"./DownlinkContext\";\nimport {DownlinkModel} from \"./DownlinkModel\";\n\nexport type DownlinkType = \"event\" | \"list\" | \"map\" | \"value\";\n\nexport type DownlinkOnEvent = (body: Value, downlink: Downlink) => void;\nexport type DownlinkOnCommand = (body: Value, downlink: Downlink) => void;\nexport type DownlinkWillLink = (downlink: Downlink) => void;\nexport type DownlinkDidLink = (downlink: Downlink) => void;\nexport type DownlinkWillSync = (downlink: Downlink) => void;\nexport type DownlinkDidSync = (downlink: Downlink) => void;\nexport type DownlinkWillUnlink = (downlink: Downlink) => void;\nexport type DownlinkDidUnlink = (downlink: Downlink) => void;\nexport type DownlinkDidConnect = (downlink: Downlink) => void;\nexport type DownlinkDidDisconnect = (downlink: Downlink) => void;\nexport type DownlinkDidClose = (downlink: Downlink) => void;\nexport type DownlinkDidFail = (error: unknown, downlink: Downlink) => void;\n\nexport interface DownlinkObserver {\n  onEvent?: DownlinkOnEvent;\n  onCommand?: DownlinkOnCommand;\n  willLink?: DownlinkWillLink;\n  didLink?: DownlinkDidLink;\n  willSync?: DownlinkWillSync;\n  didSync?: DownlinkDidSync;\n  willUnlink?: DownlinkWillUnlink;\n  didUnlink?: DownlinkDidUnlink;\n  didConnect?: DownlinkDidConnect;\n  didDisconnect?: DownlinkDidDisconnect;\n  didClose?: DownlinkDidClose;\n  didFail?: DownlinkDidFail;\n}\n\nexport interface DownlinkInit extends DownlinkObserver {\n  hostUri?: AnyUri;\n  nodeUri?: AnyUri;\n  laneUri?: AnyUri;\n  prio?: number;\n  rate?: number;\n  body?: AnyValue;\n  type?: DownlinkType;\n}\n\n/** @hidden */\nexport const enum DownlinkFlags {\n  KeepLinked = 1,\n  KeepSynced = 2,\n  KeepLinkedSynced = KeepLinked | KeepSynced,\n}\n\nexport abstract class Downlink {\n  /** @hidden */\n  readonly _context: DownlinkContext;\n  /** @hidden */\n  readonly _owner: DownlinkOwner | undefined;\n  /** @hidden */\n  readonly _hostUri: Uri;\n  /** @hidden */\n  readonly _nodeUri: Uri;\n  /** @hidden */\n  readonly _laneUri: Uri;\n  /** @hidden */\n  readonly _prio: number;\n  /** @hidden */\n  readonly _rate: number;\n  /** @hidden */\n  readonly _body: Value;\n  /** @hidden */\n  readonly _flags: number;\n  /** @hidden */\n  _model: DownlinkModel | null;\n  /** @hidden */\n  _observers: ReadonlyArray<DownlinkObserver> | null;\n\n  constructor(context: DownlinkContext, owner?: DownlinkOwner, init?: DownlinkInit,\n              hostUri: Uri = Uri.empty(), nodeUri: Uri = Uri.empty(), laneUri: Uri = Uri.empty(),\n              prio: number = 0, rate: number = 0, body: Value = Value.absent(),\n              flags: number = 0, observers: ReadonlyArray<DownlinkObserver> | DownlinkObserver | null = null) {\n    let observer: DownlinkObserver | undefined;\n    if (!observers) {\n      observers = [];\n    } else if (!Array.isArray(observers)) {\n      observer = observers as DownlinkObserver;\n      observers = [observer];\n    }\n    if (init) {\n      observer = observer || {};\n      observers = observers ? observers.concat(observer) : [observer];\n      hostUri = init.hostUri !== void 0 ? Uri.fromAny(init.hostUri) : hostUri;\n      nodeUri = init.nodeUri !== void 0 ? Uri.fromAny(init.nodeUri) : nodeUri;\n      laneUri = init.laneUri !== void 0 ? Uri.fromAny(init.laneUri) : laneUri;\n      prio = init.prio !== void 0 ? init.prio : prio;\n      rate = init.rate !== void 0 ? init.rate : rate;\n      body = init.body !== void 0 ? Value.fromAny(init.body) : body;\n      observer.onEvent = init.onEvent || observer.onEvent;\n      observer.onCommand = init.onCommand || observer.onCommand;\n      observer.willLink = init.willLink || observer.willLink;\n      observer.didLink = init.didLink || observer.didLink;\n      observer.willSync = init.willSync || observer.willSync;\n      observer.didSync = init.didSync || observer.didSync;\n      observer.willUnlink = init.willUnlink || observer.willUnlink;\n      observer.didUnlink = init.didUnlink || observer.didUnlink;\n      observer.didConnect = init.didConnect || observer.didConnect;\n      observer.didDisconnect = init.didDisconnect || observer.didDisconnect;\n      observer.didClose = init.didClose || observer.didClose;\n      observer.didFail = init.didFail || observer.didFail;\n    }\n    this._context = context;\n    this._owner = owner;\n    this._hostUri = hostUri;\n    this._nodeUri = nodeUri;\n    this._laneUri = laneUri;\n    this._prio = prio;\n    this._rate = rate;\n    this._body = body;\n    this._flags = flags;\n    this._model = null;\n    this._observers = observers;\n  }\n\n  protected abstract copy(context: DownlinkContext, owner: DownlinkOwner | undefined,\n                          hostUri: Uri, nodeUri: Uri, laneUri: Uri, prio: number, rate: number,\n                          body: Value, flags: number, observers: ReadonlyArray<DownlinkObserver> | null): this;\n\n  hostUri(): Uri;\n  hostUri(hostUri: AnyUri): this;\n  hostUri(hostUri?: AnyUri): Uri | this {\n    if (hostUri === void 0) {\n      return this._hostUri;\n    } else {\n      hostUri = Uri.fromAny(hostUri);\n      return this.copy(this._context, this._owner, hostUri, this._nodeUri, this._laneUri,\n                       this._prio, this._rate, this._body, this._flags, this._observers);\n    }\n  }\n\n  nodeUri(): Uri;\n  nodeUri(nodeUri: AnyUri): this;\n  nodeUri(nodeUri?: AnyUri): Uri | this {\n    if (nodeUri === void 0) {\n      return this._nodeUri;\n    } else {\n      nodeUri = Uri.fromAny(nodeUri);\n      return this.copy(this._context, this._owner, this._hostUri, nodeUri, this._laneUri,\n                       this._prio, this._rate, this._body, this._flags, this._observers);\n    }\n  }\n\n  laneUri(): Uri;\n  laneUri(laneUri: AnyUri): this;\n  laneUri(laneUri?: AnyUri): Uri | this {\n    if (laneUri === void 0) {\n      return this._laneUri;\n    } else {\n      laneUri = Uri.fromAny(laneUri);\n      return this.copy(this._context, this._owner, this._hostUri, this._nodeUri, laneUri,\n                       this._prio, this._rate, this._body, this._flags, this._observers);\n    }\n  }\n\n  prio(): number;\n  prio(prio: number ): this;\n  prio(prio?: number): number | this {\n    if (prio === void 0) {\n      return this._prio;\n    } else {\n      return this.copy(this._context, this._owner, this._hostUri, this._nodeUri, this._laneUri,\n                       prio, this._rate, this._body, this._flags, this._observers);\n    }\n  }\n\n  rate(): number;\n  rate(rate: number): this;\n  rate(rate?: number): number | this {\n    if (rate === void 0) {\n      return this._rate;\n    } else {\n      return this.copy(this._context, this._owner, this._hostUri, this._nodeUri, this._laneUri,\n                       this._prio, rate, this._body, this._flags, this._observers);\n    }\n  }\n\n  body(): Value;\n  body(body: AnyValue): this;\n  body(body?: AnyValue): Value | this {\n    if (body === void 0) {\n      return this._body;\n    } else {\n      body = Value.fromAny(body);\n      return this.copy(this._context, this._owner, this._hostUri, this._nodeUri, this._laneUri,\n                       this._prio, this._rate, body, this._flags, this._observers);\n    }\n  }\n\n  abstract type(): DownlinkType;\n\n  keepLinked(): boolean;\n  keepLinked(keepLinked: boolean): this;\n  keepLinked(keepLinked?: boolean): boolean | this {\n    if (keepLinked === void 0) {\n      return (this._flags & DownlinkFlags.KeepLinked) !== 0;\n    } else {\n      const flags = keepLinked ? this._flags | DownlinkFlags.KeepLinked : this._flags & ~DownlinkFlags.KeepLinked;\n      return this.copy(this._context, this._owner, this._hostUri, this._nodeUri, this._laneUri,\n                       this._prio, this._rate, this._body, flags, this._observers);\n    }\n  }\n\n  keepSynced(): boolean;\n  keepSynced(keepSynced: boolean): this;\n  keepSynced(keepSynced?: boolean): boolean | this {\n    if (keepSynced === void 0) {\n      return (this._flags & DownlinkFlags.KeepSynced) !== 0;\n    } else {\n      const flags = keepSynced ? this._flags | DownlinkFlags.KeepSynced : this._flags & ~DownlinkFlags.KeepSynced;\n      return this.copy(this._context, this._owner, this._hostUri, this._nodeUri, this._laneUri,\n                       this._prio, this._rate, this._body, flags, this._observers);\n    }\n  }\n\n  observe(observer: DownlinkObserver): this {\n    const oldObservers = this._observers;\n    const n = oldObservers ? oldObservers.length : 0;\n    const newObservers = new Array<DownlinkObserver>(n + 1);\n    for (let i = 0; i < n; i += 1) {\n      newObservers[i] = oldObservers![i];\n    }\n    newObservers[n] = observer;\n    this._observers = newObservers;\n    return this;\n  }\n\n  unobserve(observer: unknown): this {\n    const oldObservers = this._observers;\n    const n = oldObservers ? oldObservers.length : 0;\n    for (let i = 0; i < n; i += 1) {\n      const oldObserver = oldObservers![i] as {[key: string]: unknown};\n      let found = oldObserver === observer; // check object identity\n      if (!found) {\n        for (const key in oldObserver) { // check property identity\n          if (oldObserver[key] === observer) {\n            found = true;\n            break;\n          }\n        }\n      }\n      if (found) {\n        if (n > 1) {\n          const newObservers = new Array<DownlinkObserver>(n - 1);\n          for (let j = 0; j < i; j += 1) {\n            newObservers[j] = oldObservers![j];\n          }\n          for (let j = i + 1; j < n; j += 1) {\n            newObservers[j - 1] = oldObservers![j];\n          }\n          this._observers = newObservers;\n        } else {\n          this._observers = null;\n        }\n        break;\n      }\n    }\n    return this;\n  }\n\n  onEvent(onEvent: DownlinkOnEvent): this {\n    return this.observe({onEvent});\n  }\n\n  onCommand(onCommand: DownlinkOnCommand): this {\n    return this.observe({onCommand});\n  }\n\n  willLink(willLink: DownlinkWillLink): this {\n    return this.observe({willLink});\n  }\n\n  didLink(didLink: DownlinkDidLink): this {\n    return this.observe({didLink});\n  }\n\n  willSync(willSync: DownlinkWillSync): this {\n    return this.observe({willSync});\n  }\n\n  didSync(didSync: DownlinkDidSync): this {\n    return this.observe({didSync});\n  }\n\n  willUnlink(willUnlink: DownlinkWillUnlink): this {\n    return this.observe({willUnlink});\n  }\n\n  didUnlink(didUnlink: DownlinkDidUnlink): this {\n    return this.observe({didUnlink});\n  }\n\n  didConnect(didConnect: DownlinkDidConnect): this {\n    return this.observe({didConnect});\n  }\n\n  didDisconnect(didDisconnect: DownlinkDidDisconnect): this {\n    return this.observe({didDisconnect});\n  }\n\n  didClose(didClose: DownlinkDidClose): this {\n    return this.observe({didClose});\n  }\n\n  didFail(didFail: DownlinkDidFail): this {\n    return this.observe({didFail});\n  }\n\n  isConnected(): boolean {\n    return this._model ? this._model.isConnected() : false;\n  }\n\n  isAuthenticated(): boolean {\n    return this._model ? this._model.isAuthenticated() : false;\n  }\n\n  isLinked(): boolean {\n    return this._model ? this._model.isLinked() : false;\n  }\n\n  isSynced(): boolean {\n    return this._model ? this._model.isSynced() : false;\n  }\n\n  session(): Value {\n    return this._model ? this._model.session() : Value.absent();\n  }\n\n  /** @hidden */\n  onEventMessage(message: EventMessage): void {\n    const observers = this._observers;\n    const n = observers ? observers.length : 0;\n    for (let i = 0; i < n; i += 1) {\n      const observer = observers![i];\n      if (observer.onEvent) {\n        observer.onEvent(message.body(), this);\n      }\n    }\n  }\n\n  /** @hidden */\n  onCommandMessage(body: Value): void {\n    const observers = this._observers;\n    const n = observers ? observers.length : 0;\n    for (let i = 0; i < n; i += 1) {\n      const observer = observers![i];\n      if (observer.onCommand) {\n        observer.onCommand(body, this);\n      }\n    }\n  }\n\n  /** @hidden */\n  onLinkRequest(request?: LinkRequest): void {\n    const observers = this._observers;\n    const n = observers ? observers.length : 0;\n    for (let i = 0; i < n; i += 1) {\n      const observer = observers![i];\n      if (observer.willLink) {\n        observer.willLink(this);\n      }\n    }\n  }\n\n  /** @hidden */\n  onLinkedResponse(response?: LinkedResponse): void {\n    const observers = this._observers;\n    const n = observers ? observers.length : 0;\n    for (let i = 0; i < n; i += 1) {\n      const observer = observers![i];\n      if (observer.didLink) {\n        observer.didLink(this);\n      }\n    }\n  }\n\n  /** @hidden */\n  onSyncRequest(request?: SyncRequest): void {\n    const observers = this._observers;\n    const n = observers ? observers.length : 0;\n    for (let i = 0; i < n; i += 1) {\n      const observer = observers![i];\n      if (observer.willSync) {\n        observer.willSync(this);\n      }\n    }\n  }\n\n  /** @hidden */\n  onSyncedResponse(response?: SyncedResponse): void {\n    const observers = this._observers;\n    const n = observers ? observers.length : 0;\n    for (let i = 0; i < n; i += 1) {\n      const observer = observers![i];\n      if (observer.didSync) {\n        observer.didSync(this);\n      }\n    }\n  }\n\n  /** @hidden */\n  onUnlinkRequest(request?: UnlinkRequest): void {\n    const observers = this._observers;\n    const n = observers ? observers.length : 0;\n    for (let i = 0; i < n; i += 1) {\n      const observer = observers![i];\n      if (observer.willUnlink) {\n        observer.willUnlink(this);\n      }\n    }\n  }\n\n  /** @hidden */\n  onUnlinkedResponse(response?: UnlinkedResponse): void {\n    const observers = this._observers;\n    const n = observers ? observers.length : 0;\n    for (let i = 0; i < n; i += 1) {\n      const observer = observers![i];\n      if (observer.didUnlink) {\n        observer.didUnlink(this);\n      }\n    }\n  }\n\n  /** @hidden */\n  hostDidConnect(): void {\n    const observers = this._observers;\n    const n = observers ? observers.length : 0;\n    for (let i = 0; i < n; i += 1) {\n      const observer = observers![i];\n      if (observer.didConnect) {\n        observer.didConnect(this);\n      }\n    }\n  }\n\n  /** @hidden */\n  hostDidDisconnect(): void {\n    const observers = this._observers;\n    const n = observers ? observers.length : 0;\n    for (let i = 0; i < n; i += 1) {\n      const observer = observers![i];\n      if (observer.didDisconnect) {\n        observer.didDisconnect(this);\n      }\n    }\n  }\n\n  /** @hidden */\n  hostDidFail(error: unknown): void {\n    const observers = this._observers;\n    const n = observers ? observers.length : 0;\n    for (let i = 0; i < n; i += 1) {\n      const observer = observers![i];\n      if (observer.didFail) {\n        observer.didFail(error, this);\n      }\n    }\n  }\n\n  command(body: AnyValue): void {\n    this._model!.command(body);\n  }\n\n  abstract open(): this;\n\n  close(): void {\n    if (this._owner) {\n      this._owner.removeDownlink(this);\n    }\n    if (this._model) {\n      this._model.removeDownlink(this);\n    }\n  }\n\n  /** @hidden */\n  openUp(host: Host): void {\n    // nop\n  }\n\n  /** @hidden */\n  closeUp(): void {\n    const observers = this._observers;\n    const n = observers ? observers.length : 0;\n    for (let i = 0; i < n; i += 1) {\n      const observer = observers![i];\n      if (observer.didClose) {\n        observer.didClose(this);\n      }\n    }\n  }\n\n  private static _initForm: Form<DownlinkInit | undefined>;\n\n  static initForm(): Form<DownlinkInit | undefined> {\n    if (!Downlink._initForm) {\n      Downlink._initForm = new DownlinkInitForm();\n    }\n    return Downlink._initForm;\n  }\n}\n\n/** @hidden */\nclass DownlinkInitForm extends Form<DownlinkInit | undefined> {\n  tag(): string;\n  tag(tag: string | undefined): Form<DownlinkInit | undefined>;\n  tag(tag?: string | undefined): string | Form<DownlinkInit | undefined> {\n    if (arguments.length === 0) {\n      return \"link\";\n    } else if (tag !== void 0) {\n      return super.tag(tag);\n    } else {\n      return this;\n    }\n  }\n\n  mold(init: DownlinkInit | undefined): Item {\n    if (init) {\n      const header = Record.create();\n      if (init.hostUri !== void 0) {\n        header.slot(\"host\", Uri.fromAny(init.hostUri).toString());\n      }\n      if (init.nodeUri !== void 0) {\n        header.slot(\"node\", Uri.fromAny(init.nodeUri).toString());\n      }\n      if (init.laneUri !== void 0) {\n        header.slot(\"lane\", Uri.fromAny(init.laneUri).toString());\n      }\n      if (init.prio !== void 0) {\n        header.slot(\"prio\", init.prio);\n      }\n      if (init.rate !== void 0) {\n        header.slot(\"rate\", init.rate);\n      }\n      if (init.body !== void 0) {\n        header.slot(\"body\", init.body);\n      }\n      if (init.type !== void 0) {\n        header.slot(\"type\", init.type);\n      }\n      return Record.of(Attr.of(\"link\", header));\n    } else {\n      return Item.extant();\n    }\n  }\n\n  cast(item: Item): DownlinkInit | undefined {\n    const value = item.toValue();\n    const header = value.get(\"link\");\n    if (header.isDefined()) {\n      const init = {} as DownlinkInit;\n      const host = header.get(\"host\");\n      if (host.isDefined()) {\n        init.hostUri = host.cast(Uri.form());\n      }\n      const node = header.get(\"node\");\n      if (node.isDefined()) {\n        init.nodeUri = node.cast(Uri.form());\n      }\n      const lane = header.get(\"lane\");\n      if (lane.isDefined()) {\n        init.laneUri = lane.cast(Uri.form());\n      }\n      const prio = header.get(\"prio\");\n      if (prio.isDefined()) {\n        init.prio = prio.numberValue();\n      }\n      const rate = header.get(\"rate\");\n      if (rate.isDefined()) {\n        init.rate = rate.numberValue();\n      }\n      const body = header.get(\"body\");\n      if (body.isDefined()) {\n        init.body = body;\n      }\n      const type = header.get(\"type\");\n      if (type.isDefined()) {\n        init.type = type.stringValue() as DownlinkType;\n      }\n      return init;\n    }\n    return void 0;\n  }\n}\n","// Copyright 2015-2020 SWIM.AI inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Value} from \"@swim/structure\";\nimport {Uri} from \"@swim/uri\";\nimport {DownlinkContext} from \"./DownlinkContext\";\nimport {DownlinkModel} from \"./DownlinkModel\";\nimport {DownlinkType} from \"./Downlink\";\nimport {EventDownlink} from \"./EventDownlink\";\n\n/** @hidden */\nexport class EventDownlinkModel extends DownlinkModel {\n  /** @hidden */\n  _views: EventDownlink[];\n\n  constructor(context: DownlinkContext, hostUri: Uri, nodeUri: Uri, laneUri: Uri,\n              prio?: number, rate?: number, body?: Value) {\n    super(context, hostUri, nodeUri, laneUri, prio, rate, body);\n  }\n\n  type(): DownlinkType {\n    return \"event\";\n  }\n}\n","// Copyright 2015-2020 SWIM.AI inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Value} from \"@swim/structure\";\nimport {Uri} from \"@swim/uri\";\nimport {DownlinkContext} from \"./DownlinkContext\";\nimport {DownlinkOwner} from \"./DownlinkOwner\";\nimport {DownlinkType, DownlinkObserver, DownlinkInit, DownlinkFlags, Downlink} from \"./Downlink\";\nimport {EventDownlinkModel} from \"./EventDownlinkModel\";\n\nexport interface EventDownlinkObserver extends DownlinkObserver {\n}\n\nexport interface EventDownlinkInit extends EventDownlinkObserver, DownlinkInit {\n}\n\nexport class EventDownlink extends Downlink {\n  /** @hidden */\n  _observers: ReadonlyArray<EventDownlinkObserver> | null;\n  /** @hidden */\n  _model: EventDownlinkModel | null;\n\n  /** @hidden */\n  constructor(context: DownlinkContext, owner?: DownlinkOwner, init?: EventDownlinkInit,\n              hostUri?: Uri, nodeUri?: Uri, laneUri?: Uri, prio?: number,\n              rate?: number, body?: Value, flags: number = DownlinkFlags.KeepLinked,\n              observers?: ReadonlyArray<EventDownlinkObserver> | EventDownlinkObserver | null) {\n    super(context, owner, init, hostUri, nodeUri, laneUri, prio, rate, body, flags, observers);\n  }\n\n  protected copy(context: DownlinkContext, owner: DownlinkOwner | undefined,\n                 hostUri: Uri, nodeUri: Uri, laneUri: Uri, prio: number, rate: number,\n                 body: Value, flags: number, observers: ReadonlyArray<EventDownlinkObserver> | null): this {\n    return new EventDownlink(context, owner, void 0, hostUri, nodeUri, laneUri,\n                             prio, rate, body, flags, observers) as this;\n  }\n\n  type(): DownlinkType {\n    return \"event\";\n  }\n\n  observe(observer: EventDownlinkObserver): this {\n    return super.observe(observer);\n  }\n\n  open(): this {\n    const laneUri = this._laneUri;\n    if (laneUri.isEmpty()) {\n      throw new Error(\"no lane\");\n    }\n    let nodeUri = this._nodeUri;\n    if (nodeUri.isEmpty()) {\n      throw new Error(\"no node\");\n    }\n    let hostUri = this._hostUri;\n    if (hostUri.isEmpty()) {\n      hostUri = nodeUri.endpoint();\n      nodeUri = hostUri.unresolve(nodeUri);\n    }\n    let model = this._context.getDownlink(hostUri, nodeUri, laneUri);\n    if (model) {\n      if (!(model instanceof EventDownlinkModel)) {\n        throw new Error(\"downlink type mismatch\");\n      }\n      model.addDownlink(this);\n    } else {\n      model = new EventDownlinkModel(this._context, hostUri, nodeUri, laneUri,\n                                     this._prio, this._rate, this._body);\n      model.addDownlink(this);\n      this._context.openDownlink(model);\n    }\n    this._model = model as EventDownlinkModel;\n    if (this._owner) {\n      this._owner.addDownlink(this);\n    }\n    return this;\n  }\n}\n","// Copyright 2015-2020 SWIM.AI inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Cursor} from \"@swim/util\";\nimport {STree} from \"@swim/collections\";\nimport {Attr, Value, Record} from \"@swim/structure\";\nimport {Uri} from \"@swim/uri\";\nimport {EventMessage} from \"@swim/warp\";\nimport {Host} from \"../host/Host\";\nimport {DownlinkContext} from \"./DownlinkContext\";\nimport {DownlinkModel} from \"./DownlinkModel\";\nimport {DownlinkType} from \"./Downlink\";\nimport {ListDownlink} from \"./ListDownlink\";\n\n/** @hidden */\nexport class ListDownlinkModel extends DownlinkModel {\n  /** @hidden */\n  _views: ListDownlink<unknown>[];\n  /** @hidden */\n  _state: STree<Value, Value>;\n\n  constructor(context: DownlinkContext, hostUri: Uri, nodeUri: Uri, laneUri: Uri,\n              prio?: number, rate?: number, body?: Value, state: STree<Value, Value> = new STree()) {\n    super(context, hostUri, nodeUri, laneUri, prio, rate, body);\n    this._state = state;\n  }\n\n  type(): DownlinkType {\n    return \"list\";\n  }\n\n  isEmpty(): boolean {\n    return this._state.isEmpty();\n  }\n\n  get length(): number {\n    return this._state.length;\n  }\n\n  get(index: number, key?: Value): Value {\n    return this._state.get(index, key) || Value.absent();\n  }\n\n  getEntry(index: number, key?: Value): [Value, Value] | undefined {\n    return this._state.getEntry(index, key);\n  }\n\n  set(index: number, newValue: Value, key?: Value): this {\n    if (key !== void 0) {\n      index = this._state.lookup(key, index);\n      if (index < 0) {\n        throw new RangeError(\"\" + key);\n      }\n    }\n    if (index < 0 || index >= this._state.length) {\n      throw new RangeError(\"\" + index);\n    }\n    newValue = this.listWillUpdate(index, newValue);\n    const oldEntry = this._state.getEntry(index)!;\n    this._state.set(index, newValue);\n    this.listDidUpdate(index, newValue, oldEntry[1]);\n    const header = Record.create(2).slot(\"key\", oldEntry[0]).slot(\"index\", index);\n    this.command(Attr.of(\"update\", header).concat(newValue));\n    return this;\n  }\n\n  insert(index: number, newValue: Value, key?: Value): this {\n    if (index < 0 || index > this._state.length) {\n      throw new RangeError(\"\" + index);\n    }\n    newValue = this.listWillUpdate(index, newValue);\n    this._state.insert(index, newValue, key);\n    const newEntry = this._state.getEntry(index)!;\n    this.listDidUpdate(index, newValue, Value.absent());\n    const header = Record.create(2).slot(\"key\", newEntry[0]).slot(\"index\", index);\n    this.command(Attr.of(\"update\", header).concat(newValue));\n    return this;\n  }\n\n  remove(index: number, key?: Value): this {\n    if (key !== void 0) {\n      index = this._state.lookup(key, index);\n      if (index < 0) {\n        throw new RangeError(\"\" + key);\n      }\n    }\n    if (index < 0 || index > this._state.length) {\n      throw new RangeError(\"\" + index);\n    }\n    this.listWillRemove(index);\n    const oldEntry = this._state.getEntry(index)!;\n    this._state.remove(index);\n    this.listDidRemove(index, oldEntry[1]);\n    const header = Record.create(2).slot(\"key\", oldEntry[0]).slot(\"index\", index);\n    this.command(Record.create(1).attr(\"remove\", header));\n    return this;\n  }\n\n  push(...newValues: Value[]): number {\n    for (let i = 0; i < newValues.length; i += 1) {\n      const index = this._state.length + i;\n      const newValue = this.listWillUpdate(index, newValues[i]);\n      this._state.insert(index, newValue);\n      const newEntry = this._state.getEntry(index)!;\n      this.listDidUpdate(index, newValue, Value.absent());\n      const header = Record.create(2).slot(\"key\", newEntry[0]).slot(\"index\", index);\n      this.command(Attr.of(\"update\", header).concat(newValue));\n    }\n    return this._state.length;\n  }\n\n  pop(): Value {\n    const index = this._state.length - 1;\n    if (index >= 0) {\n      this.listWillRemove(index);\n      const oldEntry = this._state.getEntry(index)!;\n      this._state.remove(index);\n      this.listDidRemove(index, oldEntry[1]);\n      const header = Record.create(2).slot(\"key\", oldEntry[0]).slot(\"index\", index);\n      this.command(Record.create(1).attr(\"remove\", header));\n      return oldEntry[1];\n    } else {\n      return Value.absent();\n    }\n  }\n\n  unshift(...newValues: Value[]): number {\n    for (let i = newValues.length - 1; i >= 0; i -= 1) {\n      const newValue = this.listWillUpdate(0, newValues[i]);\n      this._state.insert(0, newValue);\n      const newEntry = this._state.getEntry(0)!;\n      this.listDidUpdate(0, newValue, Value.absent());\n      const header = Record.create(2).slot(\"key\", newEntry[0]).slot(\"index\", 0);\n      this.command(Attr.of(\"update\", header).concat(newValue));\n    }\n    return this._state.length;\n  }\n\n  shift(): Value {\n    if (this._state.length > 0) {\n      this.listWillRemove(0);\n      const oldEntry = this._state.getEntry(0)!;\n      this._state.remove(0);\n      this.listDidRemove(0, oldEntry[1]);\n      const header = Record.create(2).slot(\"key\", oldEntry[0]).slot(\"index\", 0);\n      this.command(Record.create(1).attr(\"remove\", header));\n      return oldEntry[1];\n    } else {\n      return Value.absent();\n    }\n  }\n\n  move(fromIndex: number, toIndex: number, key?: Value): this {\n    if (key !== void 0) {\n      fromIndex = this._state.lookup(key, fromIndex);\n      if (fromIndex < 0) {\n        throw new RangeError(\"\" + key);\n      }\n    }\n    if (fromIndex < 0 || fromIndex >= this._state.length) {\n      throw new RangeError(\"\" + fromIndex);\n    }\n    if (toIndex < 0 || toIndex >= this._state.length) {\n      throw new RangeError(\"\" + toIndex);\n    }\n    if (fromIndex !== toIndex) {\n      const entry = this._state.getEntry(fromIndex)!;\n      this.listWillMove(fromIndex, toIndex, entry[1]);\n      this._state.remove(fromIndex).insert(toIndex, entry[1], entry[0]);\n      this.listDidMove(fromIndex, toIndex, entry[1]);\n      const header = Record.create(2).slot(\"key\", entry[0]).slot(\"from\", fromIndex).slot(\"to\", toIndex);\n      this.command(Record.create(1).attr(\"move\", header));\n    }\n    return this;\n  }\n\n  splice(start: number, deleteCount?: number, ...newValues: Value[]): Value[] {\n    if (start < 0) {\n      start = this._state.length + start;\n    }\n    start = Math.min(Math.max(0, start), this._state.length);\n    if (deleteCount === void 0) {\n      deleteCount = this._state.length - start;\n    }\n    const deleted = [] as Value[];\n    for (let i = start, n = start + deleteCount; i < n; i += 1) {\n      this.listWillRemove(start);\n      const oldEntry = this._state.getEntry(start)!;\n      deleted.push(oldEntry[1]);\n      this._state.remove(start);\n      this.listDidRemove(start, oldEntry[1]);\n      const header = Record.create(2).slot(\"key\", oldEntry[0]).slot(\"index\", start);\n      this.command(Record.create(1).attr(\"remove\", header));\n    }\n    for (let i = 0; i < newValues.length; i += 1) {\n      const index = start + i;\n      const newValue = this.listWillUpdate(index, newValues[i]);\n      this._state.insert(index, newValue);\n      const newEntry = this._state.getEntry(index)!;\n      this.listDidUpdate(index, newValue, Value.absent());\n      const header = Record.create(2).slot(\"key\", newEntry[0]).slot(\"index\", index);\n      this.command(Attr.of(\"update\", header).concat(newValue));\n    }\n    return deleted;\n  }\n\n  clear(): void {\n    this.listWillClear();\n    this._state.clear();\n    this.listDidClear();\n    this.command(Record.create(1).attr(\"clear\"));\n  }\n\n  forEach<T, S = unknown>(callback: (this: typeof thisArg,\n                                     value: Value,\n                                     index: number,\n                                     downlink: ListDownlinkModel,\n                                     key: Value) => T | void,\n                          thisArg?: S): T | undefined {\n    return this._state.forEach(function (value: Value, index: number, tree: STree<Value, Value>, key: Value): T | void {\n      return callback.call(thisArg, value, index, this, key);\n    }, this);\n  }\n\n  values(): Cursor<Value> {\n    return this._state.values();\n  }\n\n  keys(): Cursor<Value> {\n    return this._state.keys();\n  }\n\n  entries(): Cursor<[Value, Value]> {\n    return this._state.entries();\n  }\n\n  snapshot(): STree<Value, Value> {\n    return this._state.clone();\n  }\n\n  setState(state: STree<Value, Value>): void {\n    this._state = state;\n  }\n\n  onEventMessage(message: EventMessage, host: Host): void {\n    super.onEventMessage(message, host);\n    const event = message.body();\n    const tag = event.tag();\n    if (tag === \"update\") {\n      const header = event.head().toValue();\n      const index = this._state.lookup(header.get(\"key\"), header.get(\"index\").numberValue());\n      if (index >= 0) {\n        this.onUpdateEvent(index, event.body(), header.get(\"key\"));\n      } else {\n        this.onInsertEvent(header.get(\"index\").numberValue(0), event.body(), header.get(\"key\"));\n      }\n    } else if (tag === \"move\") {\n      const header = event.head().toValue();\n      const index = this._state.lookup(header.get(\"key\"), header.get(\"from\").numberValue());\n      if (index >= 0) {\n        this.onMoveEvent(index, header.get(\"to\").numberValue(0), header.get(\"key\"));\n      }\n    } else if (tag === \"remove\") {\n      const header = event.head().toValue();\n      const index = this._state.lookup(header.get(\"key\"), header.get(\"index\").numberValue());\n      if (index >= 0) {\n        this.onRemoveEvent(index, header.get(\"key\"));\n      }\n    } else if (tag === \"drop\") {\n      const header = event.head();\n      this.onDropEvent(header.numberValue(0));\n    } else if (tag === \"take\") {\n      const header = event.head();\n      this.onTakeEvent(header.numberValue(0));\n    } else if (tag === \"clear\") {\n      this.onClearEvent();\n    }\n  }\n\n  protected onInsertEvent(index: number, newValue: Value, key: Value): void {\n    newValue = this.listWillUpdate(index, newValue);\n    this._state.insert(index, newValue, key);\n    this.listDidUpdate(index, newValue, Value.absent());\n  }\n\n  protected onUpdateEvent(index: number, newValue: Value, key: Value): void {\n    newValue = this.listWillUpdate(index, newValue);\n    const oldValue = this._state.get(index) || Value.absent();\n    this._state.set(index, newValue);\n    this.listDidUpdate(index, newValue, oldValue);\n  }\n\n  protected onMoveEvent(fromIndex: number, toIndex: number, key: Value): void {\n    toIndex = Math.min(Math.max(0, toIndex), this._state.length);\n    if (fromIndex !== toIndex) {\n      const value = this._state.get(fromIndex) || Value.absent();\n      this.listWillMove(fromIndex, toIndex, value);\n      this._state.remove(fromIndex).insert(toIndex, value, key);\n      this.listDidMove(fromIndex, toIndex, value);\n    }\n  }\n\n  protected onRemoveEvent(index: number, key: Value): void {\n    this.listWillRemove(index);\n    const oldValue = this._state.get(index) || Value.absent();\n    this._state.remove(index);\n    this.listDidRemove(index, oldValue);\n  }\n\n  protected onDropEvent(lower: number): void {\n    this.listWillDrop(lower);\n    this._state.drop(lower);\n    this.listDidDrop(lower);\n  }\n\n  protected onTakeEvent(upper: number): void {\n    this.listWillTake(upper);\n    this._state.take(upper);\n    this.listDidTake(upper);\n  }\n\n  protected onClearEvent(): void {\n    this.listWillClear();\n    this._state.clear();\n    this.listDidClear();\n  }\n\n  protected listWillUpdate(index: number, newValue: Value): Value {\n    for (let i = 0; i < this._views.length; i += 1) {\n      newValue = this._views[i].listWillUpdate(index, newValue);\n    }\n    return newValue;\n  }\n\n  protected listDidUpdate(index: number, newValue: Value, oldValue: Value): void {\n    for (let i = 0; i < this._views.length; i += 1) {\n      this._views[i].listDidUpdate(index, newValue, oldValue);\n    }\n  }\n\n  protected listWillMove(fromIndex: number, toIndex: number, value: Value): void {\n    for (let i = 0; i < this._views.length; i += 1) {\n      this._views[i].listWillMove(fromIndex, toIndex, value);\n    }\n  }\n\n  protected listDidMove(fromIndex: number, toIndex: number, value: Value): void {\n    for (let i = 0; i < this._views.length; i += 1) {\n      this._views[i].listDidMove(fromIndex, toIndex, value);\n    }\n  }\n\n  protected listWillRemove(index: number): void {\n    for (let i = 0; i < this._views.length; i += 1) {\n      this._views[i].listWillRemove(index);\n    }\n  }\n\n  protected listDidRemove(index: number, oldValue: Value): void {\n    for (let i = 0; i < this._views.length; i += 1) {\n      this._views[i].listDidRemove(index, oldValue);\n    }\n  }\n\n  protected listWillDrop(lower: number): void {\n    for (let i = 0; i < this._views.length; i += 1) {\n      this._views[i].listWillDrop(lower);\n    }\n  }\n\n  protected listDidDrop(lower: number): void {\n    for (let i = 0; i < this._views.length; i += 1) {\n      this._views[i].listDidDrop(lower);\n    }\n  }\n\n  protected listWillTake(upper: number): void {\n    for (let i = 0; i < this._views.length; i += 1) {\n      this._views[i].listWillTake(upper);\n    }\n  }\n\n  protected listDidTake(upper: number): void {\n    for (let i = 0; i < this._views.length; i += 1) {\n      this._views[i].listDidTake(upper);\n    }\n  }\n\n  protected listWillClear() {\n    for (let i = 0; i < this._views.length; i += 1) {\n      this._views[i].listWillClear();\n    }\n  }\n\n  protected listDidClear() {\n    for (let i = 0; i < this._views.length; i += 1) {\n      this._views[i].listDidClear();\n    }\n  }\n}\n","// Copyright 2015-2020 SWIM.AI inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Cursor} from \"@swim/util\";\nimport {STree} from \"@swim/collections\";\nimport {Value, Form, ValueCursor, ValueEntryCursor} from \"@swim/structure\";\nimport {Uri} from \"@swim/uri\";\nimport {DownlinkContext} from \"./DownlinkContext\";\nimport {DownlinkOwner} from \"./DownlinkOwner\";\nimport {DownlinkType, DownlinkObserver, DownlinkInit, DownlinkFlags, Downlink} from \"./Downlink\";\nimport {ListDownlinkModel} from \"./ListDownlinkModel\";\n\nexport type ListDownlinkWillUpdate<V extends VU, VU = V> = (index: number, newValue: V, downlink: ListDownlink<V, VU>) => V | void;\nexport type ListDownlinkDidUpdate<V extends VU, VU = V> = (index: number, newValue: V, oldValue: V, downlink: ListDownlink<V, VU>) => void;\nexport type ListDownlinkWillMove<V extends VU, VU = V> = (fromIndex: number, toIndex: number, value: V, downlink: ListDownlink<V, VU>) => void;\nexport type ListDownlinkDidMove<V extends VU, VU = V> = (fromIndex: number, toIndex: number, value: V, downlink: ListDownlink<V, VU>) => void;\nexport type ListDownlinkWillRemove<V extends VU, VU = V> = (index: number, downlink: ListDownlink<V, VU>) => void;\nexport type ListDownlinkDidRemove<V extends VU, VU = V> = (index: number, oldValue: V, downlink: ListDownlink<V, VU>) => void;\nexport type ListDownlinkWillDrop<V extends VU, VU = V> = (lower: number, downlink: ListDownlink<V, VU>) => void;\nexport type ListDownlinkDidDrop<V extends VU, VU = V> = (lower: number, downlink: ListDownlink<V, VU>) => void;\nexport type ListDownlinkWillTake<V extends VU, VU = V> = (upper: number, downlink: ListDownlink<V, VU>) => void;\nexport type ListDownlinkDidTake<V extends VU, VU = V> = (upper: number, downlink: ListDownlink<V, VU>) => void;\nexport type ListDownlinkWillClear<V extends VU, VU = V> = (downlink: ListDownlink<V, VU>) => void;\nexport type ListDownlinkDidClear<V extends VU, VU = V> = (downlink: ListDownlink<V, VU>) => void;\n\nexport interface ListDownlinkObserver<V extends VU, VU = V> extends DownlinkObserver {\n  willUpdate?: ListDownlinkWillUpdate<V, VU>;\n  didUpdate?: ListDownlinkDidUpdate<V, VU>;\n  willMove?: ListDownlinkWillMove<V, VU>;\n  didMove?: ListDownlinkDidMove<V, VU>;\n  willRemove?: ListDownlinkWillRemove<V, VU>;\n  didRemove?: ListDownlinkDidRemove<V, VU>;\n  willDrop?: ListDownlinkWillDrop<V, VU>;\n  didDrop?: ListDownlinkDidDrop<V, VU>;\n  willTake?: ListDownlinkWillTake<V, VU>;\n  didTake?: ListDownlinkDidTake<V, VU>;\n  willClear?: ListDownlinkWillClear<V, VU>;\n  didClear?: ListDownlinkDidClear<V, VU>;\n}\n\nexport interface ListDownlinkInit<V extends VU, VU = V> extends ListDownlinkObserver<V, VU>, DownlinkInit {\n  valueForm?: Form<V, VU>;\n}\n\nexport class ListDownlink<V extends VU, VU = V> extends Downlink {\n  /** @hidden */\n  _observers: ReadonlyArray<ListDownlinkObserver<V, VU>> | null;\n  /** @hidden */\n  _model: ListDownlinkModel | null;\n  /** @hidden */\n  _valueForm: Form<V, VU>;\n  /** @hidden */\n  _state0: STree<Value, Value> | undefined;\n\n  /** @hidden */\n  constructor(context: DownlinkContext, owner?: DownlinkOwner, init?: ListDownlinkInit<V, VU>,\n              hostUri?: Uri, nodeUri?: Uri, laneUri?: Uri, prio?: number, rate?: number,\n              body?: Value, flags: number = DownlinkFlags.KeepLinkedSynced,\n              observers?: ReadonlyArray<ListDownlinkObserver<V, VU>> | ListDownlinkObserver<V, VU> | null,\n              valueForm?: Form<V, VU>, state0?: STree<Value, Value>) {\n    super(context, owner, init, hostUri, nodeUri, laneUri, prio, rate, body, flags, observers);\n    if (init) {\n      const observer = this._observers![this._observers!.length - 1];\n      observer.willUpdate = init.willUpdate || observer.willUpdate;\n      observer.didUpdate = init.didUpdate || observer.didUpdate;\n      observer.willMove = init.willMove || observer.willMove;\n      observer.didMove = init.didMove || observer.didMove;\n      observer.willRemove = init.willRemove || observer.willRemove;\n      observer.didRemove = init.didRemove || observer.didRemove;\n      observer.willDrop = init.willDrop || observer.willDrop;\n      observer.didDrop = init.didDrop || observer.didDrop;\n      observer.willTake = init.willTake || observer.willTake;\n      observer.didTake = init.didTake || observer.didTake;\n      observer.willClear = init.willClear || observer.willClear;\n      observer.didClear = init.didClear || observer.didClear;\n      valueForm = init.valueForm ? init.valueForm : valueForm;\n    }\n    this._valueForm = valueForm || Form.forValue() as any;\n    this._state0 = state0;\n  }\n\n  protected copy(context: DownlinkContext, owner: DownlinkOwner | undefined,\n                 hostUri: Uri, nodeUri: Uri, laneUri: Uri, prio: number, rate: number,\n                 body: Value, flags: number, observers: ReadonlyArray<ListDownlinkObserver<V, VU>> | null,\n                 valueForm?: Form<V, VU>, state0?: STree<Value, Value>): this {\n    if (arguments.length === 10) {\n      valueForm = this._valueForm;\n      state0 = this._state0;\n    }\n    return new ListDownlink(context, owner, void 0, hostUri, nodeUri, laneUri,\n                            prio, rate, body, flags, observers, valueForm, state0) as this;\n  }\n\n  type(): DownlinkType {\n    return \"list\";\n  }\n\n  valueForm(): Form<V, VU>;\n  valueForm<V2 extends V2U, V2U = V2>(valueForm: Form<V2, V2U>): ListDownlink<V2, V2U>;\n  valueForm<V2 extends V2U, V2U = V2>(valueForm?: Form<V2, V2U>): Form<V, VU> | ListDownlink<V2, V2U> {\n    if (valueForm === void 0) {\n      return this._valueForm;\n    } else {\n      return this.copy(this._context, this._owner, this._hostUri, this._nodeUri, this._laneUri,\n                       this._prio, this._rate, this._body, this._flags, this._observers,\n                       valueForm as any, this._state0) as any;\n    }\n  }\n\n  isEmpty(): boolean {\n    return this._model!.isEmpty();\n  }\n\n  get length(): number {\n    return this._model!.length;\n  }\n\n  get(index: number, id?: Value): V {\n    const value = this._model!.get(index, id);\n    return value.coerce(this._valueForm);\n  }\n\n  getEntry(index: number, id?: Value): [V, Value] | undefined {\n    const entry = this._model!.getEntry(index, id);\n    if (entry) {\n      return [entry[0].coerce(this._valueForm), entry[1]];\n    }\n    return void 0;\n  }\n\n  set(index: number, newObject: VU, id?: Value): this {\n    const newValue = this._valueForm.mold(newObject);\n    this._model!.set(index, newValue, id);\n    return this;\n  }\n\n  insert(index: number, newObject: VU, id?: Value): this {\n    const newValue = this._valueForm.mold(newObject);\n    this._model!.insert(index, newValue, id);\n    return this;\n  }\n\n  remove(index: number, id?: Value): this {\n    this._model!.remove(index, id);\n    return this;\n  }\n\n  push(...newObjects: VU[]): number {\n    const newValues = new Array(newObjects.length);\n    for (let i = 0; i < newObjects.length; i += 1) {\n      newValues[i] = this._valueForm.mold(newObjects[i]);\n    }\n    return this._model!.push.apply(this._model, newValues);\n  }\n\n  pop(): V {\n    const value = this._model!.pop();\n    return value.coerce(this._valueForm);\n  }\n\n  unshift(...newObjects: VU[]): number {\n    const newValues = new Array(newObjects.length);\n    for (let i = 0; i < newObjects.length; i += 1) {\n      newValues[i] = this._valueForm.mold(newObjects[i]);\n    }\n    return this._model!.unshift.apply(this._model, newValues);\n  }\n\n  shift(): V {\n    const value = this._model!.shift();\n    return value.coerce(this._valueForm);\n  }\n\n  move(fromIndex: number, toIndex: number, id?: Value): this {\n    this._model!.move(fromIndex, toIndex, id);\n    return this;\n  }\n\n  splice(start: number, deleteCount?: number, ...newObjects: VU[]): V[] {\n    const newValues = new Array(newObjects.length);\n    for (let i = 0; i < newObjects.length; i += 1) {\n      newValues[i] = this._valueForm.mold(newObjects[i]);\n    }\n    const oldValues = this._model!.splice(start, deleteCount, ...newValues);\n    const oldObjects = new Array(oldValues.length);\n    for (let i = 0; i < oldValues.length; i += 1) {\n      oldObjects[i] = oldValues[i].coerce(this._valueForm);\n    }\n    return oldObjects;\n  }\n\n  clear(): void {\n    this._model!.clear();\n  }\n\n  forEach<T, S = unknown>(callback: (this: S,\n                                     value: V,\n                                     index: number,\n                                     downlink: ListDownlink<V, VU>,\n                                     id: Value) => T | void,\n                          thisArg?: S): T | undefined {\n    if (this._valueForm as any === Form.forValue()) {\n      return this._model!._state.forEach(callback as any, thisArg);\n    } else {\n      return this._model!._state.forEach(function (value: Value, index: number, tree: STree<Value, Value>, id: Value): T | void {\n        const object = value.coerce(this._valueForm);\n        return callback.call(thisArg, object, index, this, id);\n      }, this);\n    }\n  }\n\n  values(): Cursor<V> {\n    const cursor = this._model!.values();\n    if (this._valueForm as any === Form.forValue()) {\n      return cursor as any;\n    } else {\n      return new ValueCursor(cursor, this._valueForm);\n    }\n  }\n\n  keys(): Cursor<Value> {\n    return this._model!.keys();\n  }\n\n  entries(): Cursor<[Value, V]> {\n    const cursor = this._model!.entries();\n    if (this._valueForm as any === Form.forValue()) {\n      return cursor as any;\n    } else {\n      return new ValueEntryCursor(cursor, Form.forValue(), this._valueForm);\n    }\n  }\n\n  snapshot(): STree<Value, Value> {\n    return this._model!.snapshot();\n  }\n\n  setState(state: STree<Value, Value>): void {\n    this._model!.setState(state);\n  }\n\n  observe(observer: ListDownlinkObserver<V, VU>): this {\n    return super.observe(observer);\n  }\n\n  willUpdate(willUpdate: ListDownlinkWillUpdate<V, VU>): this {\n    return this.observe({willUpdate});\n  }\n\n  didUpdate(didUpdate: ListDownlinkDidUpdate<V, VU>): this {\n    return this.observe({didUpdate});\n  }\n\n  willMove(willMove: ListDownlinkWillMove<V, VU>): this {\n    return this.observe({willMove});\n  }\n\n  didMove(didMove: ListDownlinkDidMove<V, VU>): this {\n    return this.observe({didMove});\n  }\n\n  willRemove(willRemove: ListDownlinkWillRemove<V, VU>): this {\n    return this.observe({willRemove});\n  }\n\n  didRemove(didRemove: ListDownlinkDidRemove<V, VU>): this {\n    return this.observe({didRemove});\n  }\n\n  willDrop(willDrop: ListDownlinkWillDrop<V, VU>): this {\n    return this.observe({willDrop});\n  }\n\n  didDrop(didDrop: ListDownlinkDidDrop<V, VU>): this {\n    return this.observe({didDrop});\n  }\n\n  willTake(willTake: ListDownlinkWillTake<V, VU>): this {\n    return this.observe({willTake});\n  }\n\n  didTake(didTake: ListDownlinkDidTake<V, VU>): this {\n    return this.observe({didTake});\n  }\n\n  willClear(willClear: ListDownlinkWillClear<V, VU>): this {\n    return this.observe({willClear});\n  }\n\n  didClear(didClear: ListDownlinkDidClear<V, VU>): this {\n    return this.observe({didClear});\n  }\n\n  /** @hidden */\n  listWillUpdate(index: number, newValue: Value): Value {\n    const observers = this._observers;\n    const n = observers ? observers.length : 0;\n    let newObject: V | undefined;\n    for (let i = 0; i < n; i += 1) {\n      const observer = observers![i];\n      if (observer.willUpdate) {\n        if (newObject === void 0) {\n          newObject = newValue.coerce(this._valueForm);\n        }\n        const newResult = observer.willUpdate(index, newObject, this);\n        if (newResult !== void 0) {\n          newObject = newResult;\n          newValue = this._valueForm.mold(newObject);\n        }\n      }\n    }\n    return newValue;\n  }\n\n  /** @hidden */\n  listDidUpdate(index: number, newValue: Value, oldValue: Value): void {\n    const observers = this._observers;\n    const n = observers ? observers.length : 0;\n    let newObject: V | undefined;\n    let oldObject: V | undefined;\n    for (let i = 0; i < n; i += 1) {\n      const observer = observers![i];\n      if (observer.didUpdate) {\n        if (newObject === void 0) {\n          newObject = newValue.coerce(this._valueForm);\n        }\n        if (oldObject === void 0) {\n          oldObject = oldValue.coerce(this._valueForm);\n        }\n        observer.didUpdate(index, newObject, oldObject, this);\n      }\n    }\n  }\n\n  /** @hidden */\n  listWillMove(fromIndex: number, toIndex: number, value: Value): void {\n    const observers = this._observers;\n    const n = observers ? observers.length : 0;\n    let object: V | undefined;\n    for (let i = 0; i < n; i += 1) {\n      const observer = observers![i];\n      if (observer.willMove) {\n        if (object === void 0) {\n          object = value.coerce(this._valueForm);\n        }\n        observer.willMove(fromIndex, toIndex, object, this);\n      }\n    }\n  }\n\n  /** @hidden */\n  listDidMove(fromIndex: number, toIndex: number, value: Value): void {\n    const observers = this._observers;\n    const n = observers ? observers.length : 0;\n    let object: V | undefined;\n    for (let i = 0; i < n; i += 1) {\n      const observer = observers![i];\n      if (observer.didMove) {\n        if (object === void 0) {\n          object = value.coerce(this._valueForm);\n        }\n        observer.didMove(fromIndex, toIndex, object, this);\n      }\n    }\n  }\n\n  /** @hidden */\n  listWillRemove(index: number): void {\n    const observers = this._observers;\n    const n = observers ? observers.length : 0;\n    for (let i = 0; i < n; i += 1) {\n      const observer = observers![i];\n      if (observer.willRemove) {\n        observer.willRemove(index, this);\n      }\n    }\n  }\n\n  /** @hidden */\n  listDidRemove(index: number, oldValue: Value): void {\n    const observers = this._observers;\n    const n = observers ? observers.length : 0;\n    let oldObject: V | undefined;\n    for (let i = 0; i < n; i += 1) {\n      const observer = observers![i];\n      if (observer.didRemove) {\n        if (oldObject === void 0) {\n          oldObject = oldValue.coerce(this._valueForm);\n        }\n        observer.didRemove(index, oldObject, this);\n      }\n    }\n  }\n\n  /** @hidden */\n  listWillDrop(lower: number): void {\n    const observers = this._observers;\n    const n = observers ? observers.length : 0;\n    for (let i = 0; i < n; i += 1) {\n      const observer = observers![i];\n      if (observer.willDrop) {\n        observer.willDrop(lower, this);\n      }\n    }\n  }\n\n  /** @hidden */\n  listDidDrop(lower: number): void {\n    const observers = this._observers;\n    const n = observers ? observers.length : 0;\n    for (let i = 0; i < n; i += 1) {\n      const observer = observers![i];\n      if (observer.didDrop) {\n        observer.didDrop(lower, this);\n      }\n    }\n  }\n\n  /** @hidden */\n  listWillTake(upper: number): void {\n    const observers = this._observers;\n    const n = observers ? observers.length : 0;\n    for (let i = 0; i < n; i += 1) {\n      const observer = observers![i];\n      if (observer.willTake) {\n        observer.willTake(upper, this);\n      }\n    }\n  }\n\n  /** @hidden */\n  listDidTake(upper: number): void {\n    const observers = this._observers;\n    const n = observers ? observers.length : 0;\n    for (let i = 0; i < n; i += 1) {\n      const observer = observers![i];\n      if (observer.didTake) {\n        observer.didTake(upper, this);\n      }\n    }\n  }\n\n  /** @hidden */\n  listWillClear(): void {\n    const observers = this._observers;\n    const n = observers ? observers.length : 0;\n    for (let i = 0; i < n; i += 1) {\n      const observer = observers![i];\n      if (observer.willClear) {\n        observer.willClear(this);\n      }\n    }\n  }\n\n  /** @hidden */\n  listDidClear(): void {\n    const observers = this._observers;\n    const n = observers ? observers.length : 0;\n    for (let i = 0; i < n; i += 1) {\n      const observer = observers![i];\n      if (observer.didClear) {\n        observer.didClear(this);\n      }\n    }\n  }\n\n  initialState(): STree<Value, Value> | null;\n  initialState(state0: STree<Value, Value> | null): this;\n  initialState(state0?: STree<Value, Value> | null): STree<Value, Value> | null | this {\n    if (state0 === void 0) {\n      return this._state0 || null;\n    } else {\n      return this.copy(this._context, this._owner, this._hostUri, this._nodeUri, this._laneUri,\n                       this._prio, this._rate, this._body, this._flags, this._observers,\n                       this._valueForm, state0 || void 0);\n    }\n  }\n\n  /** @hidden */\n  protected didAliasModel(): void {\n    this.onLinkedResponse();\n    this._model!._state.forEach(function (value: Value, index: number) {\n      this.listDidUpdate(index, value, Value.absent());\n    }, this);\n    this.onSyncedResponse();\n  }\n\n  open(): this {\n    const laneUri = this._laneUri;\n    if (laneUri.isEmpty()) {\n      throw new Error(\"no lane\");\n    }\n    let nodeUri = this._nodeUri;\n    if (nodeUri.isEmpty()) {\n      throw new Error(\"no node\");\n    }\n    let hostUri = this._hostUri;\n    if (hostUri.isEmpty()) {\n      hostUri = nodeUri.endpoint();\n      nodeUri = hostUri.unresolve(nodeUri);\n    }\n    let model = this._context.getDownlink(hostUri, nodeUri, laneUri);\n    if (model) {\n      if (!(model instanceof ListDownlinkModel)) {\n        throw new Error(\"downlink type mismatch\");\n      }\n      model.addDownlink(this);\n      this._model = model as ListDownlinkModel;\n      setTimeout(this.didAliasModel.bind(this));\n    } else {\n      model = new ListDownlinkModel(this._context, hostUri, nodeUri, laneUri, this._prio,\n                                    this._rate, this._body, this._state0);\n      model.addDownlink(this);\n      this._context.openDownlink(model);\n      this._model = model as ListDownlinkModel;\n    }\n    if (this._owner) {\n      this._owner.addDownlink(this);\n    }\n    return this;\n  }\n}\n","// Copyright 2015-2020 SWIM.AI inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Cursor} from \"@swim/util\";\nimport {BTree} from \"@swim/collections\";\nimport {Attr, Value, Record} from \"@swim/structure\";\nimport {Uri} from \"@swim/uri\";\nimport {EventMessage} from \"@swim/warp\";\nimport {Host} from \"../host/Host\";\nimport {DownlinkContext} from \"./DownlinkContext\";\nimport {DownlinkModel} from \"./DownlinkModel\";\nimport {DownlinkType} from \"./Downlink\";\nimport {MapDownlink} from \"./MapDownlink\";\n\n/** @hidden */\nexport class MapDownlinkModel extends DownlinkModel {\n  /** @hidden */\n  _views: MapDownlink<unknown, unknown>[];\n  /** @hidden */\n  _state: BTree<Value, Value>;\n\n  constructor(context: DownlinkContext, hostUri: Uri, nodeUri: Uri, laneUri: Uri,\n              prio?: number, rate?: number, body?: Value, state: BTree<Value, Value> = new BTree()) {\n    super(context, hostUri, nodeUri, laneUri, prio, rate, body);\n    this._state = state;\n  }\n\n  type(): DownlinkType {\n    return \"map\";\n  }\n\n  get size(): number {\n    return this._state.size;\n  }\n\n  isEmpty(): boolean {\n    return this._state.isEmpty();\n  }\n\n  has(key: Value): boolean {\n    return this._state.has(key);\n  }\n\n  get(key: Value): Value {\n    return this._state.get(key) || Value.absent();\n  }\n\n  getEntry(index: number): [Value, Value] | undefined {\n    return this._state.getEntry(index);\n  }\n\n  set(key: Value, newValue: Value): this {\n    newValue = this.mapWillUpdate(key, newValue);\n    const oldValue = this._state.get(key) || Value.absent();\n    this._state.set(key, newValue);\n    this.mapDidUpdate(key, newValue, oldValue);\n    const header = Record.create(1).slot(\"key\", key);\n    this.command(Attr.of(\"update\", header).concat(newValue));\n    return this;\n  }\n\n  delete(key: Value): boolean {\n    if (this._state.has(key)) {\n      this.mapWillRemove(key);\n      const oldValue = this._state.get(key) || Value.absent();\n      this._state.delete(key);\n      this.mapDidRemove(key, oldValue);\n      const header = Record.create(1).slot(\"key\", key);\n      this.command(Record.create(1).attr(\"remove\", header));\n      return true;\n    } else {\n      return false;\n    }\n  }\n\n  drop(lower: number): this {\n    this.mapWillDrop(lower);\n    this._state.drop(lower);\n    this.mapDidDrop(lower);\n    this.command(Record.create(1).attr(\"drop\", lower));\n    return this;\n  }\n\n  take(upper: number): this {\n    this.mapWillTake(upper);\n    this._state.take(upper);\n    this.mapDidTake(upper);\n    this.command(Record.create(1).attr(\"take\", upper));\n    return this;\n  }\n\n  clear(): void {\n    this.mapWillClear();\n    this._state.clear();\n    this.mapDidClear();\n    this.command(Record.create(1).attr(\"clear\"));\n  }\n\n  forEach<T, S = unknown>(callback: (this: S,\n                                     key: Value,\n                                     value: Value,\n                                     downlink: MapDownlinkModel) => T | void,\n                          thisArg?: S): T | undefined {\n    return this._state.forEach(function (key: Value, value: Value): T | void {\n      return callback.call(thisArg, key, value, this);\n    }, this);\n  }\n\n  keys(): Cursor<Value> {\n    return this._state.keys();\n  }\n\n  values(): Cursor<Value> {\n    return this._state.values();\n  }\n\n  entries(): Cursor<[Value, Value]> {\n    return this._state.entries();\n  }\n\n  snapshot(): BTree<Value, Value> {\n    return this._state.clone();\n  }\n\n  setState(state: BTree<Value, Value>): void {\n    this._state = state;\n  }\n\n  onEventMessage(message: EventMessage, host: Host): void {\n    super.onEventMessage(message, host);\n    const event = message.body();\n    const tag = event.tag();\n    if (tag === \"update\") {\n      const header = event.head().toValue();\n      this.onUpdateEvent(header.get(\"key\"), event.body());\n    } else if (tag === \"remove\") {\n      const header = event.head().toValue();\n      this.onRemoveEvent(header.get(\"key\"));\n    } else if (tag === \"drop\") {\n      const header = event.head().toValue();\n      this.onDropEvent(header.numberValue(0));\n    } else if (tag === \"take\") {\n      const header = event.head().toValue();\n      this.onTakeEvent(header.numberValue(0));\n    } else if (tag === \"clear\") {\n      this.onClearEvent();\n    }\n  }\n\n  protected onUpdateEvent(key: Value, newValue: Value): void {\n    newValue = this.mapWillUpdate(key, newValue);\n    const oldValue = this._state.get(key) || Value.absent();\n    this._state.set(key, newValue);\n    this.mapDidUpdate(key, newValue, oldValue);\n  }\n\n  protected onRemoveEvent(key: Value): void {\n    this.mapWillRemove(key);\n    const oldValue = this._state.get(key) || Value.absent();\n    this._state.delete(key);\n    this.mapDidRemove(key, oldValue);\n  }\n\n  protected onDropEvent(lower: number): void {\n    this.mapWillDrop(lower);\n    this._state.drop(lower);\n    this.mapDidDrop(lower);\n  }\n\n  protected onTakeEvent(upper: number): void {\n    this.mapWillTake(upper);\n    this._state.take(upper);\n    this.mapDidTake(upper);\n  }\n\n  protected onClearEvent(): void {\n    this.mapWillClear();\n    this._state.clear();\n    this.mapDidClear();\n  }\n\n  protected mapWillUpdate(key: Value, newValue: Value): Value {\n    for (let i = 0; i < this._views.length; i += 1) {\n      newValue = this._views[i].mapWillUpdate(key, newValue);\n    }\n    return newValue;\n  }\n\n  protected mapDidUpdate(key: Value, newValue: Value, oldValue: Value): void {\n    for (let i = 0; i < this._views.length; i += 1) {\n      this._views[i].mapDidUpdate(key, newValue, oldValue);\n    }\n  }\n\n  protected mapWillRemove(key: Value): void {\n    for (let i = 0; i < this._views.length; i += 1) {\n      this._views[i].mapWillRemove(key);\n    }\n  }\n\n  protected mapDidRemove(key: Value, oldValue: Value): void {\n    for (let i = 0; i < this._views.length; i += 1) {\n      this._views[i].mapDidRemove(key, oldValue);\n    }\n  }\n\n  protected mapWillDrop(lower: number): void {\n    for (let i = 0; i < this._views.length; i += 1) {\n      this._views[i].mapWillDrop(lower);\n    }\n  }\n\n  protected mapDidDrop(lower: number): void {\n    for (let i = 0; i < this._views.length; i += 1) {\n      this._views[i].mapDidDrop(lower);\n    }\n  }\n\n  protected mapWillTake(upper: number): void {\n    for (let i = 0; i < this._views.length; i += 1) {\n      this._views[i].mapWillTake(upper);\n    }\n  }\n\n  protected mapDidTake(upper: number): void {\n    for (let i = 0; i < this._views.length; i += 1) {\n      this._views[i].mapDidTake(upper);\n    }\n  }\n\n  protected mapWillClear(): void {\n    for (let i = 0; i < this._views.length; i += 1) {\n      this._views[i].mapWillClear();\n    }\n  }\n\n  protected mapDidClear(): void {\n    for (let i = 0; i < this._views.length; i += 1) {\n      this._views[i].mapDidClear();\n    }\n  }\n}\n","// Copyright 2015-2020 SWIM.AI inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Cursor, Map, OrderedMap} from \"@swim/util\";\nimport {BTree} from \"@swim/collections\";\nimport {Value, Form, ValueCursor, ValueEntryCursor} from \"@swim/structure\";\nimport {Inlet, Outlet, KeyEffect, MapInlet, MapOutlet, KeyOutlet} from \"@swim/streamlet\";\nimport {FilterFieldsFunction, FilterFieldsCombinator} from \"@swim/streamlet\";\nimport {MapValueFunction, MapValueCombinator} from \"@swim/streamlet\";\nimport {MapFieldValuesFunction, MapFieldValuesCombinator} from \"@swim/streamlet\";\nimport {ReduceFieldsCombinator} from \"@swim/streamlet\";\nimport {WatchValueFunction, WatchValueCombinator} from \"@swim/streamlet\";\nimport {WatchFieldsFunction, WatchFieldsCombinator} from \"@swim/streamlet\";\nimport {Uri} from \"@swim/uri\";\nimport {DownlinkContext} from \"./DownlinkContext\";\nimport {DownlinkOwner} from \"./DownlinkOwner\";\nimport {DownlinkType, DownlinkObserver, DownlinkInit, DownlinkFlags, Downlink} from \"./Downlink\";\nimport {MapDownlinkModel} from \"./MapDownlinkModel\";\n\nexport type MapDownlinkWillUpdate<K extends KU, V extends VU, KU = K, VU = V> = (key: K, newValue: V, downlink: MapDownlink<K, V, KU, VU>) => V | void;\nexport type MapDownlinkDidUpdate<K extends KU, V extends VU, KU = K, VU = V> = (key: K, newValue: V, oldValue: V, downlink: MapDownlink<K, V, KU, VU>) => void;\nexport type MapDownlinkWillRemove<K extends KU, V extends VU, KU = K, VU = V> = (key: K, downlink: MapDownlink<K, V, KU, VU>) => void;\nexport type MapDownlinkDidRemove<K extends KU, V extends VU, KU = K, VU = V> = (key: K, oldValue: V, downlink: MapDownlink<K, V, KU, VU>) => void;\nexport type MapDownlinkWillDrop<K extends KU, V extends VU, KU = K, VU = V> = (lower: number, downlink: MapDownlink<K, V, KU, VU>) => void;\nexport type MapDownlinkDidDrop<K extends KU, V extends VU, KU = K, VU = V> = (lower: number, downlink: MapDownlink<K, V, KU, VU>) => void;\nexport type MapDownlinkWillTake<K extends KU, V extends VU, KU = K, VU = V> = (upper: number, downlink: MapDownlink<K, V, KU, VU>) => void;\nexport type MapDownlinkDidTake<K extends KU, V extends VU, KU = K, VU = V> = (upper: number, downlink: MapDownlink<K, V, KU, VU>) => void;\nexport type MapDownlinkWillClear<K extends KU, V extends VU, KU = K, VU = V> = (downlink: MapDownlink<K, V, KU, VU>) => void;\nexport type MapDownlinkDidClear<K extends KU, V extends VU, KU = K, VU = V> = (downlink: MapDownlink<K, V, KU, VU>) => void;\n\nexport interface MapDownlinkObserver<K extends KU, V extends VU, KU = K, VU = V> extends DownlinkObserver {\n  willUpdate?: MapDownlinkWillUpdate<K, V, KU, VU>;\n  didUpdate?: MapDownlinkDidUpdate<K, V, KU, VU>;\n  willRemove?: MapDownlinkWillRemove<K, V, KU, VU>;\n  didRemove?: MapDownlinkDidRemove<K, V, KU, VU>;\n  willDrop?: MapDownlinkWillDrop<K, V, KU, VU>;\n  didDrop?: MapDownlinkDidDrop<K, V, KU, VU>;\n  willTake?: MapDownlinkWillTake<K, V, KU, VU>;\n  didTake?: MapDownlinkDidTake<K, V, KU, VU>;\n  willClear?: MapDownlinkWillClear<K, V, KU, VU>;\n  didClear?: MapDownlinkDidClear<K, V, KU, VU>;\n}\n\nexport interface MapDownlinkInit<K extends KU, V extends VU, KU = K, VU = V> extends MapDownlinkObserver<K, V, KU, VU>, DownlinkInit {\n  keyForm?: Form<K, KU>;\n  valueForm?: Form<V, VU>;\n}\n\nexport class MapDownlink<K extends KU, V extends VU, KU = K, VU = V> extends Downlink implements OrderedMap<K, V>, MapInlet<K, V, Map<K, V>>, MapOutlet<K, V, MapDownlink<K, V, KU, VU>> {\n  /** @hidden */\n  _observers: ReadonlyArray<MapDownlinkObserver<K, V, KU, VU>> | null;\n  /** @hidden */\n  _model: MapDownlinkModel | null;\n  /** @hidden */\n  _keyForm: Form<K, KU>;\n  /** @hidden */\n  _valueForm: Form<V, VU>;\n  /** @hidden */\n  _state0: BTree<Value, Value> | undefined;\n  /** @hidden */\n  protected _input: MapOutlet<K, V, Map<K, V>> | null;\n  /** @hidden */\n  protected _effects: BTree<K, KeyEffect>;\n  /** @hidden */\n  protected _outlets: BTree<K, KeyOutlet<K, V>>; // TODO: unify with observers\n  /** @hidden */\n  protected _outputs: ReadonlyArray<Inlet<MapDownlink<K, V>>> | null;\n  /** @hidden */\n  protected _version: number;\n\n  /** @hidden */\n  constructor(context: DownlinkContext, owner?: DownlinkOwner, init?: MapDownlinkInit<K, V, KU, VU>,\n              hostUri?: Uri, nodeUri?: Uri, laneUri?: Uri, prio?: number, rate?: number,\n              body?: Value, flags: number = DownlinkFlags.KeepLinkedSynced,\n              observers?: ReadonlyArray<MapDownlinkObserver<K, V, KU, VU>> | MapDownlinkObserver<K, V, KU, VU> | null,\n              keyForm?: Form<K, KU>, valueForm?: Form<V, VU>, state0?: BTree<Value, Value>) {\n    super(context, owner, init, hostUri, nodeUri, laneUri, prio, rate, body, flags, observers);\n    if (init) {\n      const observer = this._observers![this._observers!.length - 1];\n      observer.willUpdate = init.willUpdate || observer.willUpdate;\n      observer.didUpdate = init.didUpdate || observer.didUpdate;\n      observer.willRemove = init.willRemove || observer.willRemove;\n      observer.didRemove = init.didRemove || observer.didRemove;\n      observer.willDrop = init.willDrop || observer.willDrop;\n      observer.didDrop = init.didDrop || observer.didDrop;\n      observer.willTake = init.willTake || observer.willTake;\n      observer.didTake = init.didTake || observer.didTake;\n      observer.willClear = init.willClear || observer.willClear;\n      observer.didClear = init.didClear || observer.didClear;\n      keyForm = init.keyForm ? init.keyForm : keyForm;\n      valueForm = init.valueForm ? init.valueForm : valueForm;\n    }\n    this._keyForm = keyForm || Form.forValue() as any;\n    this._valueForm = valueForm || Form.forValue() as any;\n    this._state0 = state0;\n    this._input = null;\n    this._effects = new BTree();\n    this._outlets = new BTree();\n    this._outputs = null;\n    this._version = -1;\n  }\n\n  protected copy(context: DownlinkContext, owner: DownlinkOwner | undefined,\n                 hostUri: Uri, nodeUri: Uri, laneUri: Uri, prio: number, rate: number,\n                 body: Value, flags: number, observers: ReadonlyArray<MapDownlinkObserver<K, V, KU, VU>> | null,\n                 keyForm?: Form<K, KU>, valueForm?: Form<V, VU>, state0?: BTree<Value, Value>): this {\n    if (arguments.length === 10) {\n      state0 = this._state0;\n      keyForm = this._keyForm;\n      valueForm = this._valueForm;\n    }\n    return new MapDownlink(context, owner, void 0, hostUri, nodeUri, laneUri,\n                           prio, rate, body, flags, observers, keyForm, valueForm,\n                           state0) as this;\n  }\n\n  type(): DownlinkType {\n    return \"map\";\n  }\n\n  keyForm(): Form<K, KU>;\n  keyForm<K2 extends K2U, K2U = K2>(keyForm: Form<K2, K2U>): MapDownlink<K2, V, K2U, VU>;\n  keyForm<K2 extends K2U, K2U = K2>(keyForm?: Form<K2, K2U>): Form<K, KU> | MapDownlink<K2, V, K2U, VU> {\n    if (keyForm === void 0) {\n      return this._keyForm;\n    } else {\n      return this.copy(this._context, this._owner, this._hostUri, this._nodeUri, this._laneUri,\n                       this._prio, this._rate, this._body, this._flags, this._observers,\n                       keyForm as any, this._valueForm, this._state0) as any;\n    }\n  }\n\n  valueForm(): Form<V, VU>;\n  valueForm<V2 extends V2U, V2U = V2>(valueForm: Form<V2, V2U>): MapDownlink<K, V2, KU, V2U>;\n  valueForm<V2 extends V2U, V2U = V2>(valueForm?: Form<V2, V2U>): Form<V, VU> | MapDownlink<K, V2, KU, V2U> {\n    if (valueForm === void 0) {\n      return this._valueForm;\n    } else {\n      return this.copy(this._context, this._owner, this._hostUri, this._nodeUri, this._laneUri,\n                       this._prio, this._rate, this._body, this._flags, this._observers,\n                       this._keyForm, valueForm as any, this._state0) as any;\n    }\n  }\n\n  get size(): number {\n    return this._model!.size;\n  }\n\n  isEmpty(): boolean {\n    return this._model!.isEmpty();\n  }\n\n  has(key: KU): boolean {\n    const keyObject = this._keyForm.mold(key);\n    return this._model!.has(keyObject);\n  }\n\n  get(): MapDownlink<K, V, KU, VU>;\n  get(key: KU): V;\n  get(key?: KU): MapDownlink<K, V, KU, VU> | V {\n    if (key === void 0) {\n      return this;\n    } else {\n      const keyObject = this._keyForm.mold(key);\n      const value = this._model!.get(keyObject);\n      return value.coerce(this._valueForm);\n    }\n  }\n\n  getEntry(index: number): [K, V] | undefined {\n    const entry = this._model!.getEntry(index);\n    if (entry) {\n      return [entry[0].coerce(this._keyForm), entry[1].coerce(this._valueForm)];\n    }\n    return void 0;\n  }\n\n  firstKey(): K | undefined {\n    const key = this._model!._state.firstKey();\n    if (key !== void 0) {\n      const keyObject = this._keyForm.cast(key);\n      if (keyObject !== void 0) {\n        return keyObject;\n      }\n    }\n    return this._keyForm.unit();\n  }\n\n  firstValue(): V | undefined {\n    const value = this._model!._state.firstValue();\n    if (value !== void 0) {\n      const object = this._valueForm.cast(value);\n      if (object !== void 0) {\n        return object;\n      }\n    }\n    return this._valueForm.unit();\n  }\n\n  firstEntry(): [K, V] | undefined {\n    const entry = this._model!._state.firstEntry();\n    if (entry !== void 0) {\n      const keyObject: K = this._keyForm.cast(entry[0])!;\n      const object: V = this._valueForm.cast(entry[1])!;\n      return [keyObject, object];\n    }\n    return void 0;\n  }\n\n  lastKey(): K | undefined {\n    const key = this._model!._state.lastKey();\n    if (key !== void 0) {\n      const keyObject = this._keyForm.cast(key);\n      if (keyObject !== void 0) {\n        return keyObject;\n      }\n    }\n    return this._keyForm.unit();\n  }\n\n  lastValue(): V | undefined {\n    const value = this._model!._state.lastValue();\n    if (value !== void 0) {\n      const object = this._valueForm.cast(value);\n      if (object !== void 0) {\n        return object;\n      }\n    }\n    return this._valueForm.unit();\n  }\n\n  lastEntry(): [K, V] | undefined {\n    const entry = this._model!._state.lastEntry();\n    if (entry !== void 0) {\n      const keyObject: K = this._keyForm.cast(entry[0])!;\n      const object: V = this._valueForm.cast(entry[1])!;\n      return [keyObject, object];\n    }\n    return void 0;\n  }\n\n  nextKey(keyObject: K): K | undefined {\n    const key = this._keyForm.mold(keyObject);\n    const nextKey = this._model!._state.nextKey(key);\n    if (nextKey !== void 0) {\n      const nextKeyObject = this._keyForm.cast(nextKey);\n      if (nextKeyObject !== void 0) {\n        return nextKeyObject;\n      }\n    }\n    return this._keyForm.unit();\n  }\n\n  nextValue(keyObject: K): V | undefined {\n    const key = this._keyForm.mold(keyObject);\n    const nextValue = this._model!._state.nextValue(key);\n    if (nextValue !== void 0) {\n      const nextObject = this._valueForm.cast(nextValue);\n      if (nextObject !== void 0) {\n        return nextObject;\n      }\n    }\n    return this._valueForm.unit();\n  }\n\n  nextEntry(keyObject: K): [K, V] | undefined {\n    const key = this._keyForm.mold(keyObject);\n    const entry = this._model!._state.nextEntry(key);\n    if (entry !== void 0) {\n      const keyObject: K = this._keyForm.cast(entry[0])!;\n      const object: V = this._valueForm.cast(entry[1])!;\n      return [keyObject, object];\n    }\n    return void 0;\n  }\n\n  previousKey(keyObject: K): K | undefined {\n    const key = this._keyForm.mold(keyObject);\n    const previousKey = this._model!._state.previousKey(key);\n    if (previousKey !== void 0) {\n      const previousKeyObject = this._keyForm.cast(previousKey);\n      if (previousKeyObject !== void 0) {\n        return previousKeyObject;\n      }\n    }\n    return this._keyForm.unit();\n  }\n\n  previousValue(keyObject: K): V | undefined {\n    const key = this._keyForm.mold(keyObject);\n    const previousValue = this._model!._state.previousValue(key);\n    if (previousValue !== void 0) {\n      const previousObject = this._valueForm.cast(previousValue);\n      if (previousObject !== void 0) {\n        return previousObject;\n      }\n    }\n    return this._valueForm.unit();\n  }\n\n  previousEntry(keyObject: K): [K, V] | undefined {\n    const key = this._keyForm.mold(keyObject);\n    const entry = this._model!._state.previousEntry(key);\n    if (entry !== void 0) {\n      const keyObject: K = this._keyForm.cast(entry[0])!;\n      const object: V = this._valueForm.cast(entry[1])!;\n      return [keyObject, object];\n    }\n    return void 0;\n  }\n\n  set(key: KU, newValue: VU): this {\n    const keyObject = this._keyForm.mold(key);\n    const newObject = this._valueForm.mold(newValue);\n    this._model!.set(keyObject, newObject);\n    return this;\n  }\n\n  delete(key: KU): boolean {\n    const keyObject = this._keyForm.mold(key);\n    return this._model!.delete(keyObject);\n  }\n\n  drop(lower: number): this {\n    this._model!.drop(lower);\n    return this;\n  }\n\n  take(upper: number): this {\n    this._model!.take(upper);\n    return this;\n  }\n\n  clear(): void {\n    this._model!.clear();\n  }\n\n  forEach<T, S = unknown>(callback: (this: S,\n                                     key: K,\n                                     value: V,\n                                     downlink: MapDownlink<K, V, KU, VU>) => T | void,\n                          thisArg?: S): T | undefined {\n    if (this._keyForm as any === Form.forValue() && this._valueForm as any === Form.forValue()) {\n      return this._model!._state.forEach(callback as any, thisArg);\n    } else {\n      return this._model!._state.forEach(function (key: Value, value: Value): T | void {\n        const keyObject = key.coerce(this._keyForm);\n        const object = value.coerce(this._valueForm);\n        return callback.call(thisArg, keyObject, object, this);\n      }, this);\n    }\n  }\n\n  keys(): Cursor<K> {\n    const cursor = this._model!.keys();\n    if (this._keyForm as any === Form.forValue()) {\n      return cursor as any;\n    } else {\n      return new ValueCursor(cursor, this._keyForm);\n    }\n  }\n\n  values(): Cursor<V> {\n    const cursor = this._model!.values();\n    if (this._valueForm as any === Form.forValue()) {\n      return cursor as any;\n    } else {\n      return new ValueCursor(cursor, this._valueForm);\n    }\n  }\n\n  entries(): Cursor<[K, V]> {\n    const cursor = this._model!.entries();\n    if (this._keyForm as any === Form.forValue() && this._valueForm as any === Form.forValue()) {\n      return cursor as any;\n    } else {\n      return new ValueEntryCursor(cursor, this._keyForm, this._valueForm);\n    }\n  }\n\n  snapshot(): BTree<Value, Value> {\n    return this._model!.snapshot();\n  }\n\n  setState(state: BTree<Value, Value>): void {\n    this._model!.setState(state);\n  }\n\n  observe(observer: MapDownlinkObserver<K, V, KU, VU>): this {\n    return super.observe(observer);\n  }\n\n  willUpdate(willUpdate: MapDownlinkWillUpdate<K, V, KU, VU>): this {\n    return this.observe({willUpdate});\n  }\n\n  didUpdate(didUpdate: MapDownlinkDidUpdate<K, V, KU, VU>): this {\n    return this.observe({didUpdate});\n  }\n\n  willRemove(willRemove: MapDownlinkWillRemove<K, V, KU, VU>): this {\n    return this.observe({willRemove});\n  }\n\n  didRemove(didRemove: MapDownlinkDidRemove<K, V, KU, VU>): this {\n    return this.observe({didRemove});\n  }\n\n  willDrop(willDrop: MapDownlinkWillDrop<K, V, KU, VU>): this {\n    return this.observe({willDrop});\n  }\n\n  didDrop(didDrop: MapDownlinkDidDrop<K, V, KU, VU>): this {\n    return this.observe({didDrop});\n  }\n\n  willTake(willTake: MapDownlinkWillTake<K, V, KU, VU>): this {\n    return this.observe({willTake});\n  }\n\n  didTake(didTake: MapDownlinkDidTake<K, V, KU, VU>): this {\n    return this.observe({didTake});\n  }\n\n  willClear(willClear: MapDownlinkWillClear<K, V, KU, VU>): this {\n    return this.observe({willClear});\n  }\n\n  didClear(didClear: MapDownlinkDidClear<K, V, KU, VU>): this {\n    return this.observe({didClear});\n  }\n\n  /** @hidden */\n  mapWillUpdate(key: Value, newValue: Value): Value {\n    const observers = this._observers;\n    const n = observers ? observers.length : 0;\n    let keyObject: K | undefined;\n    let newObject: V | undefined;\n    for (let i = 0; i < n; i += 1) {\n      const observer = observers![i];\n      if (observer.willUpdate) {\n        if (keyObject === void 0) {\n          keyObject = key.coerce(this._keyForm);\n        }\n        if (newObject === void 0) {\n          newObject = newValue.coerce(this._valueForm);\n        }\n        const newResult = observer.willUpdate(keyObject, newObject, this);\n        if (newResult !== void 0) {\n          newObject = newResult;\n          newValue = this._valueForm.mold(newObject);\n        }\n      }\n    }\n    return newValue;\n  }\n\n  /** @hidden */\n  mapDidUpdate(key: Value, newValue: Value, oldValue: Value): void {\n    const observers = this._observers;\n    const n = observers ? observers.length : 0;\n    const keyObject = key.coerce(this._keyForm);\n    let newObject: V | undefined;\n    let oldObject: V | undefined;\n    for (let i = 0; i < n; i += 1) {\n      const observer = observers![i];\n      if (observer.didUpdate) {\n        if (newObject === void 0) {\n          newObject = newValue.coerce(this._valueForm);\n        }\n        if (oldObject === void 0) {\n          oldObject = oldValue.coerce(this._valueForm);\n        }\n        observer.didUpdate(keyObject, newObject, oldObject, this);\n      }\n    }\n    this.invalidateInputKey(keyObject, KeyEffect.Update);\n    this.reconcileInput(0); // TODO: debounce and track version\n  }\n\n  /** @hidden */\n  mapWillRemove(key: Value): void {\n    const observers = this._observers;\n    const n = observers ? observers.length : 0;\n    let keyObject: K | undefined;\n    for (let i = 0; i < n; i += 1) {\n      const observer = observers![i];\n      if (observer.willRemove) {\n        if (keyObject === void 0) {\n          keyObject = key.coerce(this._keyForm);\n        }\n        observer.willRemove(keyObject, this);\n      }\n    }\n  }\n\n  /** @hidden */\n  mapDidRemove(key: Value, oldValue: Value): void {\n    const observers = this._observers;\n    const n = observers ? observers.length : 0;\n    const keyObject = key.coerce(this._keyForm);\n    let oldObject: V | undefined;\n    for (let i = 0; i < n; i += 1) {\n      const observer = observers![i];\n      if (observer.didRemove) {\n        if (oldObject === void 0) {\n          oldObject = oldValue.coerce(this._valueForm);\n        }\n        observer.didRemove(keyObject, oldObject, this);\n      }\n    }\n    this.invalidateInputKey(keyObject, KeyEffect.Remove);\n    this.reconcileInput(0); // TODO: debounce and track version\n  }\n\n  /** @hidden */\n  mapWillDrop(lower: number): void {\n    const observers = this._observers;\n    const n = observers ? observers.length : 0;\n    for (let i = 0; i < n; i += 1) {\n      const observer = observers![i];\n      if (observer.willDrop) {\n        observer.willDrop(lower, this);\n      }\n    }\n  }\n\n  /** @hidden */\n  mapDidDrop(lower: number): void {\n    const observers = this._observers;\n    const n = observers ? observers.length : 0;\n    for (let i = 0; i < n; i += 1) {\n      const observer = observers![i];\n      if (observer.didDrop) {\n        observer.didDrop(lower, this);\n      }\n    }\n  }\n\n  /** @hidden */\n  mapWillTake(upper: number): void {\n    const observers = this._observers;\n    const n = observers ? observers.length : 0;\n    for (let i = 0; i < n; i += 1) {\n      const observer = observers![i];\n      if (observer.willTake) {\n        observer.willTake(upper, this);\n      }\n    }\n  }\n\n  /** @hidden */\n  mapDidTake(upper: number): void {\n    const observers = this._observers;\n    const n = observers ? observers.length : 0;\n    for (let i = 0; i < n; i += 1) {\n      const observer = observers![i];\n      if (observer.didTake) {\n        observer.didTake(upper, this);\n      }\n    }\n  }\n\n  /** @hidden */\n  mapWillClear(): void {\n    const observers = this._observers;\n    const n = observers ? observers.length : 0;\n    for (let i = 0; i < n; i += 1) {\n      const observer = observers![i];\n      if (observer.willClear) {\n        observer.willClear(this);\n      }\n    }\n  }\n\n  /** @hidden */\n  mapDidClear(): void {\n    const observers = this._observers;\n    const n = observers ? observers.length : 0;\n    for (let i = 0; i < n; i += 1) {\n      const observer = observers![i];\n      if (observer.didClear) {\n        observer.didClear(this);\n      }\n    }\n  }\n\n  initialState(): BTree<Value, Value> | null;\n  initialState(state0: BTree<Value, Value> | null): this;\n  initialState(state0?: BTree<Value, Value> | null): BTree | null | this {\n    if (state0 === void 0) {\n      return this._state0 || null;\n    } else {\n      return this.copy(this._context, this._owner, this._hostUri, this._nodeUri, this._laneUri,\n                       this._prio, this._rate, this._body, this._flags, this._observers,\n                       this._keyForm, this._valueForm, state0 || void 0);\n    }\n  }\n\n  /** @hidden */\n  protected didAliasModel(): void {\n    this.onLinkedResponse();\n    this._model!._state.forEach(function (key: Value, value: Value): void {\n      this.mapDidUpdate(key, value, Value.absent());\n    }, this);\n    this.onSyncedResponse();\n  }\n\n  open(): this {\n    const laneUri = this._laneUri;\n    if (laneUri.isEmpty()) {\n      throw new Error(\"no lane\");\n    }\n    let nodeUri = this._nodeUri;\n    if (nodeUri.isEmpty()) {\n      throw new Error(\"no node\");\n    }\n    let hostUri = this._hostUri;\n    if (hostUri.isEmpty()) {\n      hostUri = nodeUri.endpoint();\n      nodeUri = hostUri.unresolve(nodeUri);\n    }\n    let model = this._context.getDownlink(hostUri, nodeUri, laneUri);\n    if (model) {\n      if (!(model instanceof MapDownlinkModel)) {\n        throw new Error(\"downlink type mismatch\");\n      }\n      model.addDownlink(this);\n      this._model = model as MapDownlinkModel;\n      setTimeout(this.didAliasModel.bind(this));\n    } else {\n      model = new MapDownlinkModel(this._context, hostUri, nodeUri, laneUri, this._prio,\n                                   this._rate, this._body, this._state0);\n      model.addDownlink(this);\n      this._context.openDownlink(model);\n      this._model = model as MapDownlinkModel;\n    }\n    if (this._owner) {\n      this._owner.addDownlink(this);\n    }\n    return this;\n  }\n\n  keyIterator(): Cursor<K> {\n    return this.keys();\n  }\n\n  input(): MapOutlet<K, V, Map<K, V>> | null {\n    return this._input;\n  }\n\n  bindInput(input: MapOutlet<K, V, Map<K, V>>): void {\n    if (!MapOutlet.is(input)) {\n      throw new TypeError(\"\" + input);\n    }\n    if (this._input !== null) {\n      this._input.unbindOutput(this);\n    }\n    this._input = input;\n    if (this._input !== null) {\n      this._input.bindOutput(this);\n    }\n  }\n\n  unbindInput(): void {\n    if (this._input !== null) {\n      this._input.unbindOutput(this);\n    }\n    this._input = null;\n  }\n\n  disconnectInputs(): void {\n    const input = this._input;\n    if (input !== null) {\n      input.unbindOutput(this);\n      this._input = null;\n      input.disconnectInputs();\n    }\n  }\n\n  outlet(key: K): Outlet<V> {\n    let outlet = this._outlets.get(key);\n    if (outlet === void 0) {\n      outlet = new KeyOutlet<K, V>(this, key);\n      this._outlets = this._outlets.updated(key, outlet);\n    }\n    return outlet;\n  }\n\n  outputIterator(): Cursor<Inlet<MapDownlink<K, V>>> {\n    return this._outputs !== null ? Cursor.array(this._outputs) : Cursor.empty();\n  }\n\n  bindOutput(output: Inlet<MapDownlink<K, V>>): void {\n    const oldOutputs = this._outputs;\n    const n = oldOutputs !== null ? oldOutputs.length : 0;\n    const newOutputs = new Array<Inlet<MapDownlink<K, V>>>(n + 1);\n    for (let i = 0; i < n; i += 1) {\n      newOutputs[i] = oldOutputs![i];\n    }\n    newOutputs[n] = output;\n    this._outputs = newOutputs;\n  }\n\n  unbindOutput(output: Inlet<MapDownlink<K, V>>): void {\n    const oldOutputs = this._outputs;\n    const n = oldOutputs !== null ? oldOutputs.length : 0;\n    for (let i = 0; i < n; i += 1) {\n      if (oldOutputs![i] === output) {\n        if (n > 1) {\n          const newOutputs = new Array<Inlet<MapDownlink<K, V>>>(n - 1);\n          for (let j = 0; j < i; j += 1) {\n            newOutputs[j] = oldOutputs![j];\n          }\n          for (let j = i; j < n - 1; j += 1) {\n            newOutputs[j] = oldOutputs![j + 1];\n          }\n          this._outputs = newOutputs;\n        } else {\n          this._outputs = null;\n        }\n        break;\n      }\n    }\n  }\n\n  unbindOutputs(): void {\n    const oldOutputs = this._outputs;\n    if (oldOutputs !== null) {\n      this._outputs = null;\n      for (let i = 0, n = oldOutputs.length; i < n; i += 1) {\n        oldOutputs[i].unbindInput();\n      }\n    }\n  }\n\n  disconnectOutputs(): void {\n    const outlets = this._outlets;\n    if (outlets.isEmpty()) {\n      this._outlets = new BTree();\n      outlets.forEach(function (key: K, keyOutlet: KeyOutlet<K, V>) {\n        keyOutlet.disconnectOutputs();\n      }, this);\n    }\n    const outputs = this._outputs;\n    if (outputs !== null) {\n      this._outputs = null;\n      for (let i = 0, n = outputs.length; i < n; i += 1) {\n        const output = outputs[i];\n        output.unbindInput();\n        output.disconnectOutputs();\n      }\n    }\n  }\n\n  invalidateOutputKey(key: K, effect: KeyEffect): void {\n    this.invalidateKey(key, effect);\n  }\n\n  invalidateInputKey(key: K, effect: KeyEffect): void {\n    this.invalidateKey(key, effect);\n  }\n\n  invalidateKey(key: K, effect: KeyEffect): void {\n    const oldEffects = this._effects;\n    if (oldEffects.get(key) !== effect) {\n      this.willInvalidateKey(key, effect);\n      this._effects = oldEffects.updated(key, effect);\n      this._version = -1;\n      this.onInvalidateKey(key, effect);\n      const n = this._outputs !== null ? this._outputs.length : 0;\n      for (let i = 0; i < n; i += 1) {\n        const output = this._outputs![i];\n        if (MapInlet.is(output)) {\n          output.invalidateOutputKey(key, effect);\n        } else {\n          output.invalidateOutput();\n        }\n      }\n      const outlet = this._outlets.get(key);\n      if (outlet !== void 0) {\n        outlet.invalidateInput();\n      }\n      this.didInvalidateKey(key, effect);\n    }\n  }\n\n  invalidateOutput(): void {\n    this.invalidate();\n  }\n\n  invalidateInput(): void {\n    this.invalidate();\n  }\n\n  invalidate(): void {\n    if (this._version >= 0) {\n      this.willInvalidate();\n      this._version = -1;\n      this.onInvalidate();\n      const n = this._outputs !== null ? this._outputs.length : 0;\n      for (let i = 0; i < n; i += 1) {\n        this._outputs![i].invalidateOutput();\n      }\n      this._outlets.forEach(function (key: K, outlet: KeyOutlet<K, V>): void {\n        outlet.invalidateInput();\n      }, this);\n      this.didInvalidate();\n    }\n  }\n\n  reconcileOutputKey(key: K, version: number): void {\n    this.reconcileKey(key, version);\n  }\n\n  reconcileInputKey(key: K, version: number): void {\n    this.reconcileKey(key, version);\n  }\n\n  reconcileKey(key: K, version: number): void {\n    if (this._version < 0) {\n      const oldEffects = this._effects;\n      const effect = oldEffects.get(key);\n      if (effect !== void 0) {\n        this.willReconcileKey(key, effect, version);\n        this._effects = oldEffects.removed(key);\n        if (this._input !== null) {\n          this._input.reconcileInputKey(key, version);\n        }\n        this.onReconcileKey(key, effect, version);\n        for (let i = 0, n = this._outputs !== null ? this._outputs.length : 0; i < n; i += 1) {\n          const output = this._outputs![i];\n          if (MapInlet.is(output)) {\n            output.reconcileOutputKey(key, version);\n          }\n        }\n        const outlet = this._outlets.get(key);\n        if (outlet !== void 0) {\n          outlet.reconcileInput(version);\n        }\n        this.didReconcileKey(key, effect, version);\n      }\n    }\n  }\n\n  reconcileOutput(version: number): void {\n    this.reconcile(version);\n  }\n\n  reconcileInput(version: number): void {\n    this.reconcile(version);\n  }\n\n  reconcile(version: number): void {\n    if (this._version < 0) {\n      this.willReconcile(version);\n      this._effects.forEach(function (key: K): void {\n        this.reconcileKey(key, version);\n      }, this);\n      this._version = version;\n      this.onReconcile(version);\n      for (let i = 0, n = this._outputs !== null ? this._outputs.length : 0; i < n; i += 1) {\n        this._outputs![i].reconcileOutput(version);\n      }\n      this.didReconcile(version);\n    }\n  }\n\n  protected willInvalidateKey(key: K, effect: KeyEffect): void {\n    // stub\n  }\n\n  protected onInvalidateKey(key: K, effect: KeyEffect): void {\n    // stub\n  }\n\n  protected didInvalidateKey(key: K, effect: KeyEffect): void {\n    // stub\n  }\n\n  protected willInvalidate(): void {\n    // stub\n  }\n\n  protected onInvalidate(): void {\n    // stub\n  }\n\n  protected didInvalidate(): void {\n    // stub\n  }\n\n  protected willReconcileKey(key: K, effect: KeyEffect, version: number): void {\n    // stub\n  }\n\n  protected onReconcileKey(key: K, effect: KeyEffect, version: number): void {\n    if (effect === KeyEffect.Update) {\n      if (this._input !== null) {\n        const value = this._input.get(key);\n        if (value !== void 0) {\n          this.set(key, value);\n        } else {\n          this.delete(key);\n        }\n      }\n    } else if (effect === KeyEffect.Remove) {\n      this.delete(key);\n    }\n  }\n\n  protected didReconcileKey(key: K, effect: KeyEffect, version: number): void {\n    // stub\n  }\n\n  protected willReconcile(version: number): void {\n    // stub\n  }\n\n  protected onReconcile(version: number): void {\n    // stub\n  }\n\n  protected didReconcile(version: number): void {\n    // stub\n  }\n\n  memoize(): MapOutlet<K, V, MapDownlink<K, V, KU, VU>> {\n    return this;\n  }\n\n  filter(func: FilterFieldsFunction<K, V>): MapOutlet<K, V, Map<K, V>> {\n    const combinator = new FilterFieldsCombinator<K, V, MapDownlink<K, V, KU, VU>>(func);\n    combinator.bindInput(this);\n    return combinator;\n  }\n\n  map<O2>(func: MapValueFunction<MapDownlink<K, V, KU, VU>, O2>): Outlet<O2>;\n  map<V2>(func: MapFieldValuesFunction<K, V, V2>): MapOutlet<K, V2, Map<K, V2>>;\n  map<V2>(func: MapValueFunction<MapDownlink<K, V, KU, VU>, V2> | MapFieldValuesFunction<K, V, V2>): Outlet<V2> | MapOutlet<K, V2, Map<K, V2>> {\n    if (func.length === 1) {\n      const combinator = new MapValueCombinator<MapDownlink<K, V, KU, VU>, V2>(func as MapValueFunction<MapDownlink<K, V, KU, VU>, V2>);\n      combinator.bindInput(this);\n      return combinator;\n    } else {\n      const combinator = new MapFieldValuesCombinator<K, V, V2, MapDownlink<K, V, KU, VU>>(func as MapFieldValuesFunction<K, V, V2>);\n      combinator.bindInput(this);\n      return combinator;\n    }\n  }\n\n  reduce<U>(identity: U, accumulator: (result: U, element: V) => U, combiner: (result: U, result2: U) => U): Outlet<U> {\n    const combinator = new ReduceFieldsCombinator<K, V, MapDownlink<K, V, KU, VU>, U>(identity, accumulator, combiner);\n    combinator.bindInput(this);\n    return combinator;\n  }\n\n  watch(func: WatchValueFunction<MapDownlink<K, V, KU, VU>>): this;\n  watch(func: WatchFieldsFunction<K, V>): this;\n  watch(func: WatchValueFunction<MapDownlink<K, V, KU, VU>> | WatchFieldsFunction<K, V>): this {\n    if (func.length === 1) {\n      const combinator = new WatchValueCombinator<MapDownlink<K, V, KU, VU>>(func as WatchValueFunction<MapDownlink<K, V, KU, VU>>);\n      combinator.bindInput(this);\n      return this;\n    } else {\n      const combinator = new WatchFieldsCombinator<K, V, MapDownlink<K, V, KU, VU>>(func as WatchFieldsFunction<K, V>);\n      combinator.bindInput(this);\n      return this;\n    }\n  }\n}\n","// Copyright 2015-2020 SWIM.AI inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Value} from \"@swim/structure\";\nimport {Uri} from \"@swim/uri\";\nimport {EventMessage} from \"@swim/warp\";\nimport {Host} from \"../host/Host\";\nimport {DownlinkContext} from \"./DownlinkContext\";\nimport {DownlinkModel} from \"./DownlinkModel\";\nimport {DownlinkType} from \"./Downlink\";\nimport {ValueDownlink} from \"./ValueDownlink\";\n\n/** @hidden */\nexport class ValueDownlinkModel extends DownlinkModel {\n  /** @hidden */\n  _views: ValueDownlink<unknown>[];\n  /** @hidden */\n  _state: Value;\n\n  constructor(context: DownlinkContext, hostUri: Uri, nodeUri: Uri, laneUri: Uri,\n              prio?: number, rate?: number, body?: Value, state: Value = Value.absent()) {\n    super(context, hostUri, nodeUri, laneUri, prio, rate, body);\n    this._state = state;\n  }\n\n  type(): DownlinkType {\n    return \"value\";\n  }\n\n  get(): Value {\n    return this._state;\n  }\n\n  set(newValue: Value): void {\n    newValue = this.valueWillSet(newValue);\n    const oldValue = this._state;\n    this.setState(newValue);\n    this.valueDidSet(newValue, oldValue);\n    this.command(newValue);\n  }\n\n  setState(state: Value): void {\n    this._state = state;\n  }\n\n  onEventMessage(message: EventMessage, host: Host): void {\n    super.onEventMessage(message, host);\n    this.onSetEvent(message.body());\n  }\n\n  protected onSetEvent(newValue: Value): void {\n    newValue = this.valueWillSet(newValue);\n    const oldValue = this._state;\n    this.setState(newValue);\n    this.valueDidSet(newValue, oldValue);\n  }\n\n  protected valueWillSet(newValue: Value): Value {\n    for (let i = 0; i < this._views.length; i += 1) {\n      newValue = this._views[i].valueWillSet(newValue);\n    }\n    return newValue;\n  }\n\n  protected valueDidSet(newValue: Value, oldValue: Value): void {\n    for (let i = 0; i < this._views.length; i += 1) {\n      this._views[i].valueDidSet(newValue, oldValue);\n    }\n  }\n}\n","// Copyright 2015-2020 SWIM.AI inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Cursor} from \"@swim/util\";\nimport {Value, Form} from \"@swim/structure\";\nimport {Inlet, Outlet} from \"@swim/streamlet\";\nimport {MapValueFunction, MapValueCombinator} from \"@swim/streamlet\";\nimport {WatchValueFunction, WatchValueCombinator} from \"@swim/streamlet\";\nimport {Uri} from \"@swim/uri\";\nimport {DownlinkContext} from \"./DownlinkContext\";\nimport {DownlinkOwner} from \"./DownlinkOwner\";\nimport {DownlinkType, DownlinkObserver, DownlinkInit, DownlinkFlags, Downlink} from \"./Downlink\";\nimport {ValueDownlinkModel} from \"./ValueDownlinkModel\";\n\nexport type ValueDownlinkWillSet<V extends VU, VU = V> = (newValue: V, downlink: ValueDownlink<V, VU>) => V | void;\nexport type VaueDownlinkDidSet<V extends VU, VU = V> = (newValue: V, oldValue: V, downlink: ValueDownlink<V, VU>) => void;\n\nexport interface ValueDownlinkObserver<V extends VU, VU = V> extends DownlinkObserver {\n  willSet?: ValueDownlinkWillSet<V, VU>;\n  didSet?: VaueDownlinkDidSet<V, VU>;\n}\n\nexport interface ValueDownlinkInit<V extends VU, VU = V> extends ValueDownlinkObserver<V, VU>, DownlinkInit {\n  valueForm?: Form<V, VU>;\n}\n\nexport class ValueDownlink<V extends VU, VU = V> extends Downlink implements Inlet<V>, Outlet<V> {\n  /** @hidden */\n  _observers: ReadonlyArray<ValueDownlinkObserver<V, VU>> | null;\n  /** @hidden */\n  _model: ValueDownlinkModel | null;\n  /** @hidden */\n  _valueForm: Form<V, VU>;\n  /** @hidden */\n  _state0: Value;\n  /** @hidden */\n  _input: Outlet<V> | null;\n  /** @hidden */\n  _outputs: ReadonlyArray<Inlet<V>> | null; // TODO: unify with observers\n  /** @hidden */\n  _version: number;\n\n  /** @hidden */\n  constructor(context: DownlinkContext, owner?: DownlinkOwner, init?: ValueDownlinkInit<V, VU>,\n              hostUri?: Uri, nodeUri?: Uri, laneUri?: Uri, prio?: number, rate?: number,\n              body?: Value, flags: number = DownlinkFlags.KeepLinkedSynced,\n              observers?: ReadonlyArray<ValueDownlinkObserver<V, VU>> | ValueDownlinkObserver<V, VU> | null,\n              valueForm?: Form<V, VU>, state0: Value = Value.absent()) {\n    super(context, owner, init, hostUri, nodeUri, laneUri, prio, rate, body, flags, observers);\n    if (init) {\n      const observer = this._observers![this._observers!.length - 1];\n      observer.willSet = init.willSet || observer.willSet;\n      observer.didSet = init.didSet || observer.didSet;\n      valueForm = init.valueForm ? init.valueForm : valueForm;\n    }\n    this._valueForm = valueForm || Form.forValue() as any;\n    this._state0 = state0;\n    this._input = null;\n    this._outputs = null;\n    this._version = -1;\n  }\n\n  protected copy(context: DownlinkContext, owner: DownlinkOwner | undefined,\n                 hostUri: Uri, nodeUri: Uri, laneUri: Uri, prio: number, rate: number,\n                 body: Value, flags: number, observers: ReadonlyArray<ValueDownlinkObserver<V, VU>> | null,\n                 valueForm?: Form<V, VU>, state0?: Value): this {\n    if (arguments.length === 10) {\n      state0 = this._state0;\n      valueForm = this._valueForm;\n    }\n    return new ValueDownlink(context, owner, void 0, hostUri, nodeUri, laneUri,\n                             prio, rate, body, flags, observers, valueForm, state0) as this;\n  }\n\n  type(): DownlinkType {\n    return \"value\";\n  }\n\n  valueForm(): Form<V, VU>;\n  valueForm<V2 extends V2U, V2U = V2>(valueForm: Form<V2, V2U>): ValueDownlink<V2, V2U>;\n  valueForm<V2 extends V2U, V2U = V2>(valueForm?: Form<V2, V2U>): Form<V, VU> | ValueDownlink<V2, V2U> {\n    if (valueForm === void 0) {\n      return this._valueForm;\n    } else {\n      return this.copy(this._context, this._owner, this._hostUri, this._nodeUri, this._laneUri,\n                       this._prio, this._rate, this._body, this._flags, this._observers,\n                       valueForm as any, this._state0) as any;\n    }\n  }\n\n  get(): V {\n    const value = this._model!.get();\n    const object = value.coerce(this._valueForm);\n    return object;\n  }\n\n  set(newObject: VU): void {\n    const newValue = this._valueForm.mold(newObject);\n    this._model!.set(newValue);\n  }\n\n  setState(state: Value): void {\n    this._model!.setState(state);\n  }\n\n  observe(observer: ValueDownlinkObserver<V, VU>): this {\n    return super.observe(observer);\n  }\n\n  willSet(willSet: ValueDownlinkWillSet<V, VU>): this {\n    return this.observe({willSet});\n  }\n\n  didSet(didSet: VaueDownlinkDidSet<V, VU>): this {\n    return this.observe({didSet});\n  }\n\n  /** @hidden */\n  valueWillSet(newValue: Value): Value {\n    const observers = this._observers;\n    const n = observers ? observers.length : 0;\n    let newObject: V | undefined;\n    for (let i = 0; i < n; i += 1) {\n      const observer = observers![i];\n      if (observer.willSet) {\n        if (newObject === void 0) {\n          newObject = newValue.coerce(this._valueForm);\n        }\n        const newResult = observer.willSet(newObject, this);\n        if (newResult !== void 0) {\n          newObject = newResult;\n          newValue = this._valueForm.mold(newObject);\n        }\n      }\n    }\n    return newValue;\n  }\n\n  /** @hidden */\n  valueDidSet(newValue: Value, oldValue: Value) {\n    const observers = this._observers;\n    const n = observers ? observers.length : 0;\n    let newObject: V | undefined;\n    let oldObject: V | undefined;\n    for (let i = 0; i < n; i += 1) {\n      const observer = observers![i];\n      if (observer.didSet) {\n        if (newObject === void 0) {\n          newObject = newValue.coerce(this._valueForm);\n        }\n        if (oldObject === void 0) {\n          oldObject = oldValue.coerce(this._valueForm);\n        }\n        observer.didSet(newObject, oldObject, this);\n      }\n    }\n    this.invalidate();\n    this.reconcile(0); // TODO: debounce update; track version\n  }\n\n  initialState(): Value;\n  initialState(state0: Value): this;\n  initialState(state0?: Value): Value | this {\n    if (state0 === void 0) {\n      return this._state0;\n    } else {\n      return this.copy(this._context, this._owner, this._hostUri, this._nodeUri, this._laneUri,\n                       this._prio, this._rate, this._body, this._flags, this._observers,\n                       this._valueForm, state0);\n    }\n  }\n\n  /** @hidden */\n  protected didAliasModel(): void {\n    this.onLinkedResponse();\n    this.valueDidSet(this._model!.get(), Value.absent());\n    this.onSyncedResponse();\n  }\n\n  open(): this {\n    const laneUri = this._laneUri;\n    if (laneUri.isEmpty()) {\n      throw new Error(\"no lane\");\n    }\n    let nodeUri = this._nodeUri;\n    if (nodeUri.isEmpty()) {\n      throw new Error(\"no node\");\n    }\n    let hostUri = this._hostUri;\n    if (hostUri.isEmpty()) {\n      hostUri = nodeUri.endpoint();\n      nodeUri = hostUri.unresolve(nodeUri);\n    }\n    let model = this._context.getDownlink(hostUri, nodeUri, laneUri);\n    if (model) {\n      if (!(model instanceof ValueDownlinkModel)) {\n        throw new Error(\"downlink type mismatch\");\n      }\n      model.addDownlink(this);\n      this._model = model as ValueDownlinkModel;\n      setTimeout(this.didAliasModel.bind(this));\n    } else {\n      model = new ValueDownlinkModel(this._context, hostUri, nodeUri, laneUri, this._prio,\n                                     this._rate, this._body, this._state0);\n      model.addDownlink(this);\n      this._context.openDownlink(model);\n      this._model = model as ValueDownlinkModel;\n    }\n    if (this._owner) {\n      this._owner.addDownlink(this);\n    }\n    return this;\n  }\n\n  input(): Outlet<V> | null {\n    return this._input;\n  }\n\n  bindInput(input: Outlet<V> | null): void {\n    if (this._input !== null) {\n      this._input.unbindOutput(this);\n    }\n    this._input = input;\n    if (this._input !== null) {\n      this._input.bindOutput(this);\n    }\n  }\n\n  unbindInput(): void {\n    if (this._input !== null) {\n      this._input.unbindOutput(this);\n    }\n    this._input = null;\n  }\n\n  disconnectInputs(): void {\n    const input = this._input;\n    if (input !== null) {\n      input.unbindOutput(this);\n      this._input = null;\n      input.disconnectInputs();\n    }\n  }\n\n  outputIterator(): Cursor<Inlet<V>> {\n    return this._outputs !== null ? Cursor.array(this._outputs) : Cursor.empty();\n  }\n\n  bindOutput(output: Inlet<V>): void {\n    const oldOutputs = this._outputs;\n    const n = oldOutputs !== null ? oldOutputs.length : 0;\n    const newOutputs = new Array<Inlet<V>>(n + 1);\n    for (let i = 0; i < n; i += 1) {\n      newOutputs[i] = oldOutputs![i];\n    }\n    newOutputs[n] = output;\n    this._outputs = newOutputs;\n  }\n\n  unbindOutput(output: Inlet<V>): void {\n    const oldOutputs = this._outputs;\n    const n = oldOutputs !== null ? oldOutputs.length : 0;\n    for (let i = 0; i < n; i += 1) {\n      if (oldOutputs![i] === output) {\n        if (n > 1) {\n          const newOutputs = new Array<Inlet<V>>(n - 1);\n          for (let j = 0; j < i; j += 1) {\n            newOutputs[j] = oldOutputs![j];\n          }\n          for (let j = i; j < n - 1; j += 1) {\n            newOutputs[j] = oldOutputs![j + 1];\n          }\n          this._outputs = newOutputs;\n        } else {\n          this._outputs = null;\n        }\n        break;\n      }\n    }\n  }\n\n  unbindOutputs(): void {\n    const oldOutputs = this._outputs;\n    if (oldOutputs !== null) {\n      this._outputs = null;\n      for (let i = 0, n = oldOutputs.length; i < n; i += 1) {\n        oldOutputs[i].unbindInput();\n      }\n    }\n  }\n\n  disconnectOutputs(): void {\n    const outputs = this._outputs;\n    if (outputs !== null) {\n      this._outputs = null;\n      for (let i = 0, n = outputs.length; i < n; i += 1) {\n        const output = outputs[i];\n        output.unbindInput();\n        output.disconnectOutputs();\n      }\n    }\n  }\n\n  invalidateOutput(): void {\n    this.invalidate();\n  }\n\n  invalidateInput(): void {\n    this.invalidate();\n  }\n\n  invalidate(): void {\n    if (this._version >= 0) {\n      this.willInvalidate();\n      this._version = -1;\n      this.onInvalidate();\n      const n = this._outputs !== null ? this._outputs.length : 0;\n      for (let i = 0; i < n; i += 1) {\n        this._outputs![i].invalidateOutput();\n      }\n      this.didInvalidate();\n    }\n  }\n\n  reconcileOutput(version: number): void {\n    this.reconcile(version);\n  }\n\n  reconcileInput(version: number): void {\n    this.reconcile(version);\n  }\n\n  reconcile(version: number): void {\n    if (this._version < 0) {\n      this.willReconcile(version);\n      this._version = version;\n      if (this._input !== null) {\n        this._input.reconcileInput(version);\n      }\n      this.onReconcile(version);\n      const n = this._outputs !== null ? this._outputs.length : 0;\n      for (let i = 0; i < n; i += 1) {\n        this._outputs![i].reconcileOutput(version);\n      }\n      this.didReconcile(version);\n    }\n  }\n\n  protected willInvalidate(): void {\n    // stub\n  }\n\n  protected onInvalidate(): void {\n    // stub\n  }\n\n  protected didInvalidate(): void {\n    // stub\n  }\n\n  protected willReconcile(version: number): void {\n    // stub\n  }\n\n  protected onReconcile(version: number): void {\n    if (this._input !== null) {\n      const value = this._input.get();\n      if (value !== void 0) {\n        this.set(value);\n      }\n    }\n  }\n\n  protected didReconcile(version: number): void {\n    // stub\n  }\n\n  memoize(): Outlet<V> {\n    return this;\n  }\n\n  map<V2>(func: MapValueFunction<V, V2>): Outlet<V2> {\n    const combinator = new MapValueCombinator<V, V2>(func);\n    combinator.bindInput(this);\n    return combinator;\n  }\n\n  watch(func: WatchValueFunction<V>): this {\n    const combinator = new WatchValueCombinator<V>(func);\n    combinator.bindInput(this);\n    return this;\n  }\n}\n","// Copyright 2015-2020 SWIM.AI inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {AbstractRecordOutlet} from \"@swim/dataflow\";\nimport {Downlink} from \"./Downlink\";\n\nexport abstract class DownlinkRecord extends AbstractRecordOutlet {\n  readonly downlink: Downlink;\n}\n","// Copyright 2015-2020 SWIM.AI inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Cursor} from \"@swim/util\";\nimport {AnyItem, Item, AnyValue, Value, Record, AnyText, AnyNum, Num} from \"@swim/structure\";\nimport {DownlinkRecord} from \"./DownlinkRecord\";\nimport {ListDownlink} from \"./ListDownlink\";\n\nexport class ListDownlinkRecord extends DownlinkRecord {\n  /** @hidden */\n  readonly _downlink: ListDownlink<Value, AnyValue>;\n\n  constructor(downlink: ListDownlink<Value, AnyValue>) {\n    super();\n    this._downlink = downlink;\n  }\n\n  get downlink(): ListDownlink<Value, AnyValue> {\n    return this._downlink;\n  }\n\n  isEmpty(): boolean {\n    return this._downlink.isEmpty();\n  }\n\n  isArray(): boolean {\n    return true;\n  }\n\n  isObject(): boolean {\n    return this._downlink.isEmpty();\n  }\n\n  get length(): number {\n    return this._downlink.length;\n  }\n\n  get size(): number {\n    return this._downlink.length;\n  }\n\n  has(key: AnyValue): boolean {\n    return false;\n  }\n\n  get(): Record;\n  get(key: AnyValue): Value;\n  get(key?: AnyValue): Value {\n    if (key === void 0) {\n      return this;\n    } else {\n      return Value.absent();\n    }\n  }\n\n  getAttr(key: AnyText): Value {\n    return Value.absent();\n  }\n\n  getSlot(key: AnyValue): Value {\n    return Value.absent();\n  }\n\n  getItem(index: AnyNum): Item {\n    if (index instanceof Num) {\n      index = index.value;\n    }\n    const n = this._downlink.length;\n    if (index < 0) {\n      index = n + index;\n    }\n    index = Math.min(Math.max(0, index), n - 1);\n    if (index >= 0) {\n      return this._downlink.get(index);\n    }\n    return Item.absent();\n  }\n\n  set(key: AnyValue, newValue: AnyValue): this {\n    throw new Error(\"unsupported\");\n  }\n\n  setAttr(key: AnyText, newValue: AnyValue): this {\n    throw new Error(\"unsupported\");\n  }\n\n  setSlot(key: AnyValue, newValue: AnyValue): this {\n    throw new Error(\"unsupported\");\n  }\n\n  setItem(index: AnyNum, newItem: AnyItem): this {\n    if (index instanceof Num) {\n      index = index.value;\n    }\n    const n = this._downlink.length;\n    if (index < 0) {\n      index = n + index;\n    }\n    index = Math.min(Math.max(0, index), n - 1);\n    if (index >= 0) {\n      this._downlink.set(index, Value.fromAny(newItem));\n    }\n    return this;\n  }\n\n  push(...newItems: AnyItem[]): number {\n    return this._downlink.push.apply(this._downlink, arguments);\n  }\n\n  splice(start: number, deleteCount?: number, ...newItems: AnyItem[]): Item[] {\n    return this._downlink.splice.apply(this._downlink, arguments);\n  }\n\n  delete(key: AnyValue): Item {\n    return Item.absent();\n  }\n\n  clear(): void {\n    this._downlink.clear();\n  }\n\n  forEach<T, S = unknown>(callback: (this: S, item: Item, index: number) => T | void,\n                          thisArg?: S): T | undefined {\n    return this._downlink.forEach(function (value: Value, index: number): T | void {\n      return callback.call(thisArg, value, index);\n    });\n  }\n\n  keyIterator(): Cursor<Value> {\n    return Cursor.empty();\n  }\n}\n","// Copyright 2015-2020 SWIM.AI inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Cursor} from \"@swim/util\";\nimport {AnyItem, Item, Slot, AnyValue, Value, Record, AnyText, AnyNum, Num} from \"@swim/structure\";\nimport {KeyEffect} from \"@swim/streamlet\";\nimport {DownlinkRecord} from \"./DownlinkRecord\";\nimport {MapDownlink} from \"./MapDownlink\";\n\nexport class MapDownlinkRecord extends DownlinkRecord {\n  /** @hidden */\n  readonly _downlink: MapDownlink<Value, Value, AnyValue, AnyValue>;\n\n  constructor(downlink: MapDownlink<Value, Value, AnyValue, AnyValue>) {\n    super();\n    this._downlink = downlink;\n    this._downlink.observe(this);\n  }\n\n  get downlink(): MapDownlink<Value, Value, AnyValue, AnyValue> {\n    return this._downlink;\n  }\n\n  isEmpty(): boolean {\n    return this._downlink.isEmpty();\n  }\n\n  isArray(): boolean {\n    return this._downlink.isEmpty();\n  }\n\n  isObject(): boolean {\n    return true;\n  }\n\n  get length(): number {\n    return this._downlink.size;\n  }\n\n  has(key: AnyValue): boolean {\n    return this._downlink.has(key);\n  }\n\n  get(): Record;\n  get(key: AnyValue): Value;\n  get(key?: AnyValue): Value {\n    if (key === void 0) {\n      return this;\n    } else {\n      return this._downlink.get(key);\n    }\n  }\n\n  getAttr(key: AnyText): Value {\n    return Value.absent();\n  }\n\n  getSlot(key: AnyValue): Value {\n    return this.get(key);\n  }\n\n  getItem(index: AnyNum): Item {\n    if (index instanceof Num) {\n      index = index.value;\n    }\n    const n = this._downlink.size;\n    if (index < 0) {\n      index = n + index;\n    }\n    index = Math.min(Math.max(0, index), n - 1);\n    if (index >= 0) {\n      const entry = this._downlink.getEntry(index)!;\n      return Slot.of(entry[0], entry[1]);\n    }\n    return Item.absent();\n  }\n\n  set(key: AnyValue, newValue: AnyValue): this {\n    this._downlink.set(key, newValue);\n    return this;\n  }\n\n  setAttr(key: AnyText, newValue: AnyValue): this {\n    throw new Error(\"unsupported\");\n  }\n\n  setSlot(key: AnyValue, newValue: AnyValue): this {\n    return this.set(key, newValue);\n  }\n\n  setItem(index: number, newItem: AnyItem): this {\n    throw new Error(\"unsupported\");\n  }\n\n  push(...newItems: AnyItem[]): number {\n    throw new Error(\"unsupported\");\n  }\n\n  splice(start: number, deleteCount?: number, ...newItems: AnyItem[]): Item[] {\n    throw new Error(\"unsupported\");\n  }\n\n  delete(key: AnyValue): Item {\n    key = Value.fromAny(key);\n    const oldValue = this._downlink.get(key);\n    if (this._downlink.delete(key)) {\n      return Slot.of(key, oldValue);\n    }\n    return Item.absent();\n  }\n\n  clear(): void {\n    this._downlink.clear();\n  }\n\n  forEach<T, S = unknown>(callback: (this: S, item: Item, index: number) => T | void,\n                          thisArg?: S): T | undefined {\n    let index = 0;\n    return this._downlink.forEach(function (key: Value, value: Value): T | void {\n      const result = callback.call(thisArg, Slot.of(key, value), index);\n      index += 1;\n      return result;\n    });\n  }\n\n  keyIterator(): Cursor<Value> {\n    return this._downlink.keys();\n  }\n\n  didUpdate(key: Value, newValue: Value, oldValue: Value): void {\n    this.invalidateInputKey(key, KeyEffect.Update);\n    this.reconcileInput(0); // TODO: debounce\n  }\n\n  didRemove(key: Value, oldValue: Value): void {\n    this.invalidateInputKey(key, KeyEffect.Remove);\n    this.reconcileInput(0); // TODO: debounce\n  }\n\n  didDrop(lower: number): void {\n    // TODO\n  }\n\n  didTake(upper: number): void {\n    // TODO\n  }\n\n  didClear(): void {\n    // TODO\n  }\n}\n","// Copyright 2015-2020 SWIM.AI inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Cursor} from \"@swim/util\";\nimport {AnyItem, Item, Field, AnyValue, Value, Record, AnyText, AnyNum} from \"@swim/structure\";\nimport {DownlinkRecord} from \"./DownlinkRecord\";\nimport {ValueDownlink} from \"./ValueDownlink\";\n\nexport class ValueDownlinkRecord extends DownlinkRecord {\n  /** @hidden */\n  readonly _downlink: ValueDownlink<Value, AnyValue>;\n\n  constructor(downlink: ValueDownlink<Value, AnyValue>) {\n    super();\n    this._downlink = downlink;\n    this._downlink.observe(this);\n  }\n\n  get downlink(): ValueDownlink<Value, AnyValue> {\n    return this._downlink;\n  }\n\n  isEmpty(): boolean {\n    const value = this._downlink.get();\n    if (value instanceof Record) {\n      return value.isEmpty();\n    } else {\n      return !value.isDefined();\n    }\n  }\n\n  isArray(): boolean {\n    const value = this._downlink.get();\n    if (value instanceof Record) {\n      return value.isArray();\n    } else {\n      return true;\n    }\n  }\n\n  isObject(): boolean {\n    const value = this._downlink.get();\n    if (value instanceof Record) {\n      return value.isObject();\n    } else {\n      return !value.isDefined();\n    }\n  }\n\n  get length(): number {\n    const value = this._downlink.get();\n    if (value instanceof Record) {\n      return value.length;\n    } else if (value.isDefined()) {\n      return 1;\n    } else {\n      return 0;\n    }\n  }\n\n  has(key: AnyValue): boolean {\n    const value = this._downlink.get();\n    if (value instanceof Record) {\n      return value.has(key);\n    } else {\n      return false;\n    }\n  }\n\n  get(): Record;\n  get(key: AnyValue): Value;\n  get(key?: AnyValue): Value {\n    if (key === void 0) {\n      return this;\n    } else {\n      const value = this._downlink.get();\n      if (value instanceof Record) {\n        return value.get(key);\n      } else {\n        return Value.absent();\n      }\n    }\n  }\n\n  getAttr(key: AnyText): Value {\n    const value = this._downlink.get();\n    if (value instanceof Record) {\n      return value.getAttr(key);\n    } else {\n      return Value.absent();\n    }\n  }\n\n  getSlot(key: AnyValue): Value {\n    const value = this._downlink.get();\n    if (value instanceof Record) {\n      return value.getSlot(key);\n    } else {\n      return Value.absent();\n    }\n  }\n\n  getField(key: AnyValue): Field | undefined {\n    const value = this._downlink.get();\n    if (value instanceof Record) {\n      return value.getField(key);\n    } else {\n      return void 0;\n    }\n  }\n\n  getItem(index: AnyNum): Item {\n    const value = this._downlink.get();\n    if (value instanceof Record) {\n      return value.getItem(index);\n    } else {\n      return value;\n    }\n  }\n\n  set(key: AnyValue, newValue: AnyValue): this {\n    const value = this._downlink.get();\n    if (value instanceof Record) {\n      value.set(key, newValue);\n    } else {\n      throw new Error(\"unsupported\");\n    }\n    return this;\n  }\n\n  setAttr(key: AnyText, newValue: AnyValue): this {\n    const value = this._downlink.get();\n    if (value instanceof Record) {\n      value.setAttr(key, newValue);\n    } else {\n      throw new Error(\"unsupported\");\n    }\n    return this;\n  }\n\n  setSlot(key: AnyValue, newValue: AnyValue): this {\n    const value = this._downlink.get();\n    if (value instanceof Record) {\n      value.setSlot(key, newValue);\n    } else {\n      throw new Error(\"unsupported\");\n    }\n    return this;\n  }\n\n  setItem(index: number, newItem: AnyItem): this {\n    const value = this._downlink.get();\n    if (value instanceof Record) {\n      value.setItem(index, newItem);\n    } else {\n      this._downlink.set(Item.fromAny(newItem).toValue());\n    }\n    return this;\n  }\n\n  push(...newItems: AnyItem[]): number {\n    const value = this._downlink.get();\n    if (value instanceof Record) {\n      return value.push.apply(value, arguments);\n    } else {\n      throw new Error(\"unsupported\");\n    }\n  }\n\n  splice(start: number, deleteCount?: number, ...newItems: AnyItem[]): Item[] {\n    const value = this._downlink.get();\n    if (value instanceof Record) {\n      return value.splice.apply(value, arguments);\n    } else {\n      throw new Error(\"unsupported\");\n    }\n  }\n\n  delete(key: AnyValue): Item {\n    const value = this._downlink.get();\n    if (value instanceof Record) {\n      return value.delete(key);\n    } else {\n      return Value.absent();\n    }\n  }\n\n  clear(): void {\n    const value = this._downlink.get();\n    if (value instanceof Record) {\n      value.clear();\n    } else {\n      throw new Error(\"unsupported\");\n    }\n  }\n\n  forEach<T, S = unknown>(callback: (this: S, item: Item, index: number) => T | void,\n                          thisArg?: S): T | undefined {\n    const value = this._downlink.get();\n    return value.forEach(callback, thisArg);\n  }\n\n  keyIterator(): Cursor<Value> {\n    const value = this._downlink.get();\n    if (value instanceof Record) {\n      throw new Error(); // TODO\n    } else {\n      return Cursor.empty();\n    }\n  }\n\n  didSet(newValue: Value, oldValue: Value): void {\n    this.invalidateInput();\n    this.reconcileInput(0); // TODO: debounce\n  }\n}\n","// Copyright 2015-2020 SWIM.AI inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Record} from \"@swim/structure\";\nimport {RecordModel, Transmuter} from \"@swim/dataflow\";\nimport {DownlinkStreamlet} from \"./DownlinkStreamlet\";\nimport {WarpRef} from \"../WarpRef\";\n\n/** @hidden */\nexport class DownlinkTransmuter extends Transmuter {\n  warp: WarpRef | undefined;\n\n  constructor(warp?: WarpRef) {\n    super();\n    this.warp = warp;\n  }\n\n  transmute(model: RecordModel): Record {\n    if (model.tag() === \"link\") {\n      const streamlet = new DownlinkStreamlet(this.warp, model);\n      streamlet.compile();\n      return streamlet;\n    }\n    return model;\n  }\n}\n","// Copyright 2015-2020 SWIM.AI inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Map} from \"@swim/util\";\nimport {Value, Form} from \"@swim/structure\";\nimport {Outlet, Inoutlet, StreamletScope, Out, Inout} from \"@swim/streamlet\";\nimport {AbstractRecordStreamlet, Transmuter} from \"@swim/dataflow\";\nimport {DownlinkType, Downlink} from \"./Downlink\";\nimport {ValueDownlink} from \"./ValueDownlink\";\nimport {DownlinkRecord} from \"./DownlinkRecord\";\nimport {MapDownlinkRecord} from \"./MapDownlinkRecord\";\nimport {DownlinkTransmuter} from \"./DownlinkTransmuter\";\nimport {WarpRef} from \"../WarpRef\";\nimport {client} from \"..\";\n\nexport class DownlinkStreamlet extends AbstractRecordStreamlet {\n  warp: WarpRef | undefined;\n  downlink: Downlink | undefined;\n  /** @hidden */\n  downlinkRecord: DownlinkRecord | undefined;\n  /** @hidden */\n  inputHostUri: string | undefined;\n  /** @hidden */\n  inputNodeUri: string | undefined;\n  /** @hidden */\n  inputLaneUri: string | undefined;\n  /** @hidden */\n  inputPrio: number | undefined;\n  /** @hidden */\n  inputRate: number | undefined;\n  /** @hidden */\n  inputBody: Value | undefined;\n  /** @hidden */\n  inputType: DownlinkType | undefined;\n\n  constructor(warp?: WarpRef, scope?: StreamletScope<Value> | null) {\n    super(scope);\n    this.warp = warp;\n  }\n\n  @Inout\n  hostUri: Inoutlet<Value> = this.inoutlet();\n\n  @Inout\n  nodeUri: Inoutlet<Value> = this.inoutlet();\n\n  @Inout\n  laneUri: Inoutlet<Value> = this.inoutlet();\n\n  @Inout\n  prio: Inoutlet<Value> = this.inoutlet();\n\n  @Inout\n  rate: Inoutlet<Value> = this.inoutlet();\n\n  @Inout(\"body\")\n  bodyValue: Inoutlet<Value> = this.inoutlet();\n\n  @Inout\n  type: Inoutlet<Value> = this.inoutlet();\n\n  @Out\n  state: Outlet<Value | Map<Value, Value>>;\n\n  getOutput(outlet: Outlet<Value> | string): Value | undefined {\n    outlet = this.outlet(outlet)!;\n    if (outlet === this.state) {\n      if (this.downlink instanceof ValueDownlink) {\n        return this.downlink.get();\n      } else if (this.downlinkRecord) {\n        return this.downlinkRecord;\n      }\n    }\n    return void 0;\n  }\n\n  protected onReconcile(version: number): void {\n    const hostUri = this.castInput(this.hostUri, Form.forString());\n    const nodeUri = this.castInput(this.nodeUri, Form.forString());\n    const laneUri = this.castInput(this.laneUri, Form.forString());\n    const prio = this.castInput(this.prio, Form.forNumber(), 0);\n    const rate = this.castInput(this.rate, Form.forNumber(), 0);\n    const body = this.getInput(this.bodyValue);\n    const type = this.castInput(this.type, Form.forString(), void 0) as DownlinkType | undefined;\n    if (hostUri !== this.inputHostUri || nodeUri !== this.inputNodeUri || laneUri !== this.inputLaneUri\n        || prio !== this.inputPrio || rate !== this.inputRate\n        || (body === void 0 ? this.inputBody !== void 0 : !body.equals(this.inputBody))\n        || type !== this.inputType) {\n      if (this.downlink) {\n        this.downlink.close();\n        this.downlink = void 0;\n        this.downlinkRecord = void 0;\n      }\n      this.inputHostUri = hostUri;\n      this.inputNodeUri = nodeUri;\n      this.inputLaneUri = laneUri;\n      this.inputPrio = prio;\n      this.inputRate = rate;\n      this.inputBody = body;\n      this.inputType = type;\n      const warp = this.warp || client;\n      if (type === \"map\") {\n        let downlink = warp.downlinkMap();\n        if (hostUri !== void 0) {\n          downlink = downlink.hostUri(hostUri);\n        }\n        if (nodeUri !== void 0) {\n          downlink = downlink.nodeUri(nodeUri);\n        }\n        if (laneUri !== void 0) {\n          downlink = downlink.laneUri(laneUri);\n        }\n        if (prio !== 0) {\n          downlink = downlink.prio(prio);\n        }\n        if (rate !== 0) {\n          downlink = downlink.rate(rate);\n        }\n        if (body !== void 0) {\n          downlink = downlink.body(body);\n        }\n        downlink = downlink.open();\n        this.state = downlink;\n        this.downlink = downlink;\n        this.downlinkRecord = new MapDownlinkRecord(downlink);\n      } else if (type === \"value\") {\n        let downlink = warp.downlinkValue();\n        if (hostUri !== void 0) {\n          downlink = downlink.hostUri(hostUri);\n        }\n        if (nodeUri !== void 0) {\n          downlink = downlink.nodeUri(nodeUri);\n        }\n        if (laneUri !== void 0) {\n          downlink = downlink.laneUri(laneUri);\n        }\n        if (prio !== void 0) {\n          downlink = downlink.prio(prio);\n        }\n        if (rate !== void 0) {\n          downlink = downlink.rate(rate);\n        }\n        if (body !== void 0) {\n          downlink = downlink.body(body);\n        }\n        downlink = downlink.open();\n        this.state = downlink;\n        this.downlink = downlink;\n      }\n    }\n  }\n\n  private static _transmuter: DownlinkTransmuter | undefined;\n\n  static transmuter(warp?: WarpRef): Transmuter {\n    if (warp === void 0) {\n      if (!DownlinkStreamlet._transmuter) {\n        DownlinkStreamlet._transmuter = new DownlinkTransmuter();\n      }\n      return DownlinkStreamlet._transmuter;\n    } else {\n      return new DownlinkTransmuter(warp);\n    }\n  }\n}\n","// Copyright 2015-2020 SWIM.AI inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {AnyValue, Value} from \"@swim/structure\";\nimport {Uri} from \"@swim/uri\";\nimport {Host} from \"../host/Host\";\nimport {DownlinkOwner} from \"../downlink/DownlinkOwner\";\nimport {Downlink} from \"../downlink/Downlink\";\nimport {EventDownlinkInit, EventDownlink} from \"../downlink/EventDownlink\";\nimport {ListDownlinkInit, ListDownlink} from \"../downlink/ListDownlink\";\nimport {MapDownlinkInit, MapDownlink} from \"../downlink/MapDownlink\";\nimport {ValueDownlinkInit, ValueDownlink} from \"../downlink/ValueDownlink\";\nimport {RefContext} from \"./RefContext\";\nimport {WarpRef} from \"../WarpRef\";\nimport {\n  WarpDidConnect,\n  WarpDidAuthenticate,\n  WarpDidDeauthenticate,\n  WarpDidDisconnect,\n  WarpDidFail,\n  WarpObserver,\n} from \"../WarpObserver\";\n\nexport abstract class BaseRef implements DownlinkOwner, WarpRef {\n  /** @hidden */\n  readonly _context: RefContext;\n  /** @hidden */\n  _host: Host | undefined;\n  /** @hidden */\n  _downlinks: Downlink[];\n  /** @hidden */\n  _downlinkCount: number;\n  /** @hidden */\n  _observers: ReadonlyArray<WarpObserver> | null;\n\n  constructor(context: RefContext) {\n    this._context = context;\n    this._host = void 0;\n    this._downlinks = [];\n    this._observers = null;\n  }\n\n  abstract hostUri(): Uri;\n\n  isConnected(): boolean {\n    return this._host ? this._host.isConnected() : false;\n  }\n\n  isAuthenticated(): boolean {\n    return this._host ? this._host.isAuthenticated() : false;\n  }\n\n  session(): Value {\n    return this._host ? this._host.session() : Value.absent();\n  }\n\n  authenticate(credentials: AnyValue): void {\n    this._context.authenticate(this.hostUri(), credentials);\n  }\n\n  abstract downlink(init?: EventDownlinkInit): EventDownlink;\n\n  abstract downlinkList(init?: ListDownlinkInit<Value, AnyValue>): ListDownlink<Value, AnyValue>;\n  abstract downlinkList<V extends VU, VU = V>(init?: ListDownlinkInit<V, VU>): ListDownlink<V, VU>;\n\n  abstract downlinkMap(init?: MapDownlinkInit<Value, Value, AnyValue, AnyValue>): MapDownlink<Value, Value, AnyValue, AnyValue>;\n  abstract downlinkMap<K extends KU, V extends VU, KU = K, VU = V>(init?: MapDownlinkInit<K, V, KU, VU>): MapDownlink<K, V, KU, VU>;\n\n  abstract downlinkValue(init?: ValueDownlinkInit<Value, AnyValue>): ValueDownlink<Value, AnyValue>;\n  abstract downlinkValue<V extends VU, VU = V>(init?: ValueDownlinkInit<V, VU>): ValueDownlink<V, VU>;\n\n  /** @hidden */\n  addDownlink(downlink: Downlink): void {\n    if (this._downlinks.length === 0) {\n      this.open();\n    }\n    this._downlinks.push(downlink);\n  }\n\n  /** @hidden */\n  removeDownlink(downlink: Downlink): void {\n    const i = this._downlinks.indexOf(downlink);\n    if (i >= 0) {\n      this._downlinks.splice(i, 1);\n      if (this._downlinks.length === 0) {\n        this.close();\n      }\n    }\n  }\n\n  open(): void {\n    this._context.openRef(this);\n  }\n\n  close(): void {\n    this._context.closeRef(this);\n  }\n\n  /** @hidden */\n  closeUp(): void {\n    const downlinks = this._downlinks;\n    this._downlinks = [];\n    for (let i = 0, n = downlinks.length; i < n; i += 1) {\n      downlinks[i].close();\n    }\n  }\n\n  observe(observer: WarpObserver): this {\n    const oldObservers = this._observers;\n    const n = oldObservers ? oldObservers.length : 0;\n    const newObservers = new Array<WarpObserver>(n + 1);\n    for (let i = 0; i < n; i += 1) {\n      newObservers[i] = oldObservers![i];\n    }\n    newObservers[n] = observer;\n    this._observers = newObservers;\n    return this;\n  }\n\n  unobserve(observer: unknown): this {\n    const oldObservers = this._observers;\n    const n = oldObservers ? oldObservers.length : 0;\n    for (let i = 0; i < n; i += 1) {\n      const oldObserver = oldObservers![i] as {[key: string]: unknown};\n      let found = oldObserver === observer; // check object identity\n      if (!found) {\n        for (const key in oldObserver) { // check property identity\n          if (oldObserver[key] === observer) {\n            found = true;\n            break;\n          }\n        }\n      }\n      if (found) {\n        if (n > 1) {\n          const newObservers = new Array<WarpObserver>(n - 1);\n          for (let j = 0; j < i; j += 1) {\n            newObservers[j] = oldObservers![j];\n          }\n          for (let j = i + 1; j < n; j += 1) {\n            newObservers[j - 1] = oldObservers![j];\n          }\n          this._observers = newObservers;\n        } else {\n          this._observers = null;\n        }\n        break;\n      }\n    }\n    return this;\n  }\n\n  didConnect(didConnect: WarpDidConnect): this {\n    return this.observe({didConnect});\n  }\n\n  didAuthenticate(didAuthenticate: WarpDidAuthenticate): this {\n    return this.observe({didAuthenticate});\n  }\n\n  didDeauthenticate(didDeauthenticate: WarpDidDeauthenticate): this {\n    return this.observe({didDeauthenticate});\n  }\n\n  didDisconnect(didDisconnect: WarpDidDisconnect): this {\n    return this.observe({didDisconnect});\n  }\n\n  didFail(didFail: WarpDidFail): this {\n    return this.observe({didFail});\n  }\n\n  /** @hidden */\n  hostDidConnect(host: Host): void {\n    this._host = host;\n    const observers = this._observers;\n    const n = observers ? observers.length : 0;\n    for (let i = 0; i < n; i += 1) {\n      const observer = observers![i];\n      if (observer.didConnect) {\n        observer.didConnect(host, this);\n      }\n    }\n  }\n\n  /** @hidden */\n  hostDidAuthenticate(body: Value, host: Host): void {\n    const observers = this._observers;\n    const n = observers ? observers.length : 0;\n    for (let i = 0; i < n; i += 1) {\n      const observer = observers![i];\n      if (observer.didAuthenticate) {\n        observer.didAuthenticate(body, host, this);\n      }\n    }\n  }\n\n  /** @hidden */\n  hostDidDeauthenticate(body: Value, host: Host): void {\n    const observers = this._observers;\n    const n = observers ? observers.length : 0;\n    for (let i = 0; i < n; i += 1) {\n      const observer = observers![i];\n      if (observer.didDeauthenticate) {\n        observer.didDeauthenticate(body, host, this);\n      }\n    }\n  }\n\n  /** @hidden */\n  hostDidDisconnect(host: Host): void {\n    this._host = void 0;\n    const observers = this._observers;\n    const n = observers ? observers.length : 0;\n    for (let i = 0; i < n; i += 1) {\n      const observer = observers![i];\n      if (observer.didDisconnect) {\n        observer.didDisconnect(host, this);\n      }\n    }\n  }\n\n  /** @hidden */\n  hostDidFail(error: unknown, host: Host): void {\n    const observers = this._observers;\n    const n = observers ? observers.length : 0;\n    for (let i = 0; i < n; i += 1) {\n      const observer = observers![i];\n      if (observer.didFail) {\n        observer.didFail(error, host, this);\n      }\n    }\n  }\n}\n","// Copyright 2015-2020 SWIM.AI inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Value, AnyValue} from \"@swim/structure\";\nimport {AnyUri, Uri} from \"@swim/uri\";\nimport {EventDownlinkInit, EventDownlink} from \"../downlink/EventDownlink\";\nimport {ListDownlinkInit, ListDownlink} from \"../downlink/ListDownlink\";\nimport {MapDownlinkInit, MapDownlink} from \"../downlink/MapDownlink\";\nimport {ValueDownlinkInit, ValueDownlink} from \"../downlink/ValueDownlink\";\nimport {RefContext} from \"./RefContext\";\nimport {BaseRef} from \"./BaseRef\";\nimport {HostRef} from \"./HostRef\";\nimport {NodeRef} from \"./NodeRef\";\n\nexport class LaneRef extends BaseRef {\n  /** @hidden */\n  readonly _hostUri: Uri;\n  /** @hidden */\n  readonly _nodeUri: Uri;\n  /** @hidden */\n  readonly _laneUri: Uri;\n\n  constructor(context: RefContext, hostUri: Uri, nodeUri: Uri, laneUri: Uri) {\n    super(context);\n    this._hostUri = hostUri;\n    this._nodeUri = nodeUri;\n    this._laneUri = laneUri;\n  }\n\n  hostUri(): Uri {\n    return this._hostUri;\n  }\n\n  nodeUri(): Uri {\n    return this._nodeUri;\n  }\n\n  laneUri(): Uri {\n    return this._laneUri;\n  }\n\n  hostRef(hostUri: AnyUri): HostRef {\n    hostUri = Uri.fromAny(hostUri);\n    return new HostRef(this._context, hostUri);\n  }\n\n  nodeRef(nodeUri: AnyUri): NodeRef {\n    nodeUri = Uri.fromAny(nodeUri);\n    return new NodeRef(this._context, this._hostUri, nodeUri);\n  }\n\n  laneRef(laneUri: AnyUri): LaneRef {\n    laneUri = Uri.fromAny(laneUri);\n    return new LaneRef(this._context, this._hostUri, this._nodeUri, laneUri);\n  }\n\n  downlink(init?: EventDownlinkInit): EventDownlink {\n    return new EventDownlink(this._context, this, init, this._hostUri, this._nodeUri, this._laneUri);\n  }\n\n  downlinkList(init?: ListDownlinkInit<Value, AnyValue>): ListDownlink<Value, AnyValue>;\n  downlinkList<V extends VU, VU = V>(init?: ListDownlinkInit<V, VU>): ListDownlink<V, VU>;\n  downlinkList<V extends VU, VU = V>(init?: ListDownlinkInit<V, VU>): ListDownlink<V, VU> {\n    return new ListDownlink(this._context, this, init, this._hostUri, this._nodeUri, this._laneUri);\n  }\n\n  downlinkMap(init?: MapDownlinkInit<Value, Value, AnyValue, AnyValue>): MapDownlink<Value, Value, AnyValue, AnyValue>;\n  downlinkMap<K extends KU, V extends VU, KU = K, VU = V>(init?: MapDownlinkInit<K, V, KU, VU>): MapDownlink<K, V, KU, VU>;\n  downlinkMap<K extends KU, V extends VU, KU = K, VU = V>(init?: MapDownlinkInit<K, V, KU, VU>): MapDownlink<K, V, KU, VU> {\n    return new MapDownlink(this._context, this, init, this._hostUri, this._nodeUri, this._laneUri);\n  }\n\n  downlinkValue(init?: ValueDownlinkInit<Value, AnyValue>): ValueDownlink<Value, AnyValue>;\n  downlinkValue<V extends VU, VU = V>(init?: ValueDownlinkInit<V, VU>): ValueDownlink<V, VU>;\n  downlinkValue<V extends VU, VU = V>(init?: ValueDownlinkInit<V, VU>): ValueDownlink<V, VU> {\n    return new ValueDownlink(this._context, this, init, this._hostUri, this._nodeUri, this._laneUri);\n  }\n\n  command(body: AnyValue): void {\n    this._context.command(this._hostUri, this._nodeUri, this._laneUri, body);\n  }\n}\n","// Copyright 2015-2020 SWIM.AI inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Value, AnyValue} from \"@swim/structure\";\nimport {AnyUri, Uri} from \"@swim/uri\";\nimport {EventDownlinkInit, EventDownlink} from \"../downlink/EventDownlink\";\nimport {ListDownlinkInit, ListDownlink} from \"../downlink/ListDownlink\";\nimport {MapDownlinkInit, MapDownlink} from \"../downlink/MapDownlink\";\nimport {ValueDownlinkInit, ValueDownlink} from \"../downlink/ValueDownlink\";\nimport {RefContext} from \"./RefContext\";\nimport {BaseRef} from \"./BaseRef\";\nimport {HostRef} from \"./HostRef\";\nimport {LaneRef} from \"./LaneRef\";\n\nexport class NodeRef extends BaseRef {\n  /** @hidden */\n  readonly _hostUri: Uri;\n  /** @hidden */\n  readonly _nodeUri: Uri;\n\n  constructor(context: RefContext, hostUri: Uri, nodeUri: Uri) {\n    super(context);\n    this._hostUri = hostUri;\n    this._nodeUri = nodeUri;\n  }\n\n  hostUri(): Uri {\n    return this._hostUri;\n  }\n\n  nodeUri(): Uri {\n    return this._nodeUri;\n  }\n\n  hostRef(hostUri: AnyUri): HostRef {\n    hostUri = Uri.fromAny(hostUri);\n    return new HostRef(this._context, hostUri);\n  }\n\n  nodeRef(nodeUri: AnyUri): NodeRef {\n    nodeUri = Uri.fromAny(nodeUri);\n    return new NodeRef(this._context, this._hostUri, nodeUri);\n  }\n\n  laneRef(laneUri: AnyUri): LaneRef {\n    laneUri = Uri.fromAny(laneUri);\n    return new LaneRef(this._context, this._hostUri, this._nodeUri, laneUri);\n  }\n\n  downlink(init?: EventDownlinkInit): EventDownlink {\n    return new EventDownlink(this._context, this, init, this._hostUri, this._nodeUri);\n  }\n\n  downlinkList(init?: ListDownlinkInit<Value, AnyValue>): ListDownlink<Value, AnyValue>;\n  downlinkList<V extends VU, VU = V>(init?: ListDownlinkInit<V, VU>): ListDownlink<V, VU>;\n  downlinkList<V extends VU, VU = V>(init?: ListDownlinkInit<V, VU>): ListDownlink<V, VU> {\n    return new ListDownlink(this._context, this, init, this._hostUri, this._nodeUri);\n  }\n\n  downlinkMap(init?: MapDownlinkInit<Value, Value, AnyValue, AnyValue>): MapDownlink<Value, Value, AnyValue, AnyValue>;\n  downlinkMap<K extends KU, V extends VU, KU = K, VU = V>(init?: MapDownlinkInit<K, V, KU, VU>): MapDownlink<K, V, KU, VU>;\n  downlinkMap<K extends KU, V extends VU, KU = K, VU = V>(init?: MapDownlinkInit<K, V, KU, VU>): MapDownlink<K, V, KU, VU> {\n    return new MapDownlink(this._context, this, init, this._hostUri, this._nodeUri);\n  }\n\n  downlinkValue(init?: ValueDownlinkInit<Value, AnyValue>): ValueDownlink<Value, AnyValue>;\n  downlinkValue<V extends VU, VU = V>(init?: ValueDownlinkInit<V, VU>): ValueDownlink<V, VU>;\n  downlinkValue<V extends VU, VU = V>(init?: ValueDownlinkInit<V, VU>): ValueDownlink<V, VU> {\n    return new ValueDownlink(this._context, this, init, this._hostUri, this._nodeUri);\n  }\n\n  command(laneUri: AnyUri, body: AnyValue): void {\n    this._context.command(this._hostUri, this._nodeUri, laneUri, body);\n  }\n}\n","// Copyright 2015-2020 SWIM.AI inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {Value, AnyValue} from \"@swim/structure\";\nimport {AnyUri, Uri} from \"@swim/uri\";\nimport {EventDownlinkInit, EventDownlink} from \"../downlink/EventDownlink\";\nimport {ListDownlinkInit, ListDownlink} from \"../downlink/ListDownlink\";\nimport {MapDownlinkInit, MapDownlink} from \"../downlink/MapDownlink\";\nimport {ValueDownlinkInit, ValueDownlink} from \"../downlink/ValueDownlink\";\nimport {RefContext} from \"./RefContext\";\nimport {BaseRef} from \"./BaseRef\";\nimport {NodeRef} from \"./NodeRef\";\nimport {LaneRef} from \"./LaneRef\";\n\nexport class HostRef extends BaseRef {\n  /** @hidden */\n  readonly _hostUri: Uri;\n\n  constructor(context: RefContext, hostUri: Uri) {\n    super(context);\n    this._hostUri = hostUri;\n  }\n\n  hostUri(): Uri {\n    return this._hostUri;\n  }\n\n  hostRef(hostUri: AnyUri): HostRef {\n    hostUri = Uri.fromAny(hostUri);\n    return new HostRef(this._context, hostUri);\n  }\n\n  nodeRef(nodeUri: AnyUri): NodeRef {\n    nodeUri = Uri.fromAny(nodeUri);\n    return new NodeRef(this._context, this._hostUri, nodeUri);\n  }\n\n  laneRef(nodeUri: AnyUri, laneUri: AnyUri): LaneRef {\n    nodeUri = Uri.fromAny(nodeUri);\n    laneUri = Uri.fromAny(laneUri);\n    return new LaneRef(this._context, this._hostUri, nodeUri, laneUri);\n  }\n\n  downlink(init?: EventDownlinkInit): EventDownlink {\n    return new EventDownlink(this._context, this, init, this._hostUri);\n  }\n\n  downlinkList(init?: ListDownlinkInit<Value, AnyValue>): ListDownlink<Value, AnyValue>;\n  downlinkList<V extends VU, VU = V>(init?: ListDownlinkInit<V, VU>): ListDownlink<V, VU>;\n  downlinkList<V extends VU, VU = V>(init?: ListDownlinkInit<V, VU>): ListDownlink<V, VU> {\n    return new ListDownlink(this._context, this, init, this._hostUri);\n  }\n\n  downlinkMap(init?: MapDownlinkInit<Value, Value, AnyValue, AnyValue>): MapDownlink<Value, Value, AnyValue, AnyValue>;\n  downlinkMap<K extends KU, V extends VU, KU = K, VU = V>(init?: MapDownlinkInit<K, V, KU, VU>): MapDownlink<K, V, KU, VU>;\n  downlinkMap<K extends KU, V extends VU, KU = K, VU = V>(init?: MapDownlinkInit<K, V, KU, VU>): MapDownlink<K, V, KU, VU> {\n    return new MapDownlink(this._context, this, init, this._hostUri);\n  }\n\n  downlinkValue(init?: ValueDownlinkInit<Value, AnyValue>): ValueDownlink<Value, AnyValue>;\n  downlinkValue<V extends VU, VU = V>(init?: ValueDownlinkInit<V, VU>): ValueDownlink<V, VU>;\n  downlinkValue<V extends VU, VU = V>(init?: ValueDownlinkInit<V, VU>): ValueDownlink<V, VU> {\n    return new ValueDownlink(this._context, this, init, this._hostUri);\n  }\n\n  command(nodeUri: AnyUri, laneUri: AnyUri, body: AnyValue): void {\n    this._context.command(this._hostUri, nodeUri, laneUri, body);\n  }\n}\n","// Copyright 2015-2020 SWIM.AI inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nimport {BTree} from \"@swim/collections\";\nimport {AnyValue, Value} from \"@swim/structure\";\nimport {AnyUri, Uri} from \"@swim/uri\";\nimport {HostContext} from \"./host/HostContext\";\nimport {HostOptions, Host} from \"./host/Host\";\nimport {WebSocketHost} from \"./host/WebSocketHost\";\nimport {DownlinkModel} from \"./downlink/DownlinkModel\";\nimport {EventDownlinkInit, EventDownlink} from \"./downlink/EventDownlink\";\nimport {ListDownlinkInit, ListDownlink} from \"./downlink/ListDownlink\";\nimport {MapDownlinkInit, MapDownlink} from \"./downlink/MapDownlink\";\nimport {ValueDownlinkInit, ValueDownlink} from \"./downlink/ValueDownlink\";\nimport {WarpRef} from \"./WarpRef\";\nimport {\n  WarpDidConnect,\n  WarpDidAuthenticate,\n  WarpDidDeauthenticate,\n  WarpDidDisconnect,\n  WarpDidFail,\n  WarpObserver,\n} from \"./WarpObserver\";\nimport {RefContext} from \"./ref/RefContext\";\nimport {BaseRef} from \"./ref/BaseRef\";\nimport {HostRef} from \"./ref/HostRef\";\nimport {NodeRef} from \"./ref/NodeRef\";\nimport {LaneRef} from \"./ref/LaneRef\";\n\nexport interface WarpClientOptions extends HostOptions {\n  keepOnline?: boolean;\n}\n\nexport class WarpClient implements HostContext, RefContext, WarpRef {\n  /** @hidden */\n  readonly _options: WarpClientOptions;\n  /** @hidden */\n  _hosts: BTree<Uri, Host>;\n  /** @hidden */\n  _downlinks: BTree<Uri, BTree<Uri, BTree<Uri, DownlinkModel>>>;\n  /** @hidden */\n  _downlinkCount: number;\n  /** @hidden */\n  _refs: BaseRef[];\n  /** @hidden */\n  _online: boolean;\n  /** @hidden */\n  _observers: ReadonlyArray<WarpObserver> | null;\n\n  constructor(options: WarpClientOptions = {}) {\n    if (options.keepOnline === void 0) {\n      options.keepOnline = true;\n    }\n    this._options = options;\n    this._hosts = new BTree();\n    this._downlinks = new BTree();\n    this._downlinkCount = 0;\n    this._refs = [];\n    this._online = true;\n    this._observers = null;\n\n    this.onOnline = this.onOnline.bind(this);\n    this.onOffline = this.onOffline.bind(this);\n    this.watchOnline(!!options.keepOnline);\n  }\n\n  isOnline(): boolean;\n  isOnline(online: boolean): this;\n  isOnline(online?: boolean): boolean | this {\n    if (online === void 0) {\n      return this._online;\n    } else {\n      if (this._online !== online) {\n        this._online = online;\n        if (online) {\n          this._hosts.forEach(function (hostUri, host) {\n            host.open();\n          }, this);\n        }\n      }\n      return this;\n    }\n  }\n\n  keepOnline(): boolean;\n  keepOnline(keepOnline: boolean): this;\n  keepOnline(keepOnline?: boolean): boolean | this {\n    if (keepOnline === void 0) {\n      return !!this._options.keepOnline;\n    } else {\n      if (this._options.keepOnline !== keepOnline) {\n        this._options.keepOnline = keepOnline;\n        this.watchOnline(keepOnline);\n      }\n      return this;\n    }\n  }\n\n  protected watchOnline(keepOnline: boolean): void {\n    if (typeof window === \"object\") {\n      if (keepOnline) {\n        window.addEventListener(\"online\", this.onOnline);\n        window.addEventListener(\"offline\", this.onOffline);\n      } else {\n        window.removeEventListener(\"online\", this.onOnline);\n        window.removeEventListener(\"offline\", this.onOffline);\n      }\n    }\n  }\n\n  protected onOnline(event: Event): void {\n    this.isOnline(true);\n  }\n\n  protected onOffline(event: Event): void {\n    this.isOnline(false);\n  }\n\n  /** @hidden */\n  getHost(hostUri: AnyUri): Host | undefined {\n    hostUri = Uri.fromAny(hostUri);\n    return this._hosts.get(hostUri);\n  }\n\n  /** @hidden */\n  openHost(hostUri: AnyUri): Host {\n    hostUri = Uri.fromAny(hostUri);\n    let host = this._hosts.get(hostUri);\n    if (!host) {\n      host = new WebSocketHost(this, hostUri, this._options);\n      this._hosts.set(hostUri, host);\n    }\n    return host;\n  }\n\n  /** @hidden */\n  closeHost(host: Host): void {\n    if (this._hosts.get(host.hostUri())) {\n      this._hosts.delete(host.hostUri());\n      host.closeUp();\n    }\n  }\n\n  /** @hidden */\n  getDownlink(hostUri: Uri, nodeUri: Uri, laneUri: Uri): DownlinkModel | undefined {\n    const hostDownlinks = this._downlinks.get(hostUri);\n    if (hostDownlinks) {\n      const nodeDownlinks = hostDownlinks.get(nodeUri);\n      if (nodeDownlinks) {\n        return nodeDownlinks.get(laneUri);\n      }\n    }\n    return void 0;\n  }\n\n  /** @hidden */\n  openDownlink(downlink: DownlinkModel): void {\n    const hostUri = downlink.hostUri();\n    const nodeUri = downlink.nodeUri();\n    const laneUri = downlink.laneUri();\n    let hostDownlinks = this._downlinks.get(hostUri);\n    if (!hostDownlinks) {\n      hostDownlinks = new BTree();\n      this._downlinks.set(hostUri, hostDownlinks);\n    }\n    let nodeDownlinks = hostDownlinks.get(nodeUri);\n    if (!nodeDownlinks) {\n      nodeDownlinks = new BTree();\n      hostDownlinks.set(nodeUri, nodeDownlinks);\n    }\n    if (nodeDownlinks.has(laneUri)) {\n      throw new Error(\"duplicate downlink\");\n    }\n    nodeDownlinks.set(laneUri, downlink);\n    this._downlinkCount += 1;\n    const host = this.openHost(hostUri);\n    host.openDownlink(downlink);\n  }\n\n  /** @hidden */\n  unlinkDownlink(downlink: DownlinkModel): void {\n    const hostUri = downlink.hostUri();\n    const host = this.getHost(hostUri);\n    if (host) {\n      host.unlinkDownlink(downlink);\n    }\n  }\n\n  /** @hidden */\n  closeDownlink(downlink: DownlinkModel): void {\n    const hostUri = downlink.hostUri();\n    const nodeUri = downlink.nodeUri();\n    const laneUri = downlink.laneUri();\n    const hostDownlinks = this._downlinks.get(hostUri);\n    if (hostDownlinks) {\n      const nodeDownlinks = hostDownlinks.get(nodeUri);\n      if (nodeDownlinks) {\n        if (nodeDownlinks.get(laneUri)) {\n          this._downlinkCount -= 1;\n          nodeDownlinks.delete(laneUri);\n          if (nodeDownlinks.isEmpty()) {\n            hostDownlinks.delete(nodeUri);\n            if (hostDownlinks.isEmpty()) {\n              this._downlinks.delete(hostUri);\n            }\n          }\n          const host = this.getHost(hostUri);\n          if (host) {\n            host.closeDownlink(downlink);\n          }\n        }\n      }\n    }\n  }\n\n  downlink(init?: EventDownlinkInit): EventDownlink {\n    return new EventDownlink(this, void 0, init);\n  }\n\n  downlinkList(init?: ListDownlinkInit<Value, AnyValue>): ListDownlink<Value, AnyValue>;\n  downlinkList<V extends VU, VU = V>(init?: ListDownlinkInit<V, VU>): ListDownlink<V, VU>;\n  downlinkList<V extends VU, VU = V>(init?: ListDownlinkInit<V, VU>): ListDownlink<V, VU> {\n    return new ListDownlink(this, void 0, init);\n  }\n\n  downlinkMap(init?: MapDownlinkInit<Value, Value, AnyValue, AnyValue>): MapDownlink<Value, Value, AnyValue, AnyValue>;\n  downlinkMap<K extends KU, V extends VU, KU = K, VU = V>(init?: MapDownlinkInit<K, V, KU, VU>): MapDownlink<K, V, KU, VU>;\n  downlinkMap<K extends KU, V extends VU, KU = K, VU = V>(init?: MapDownlinkInit<K, V, KU, VU>): MapDownlink<K, V, KU, VU> {\n    return new MapDownlink(this, void 0, init);\n  }\n\n  downlinkValue(init?: ValueDownlinkInit<Value, AnyValue>): ValueDownlink<Value, AnyValue>;\n  downlinkValue<V extends VU, VU = V>(init?: ValueDownlinkInit<V, VU>): ValueDownlink<V, VU>;\n  downlinkValue<V extends VU, VU = V>(init?: ValueDownlinkInit<V, VU>): ValueDownlink<V, VU> {\n    return new ValueDownlink(this, void 0, init);\n  }\n\n  /** @hidden */\n  openRef(ref: BaseRef): void {\n    this._refs.push(ref);\n  }\n\n  /** @hidden */\n  closeRef(ref: BaseRef): void {\n    const index = this._refs.indexOf(ref);\n    if (index >= 0) {\n      this._refs.splice(index, 1);\n      ref.closeUp();\n    }\n  }\n\n  hostRef(hostUri: AnyUri): HostRef {\n    hostUri = Uri.fromAny(hostUri);\n    return new HostRef(this, hostUri);\n  }\n\n  nodeRef(hostUri: AnyUri, nodeUri: AnyUri): NodeRef;\n  nodeRef(nodeUri: AnyUri): NodeRef;\n  nodeRef(hostUri: AnyUri, nodeUri?: AnyUri): NodeRef {\n    hostUri = Uri.fromAny(hostUri);\n    if (nodeUri === void 0) {\n      nodeUri = hostUri;\n      hostUri = nodeUri.endpoint();\n      nodeUri = hostUri.unresolve(nodeUri);\n    } else {\n      nodeUri = Uri.fromAny(nodeUri);\n    }\n    return new NodeRef(this, hostUri, nodeUri);\n  }\n\n  laneRef(hostUri: AnyUri, nodeUri: AnyUri, laneUri: AnyUri): LaneRef;\n  laneRef(nodeUri: AnyUri, laneUri: AnyUri): LaneRef;\n  laneRef(hostUri: AnyUri, nodeUri: AnyUri, laneUri?: AnyUri): LaneRef {\n    hostUri = Uri.fromAny(hostUri);\n    nodeUri = Uri.fromAny(nodeUri);\n    if (laneUri === void 0) {\n      laneUri = nodeUri;\n      nodeUri = hostUri;\n      hostUri = nodeUri.endpoint();\n      nodeUri = hostUri.unresolve(nodeUri);\n    } else {\n      laneUri = Uri.fromAny(laneUri);\n    }\n    return new LaneRef(this, hostUri, nodeUri, laneUri);\n  }\n\n  authenticate(hostUri: AnyUri, credentials: AnyValue): void {\n    hostUri = Uri.fromAny(hostUri);\n    credentials = Value.fromAny(credentials);\n    const host = this.openHost(hostUri);\n    host.authenticate(credentials);\n  }\n\n  command(hostUri: AnyUri, nodeUri: AnyUri, laneUri: AnyUri, body: AnyValue): void;\n  command(nodeUri: AnyUri, laneUri: AnyUri, body: AnyValue): void;\n  command(hostUri: AnyUri, nodeUri: AnyUri, laneUri: AnyUri | AnyValue, body?: AnyValue): void {\n    hostUri = Uri.fromAny(hostUri);\n    nodeUri = Uri.fromAny(nodeUri);\n    if (arguments.length === 3) {\n      body = laneUri as Value;\n      laneUri = nodeUri;\n      nodeUri = hostUri;\n      hostUri = nodeUri.endpoint();\n      nodeUri = hostUri.unresolve(nodeUri);\n    } else {\n      laneUri = Uri.fromAny(laneUri as AnyUri);\n    }\n    body = Value.fromAny(body);\n    const host = this.openHost(hostUri);\n    host.command(nodeUri, laneUri, body);\n  }\n\n  close(): void {\n    const refs = this._refs;\n    this._refs = [];\n    for (let i = 0; i < refs.length; i += 1) {\n      refs[i].closeUp();\n    }\n    const downlinks = this._downlinks.clone();\n    this._downlinks.clear();\n    this._downlinkCount = 0;\n    downlinks.forEach(function (hostUri: Uri, hostDownlinks: BTree<Uri, BTree<Uri, DownlinkModel>>): void {\n      hostDownlinks.forEach(function (nodeUri: Uri, nodeDownlinks: BTree<Uri, DownlinkModel>): void {\n        nodeDownlinks.forEach(function (laneUri: Uri, downlink: DownlinkModel): void {\n          downlink.closeUp();\n          const host = this.getHost(hostUri);\n          if (host) {\n            host.closeDownlink(downlink);\n          }\n        }, this);\n      }, this);\n    }, this);\n    const hosts = this._hosts.clone();\n    this._hosts.clear();\n    hosts.forEach(function (hostUri: Uri, host: Host): void {\n      host.closeUp();\n    }, this);\n  }\n\n  observe(observer: WarpObserver): this {\n    const oldObservers = this._observers;\n    const n = oldObservers ? oldObservers.length : 0;\n    const newObservers = new Array<WarpObserver>(n + 1);\n    for (let i = 0; i < n; i += 1) {\n      newObservers[i] = oldObservers![i];\n    }\n    newObservers[n] = observer;\n    this._observers = newObservers;\n    return this;\n  }\n\n  unobserve(observer: unknown): this {\n    const oldObservers = this._observers;\n    const n = oldObservers ? oldObservers.length : 0;\n    for (let i = 0; i < n; i += 1) {\n      const oldObserver = oldObservers![i] as {[key: string]: unknown};\n      let found = oldObserver === observer; // check object identity\n      if (!found) {\n        for (const key in oldObserver) { // check property identity\n          if (oldObserver[key] === observer) {\n            found = true;\n            break;\n          }\n        }\n      }\n      if (found) {\n        if (n > 1) {\n          const newObservers = new Array<WarpObserver>(n - 1);\n          for (let j = 0; j < i; j += 1) {\n            newObservers[j] = oldObservers![j];\n          }\n          for (let j = i + 1; j < n; j += 1) {\n            newObservers[j - 1] = oldObservers![j];\n          }\n          this._observers = newObservers;\n        } else {\n          this._observers = null;\n        }\n        break;\n      }\n    }\n    return this;\n  }\n\n  didConnect(didConnect: WarpDidConnect): this {\n    return this.observe({didConnect});\n  }\n\n  didAuthenticate(didAuthenticate: WarpDidAuthenticate): this {\n    return this.observe({didAuthenticate});\n  }\n\n  didDeauthenticate(didDeauthenticate: WarpDidDeauthenticate): this {\n    return this.observe({didDeauthenticate});\n  }\n\n  didDisconnect(didDisconnect: WarpDidDisconnect): this {\n    return this.observe({didDisconnect});\n  }\n\n  didFail(didFail: WarpDidFail): this {\n    return this.observe({didFail});\n  }\n\n  /** @hidden */\n  hostDidConnect(host: Host): void {\n    const observers = this._observers;\n    const n = observers ? observers.length : 0;\n    for (let i = 0; i < n; i += 1) {\n      const observer = observers![i];\n      if (observer.didConnect) {\n        observer.didConnect(host, this);\n      }\n    }\n    for (let i = 0; i < this._refs.length; i += 1) {\n      const ref = this._refs[i];\n      if (ref.hostUri().equals(host.hostUri())) {\n        ref.hostDidConnect(host);\n      }\n    }\n  }\n\n  /** @hidden */\n  hostDidAuthenticate(body: Value, host: Host): void {\n    const observers = this._observers;\n    const n = observers ? observers.length : 0;\n    for (let i = 0; i < n; i += 1) {\n      const observer = observers![i];\n      if (observer.didAuthenticate) {\n        observer.didAuthenticate(body, host, this);\n      }\n    }\n    for (let i = 0; i < this._refs.length; i += 1) {\n      const ref = this._refs[i];\n      if (ref.hostUri().equals(host.hostUri())) {\n        ref.hostDidAuthenticate(body, host);\n      }\n    }\n  }\n\n  /** @hidden */\n  hostDidDeauthenticate(body: Value, host: Host): void {\n    const observers = this._observers;\n    const n = observers ? observers.length : 0;\n    for (let i = 0; i < n; i += 1) {\n      const observer = observers![i];\n      if (observer.didDeauthenticate) {\n        observer.didDeauthenticate(body, host, this);\n      }\n    }\n    for (let i = 0; i < this._refs.length; i += 1) {\n      const ref = this._refs[i];\n      if (ref.hostUri().equals(host.hostUri())) {\n        ref.hostDidDeauthenticate(body, host);\n      }\n    }\n  }\n\n  /** @hidden */\n  hostDidDisconnect(host: Host): void {\n    const observers = this._observers;\n    const n = observers ? observers.length : 0;\n    for (let i = 0; i < n; i += 1) {\n      const observer = observers![i];\n      if (observer.didDisconnect) {\n        observer.didDisconnect(host, this);\n      }\n    }\n    for (let i = 0; i < this._refs.length; i += 1) {\n      const ref = this._refs[i];\n      if (ref.hostUri().equals(host.hostUri())) {\n        ref.hostDidDisconnect(host);\n      }\n    }\n  }\n\n  /** @hidden */\n  hostDidFail(error: unknown, host: Host): void {\n    const observers = this._observers;\n    const n = observers ? observers.length : 0;\n    for (let i = 0; i < n; i += 1) {\n      const observer = observers![i];\n      if (observer.didFail) {\n        observer.didFail(error, host, this);\n      }\n    }\n    for (let i = 0; i < this._refs.length; i += 1) {\n      const ref = this._refs[i];\n      if (ref.hostUri().equals(host.hostUri())) {\n        ref.hostDidFail(error, host);\n      }\n    }\n  }\n}\n\n/**\n * @deprecated\n */\nexport type SwimClientOptions = WarpClientOptions;\n\n/**\n * @deprecated\n */\nexport type SwimClient = WarpClient;\n","// Copyright 2015-2020 SWIM.AI inc.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nexport * from \"./host\";\n\nexport * from \"./downlink\";\n\nexport * from \"./ref\";\n\nexport {WarpRef, SwimRef} from \"./WarpRef\";\nexport {WarpObserver, SwimObserver} from \"./WarpObserver\";\n\nexport {\n  WarpClientOptions, SwimClientOptions,\n  WarpClient, SwimClient,\n} from \"./WarpClient\";\n\nimport {WarpClient} from \"./WarpClient\";\nexport const client = new WarpClient();\nexport const isOnline = client.isOnline.bind(client);\nexport const keepOnline = client.keepOnline.bind(client);\nexport const downlink = client.downlink.bind(client);\nexport const downlinkList = client.downlinkList.bind(client);\nexport const downlinkMap = client.downlinkMap.bind(client);\nexport const downlinkValue = client.downlinkValue.bind(client);\nexport const hostRef = client.hostRef.bind(client);\nexport const nodeRef = client.nodeRef.bind(client);\nexport const laneRef = client.laneRef.bind(client);\nexport const authenticate = client.authenticate.bind(client);\nexport const command = client.command.bind(client);\n"],"names":["BTree","Value","UriCache","AuthRequest","UnlinkRequest","Uri","CommandMessage","EventMessage","LinkRequest","LinkedResponse","SyncRequest","SyncedResponse","UnlinkedResponse","AuthedResponse","DeauthRequest","DeauthedResponse","Envelope","DownlinkFlags","Record","Attr","Item","Form","STree","ValueCursor","ValueEntryCursor","MapOutlet","KeyOutlet","Cursor","MapInlet","FilterFieldsCombinator","MapValueCombinator","MapFieldValuesCombinator","ReduceFieldsCombinator","WatchValueCombinator","WatchFieldsCombinator","AbstractRecordOutlet","Num","Slot","Transmuter","Inout","Out","AbstractRecordStreamlet"],"mappings":"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"}