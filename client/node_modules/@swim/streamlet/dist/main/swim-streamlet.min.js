// swim-streamlet-3.10.2; copyright 2015-2020 SWIM.AI inc.
!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("@swim/util"),require("@swim/collections")):"function"==typeof define&&define.amd?define(["exports","@swim/util","@swim/collections"],n):n((t=t||self).swim=t.swim||{},t.swim,t.swim)}(this,(function(t,n,i){"use strict";var e,o={is:function(t){if("object"==typeof t&&t){var n=t;return"function"==typeof n.input&&"function"==typeof n.bindInput&&"function"==typeof n.unbindInput}return!1}},u={is:function(t){if("object"==typeof t&&t){var n=t;return"function"==typeof n.outputIterator&&"function"==typeof n.bindOutput&&"function"==typeof n.unbindOutput}return!1},MemoizeValueCombinator:void 0,MapValueCombinator:void 0,WatchValueCombinator:void 0};(e=t.KeyEffect||(t.KeyEffect={}))[e.Update=0]="Update",e[e.Remove=1]="Remove";var r={is:function(t){if("object"==typeof t&&t){var n=t;return o.is(n)&&"function"==typeof n.invalidateOutputKey&&"function"==typeof n.reconcileOutputKey}return!1}},p={is:function(t){if("object"==typeof t&&t){var n=t;return u.is(n)&&"function"==typeof n.keyIterator&&"function"==typeof n.outlet}return!1},MemoizeMapCombinator:void 0,FilterFieldsCombinator:void 0,MapFieldValuesCombinator:void 0,ReduceFieldsCombinator:void 0,WatchFieldsCombinator:void 0},l=function(t,n){return(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)n.hasOwnProperty(i)&&(t[i]=n[i])})(t,n)};function s(t,n){function i(){this.constructor=t}l(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}var c=function(t){function n(i){var e=t.call(this,i)||this;return e.__proto__=n.prototype,e}return s(n,t),n}(Error),a=function(){function t(){this._input=null,this._version=-1}return t.prototype.input=function(){return this._input},t.prototype.bindInput=function(t){null!==this._input&&this._input.unbindOutput(this),this._input=t,null!==this._input&&this._input.bindOutput(this)},t.prototype.unbindInput=function(){null!==this._input&&this._input.unbindOutput(this),this._input=null},t.prototype.disconnectInputs=function(){var t=this._input;null!==t&&(t.unbindOutput(this),this._input=null,t.disconnectInputs())},t.prototype.disconnectOutputs=function(){},t.prototype.invalidateOutput=function(){this._version>=0&&(this.willInvalidateOutput(),this._version=-1,this.onInvalidateOutput(),this.didInvalidateOutput())},t.prototype.reconcileOutput=function(t){this._version<0&&(this.willReconcileOutput(t),this._version=t,null!==this._input&&this._input.reconcileInput(t),this.onReconcileOutput(t),this.didReconcileOutput(t))},t.prototype.willInvalidateOutput=function(){},t.prototype.onInvalidateOutput=function(){},t.prototype.didInvalidateOutput=function(){},t.prototype.willReconcileOutput=function(t){},t.prototype.onReconcileOutput=function(t){},t.prototype.didReconcileOutput=function(t){},t}(),h=function(){function t(){this._outputs=null,this._version=-1}return t.prototype.outputIterator=function(){return null!==this._outputs?n.Cursor.array(this._outputs):n.Cursor.empty()},t.prototype.bindOutput=function(t){for(var n=this._outputs,i=null!==n?n.length:0,e=new Array(i+1),o=0;o<i;o+=1)e[o]=n[o];e[i]=t,this._outputs=e},t.prototype.unbindOutput=function(t){for(var n=this._outputs,i=0,e=null!==n?n.length:0;i<e;i+=1)if(n[i]===t){if(e>1){for(var o=new Array(e-1),u=0;u<i;u+=1)o[u]=n[u];for(u=i;u<e-1;u+=1)o[u]=n[u+1];this._outputs=o}else this._outputs=null;break}},t.prototype.unbindOutputs=function(){var t=this._outputs;if(null!==t){this._outputs=null;for(var n=0,i=t.length;n<i;n+=1){t[n].unbindInput()}}},t.prototype.disconnectOutputs=function(){var t=this._outputs;if(null!==t){this._outputs=null;for(var n=0,i=t.length;n<i;n+=1){var e=t[n];e.unbindInput(),e.disconnectOutputs()}}},t.prototype.disconnectInputs=function(){},t.prototype.invalidateInput=function(){if(this._version>=0){this.willInvalidateInput(),this._version=-1,this.onInvalidateInput();for(var t=0,n=null!==this._outputs?this._outputs.length:0;t<n;t+=1)this._outputs[t].invalidateOutput();this.didInvalidateInput()}},t.prototype.reconcileInput=function(t){if(this._version<0){this.willReconcileInput(t),this._version=t,this.onReconcileInput(t);for(var n=0,i=null!==this._outputs?this._outputs.length:0;n<i;n+=1)this._outputs[n].reconcileOutput(t);this.didReconcileInput(t)}},t.prototype.willInvalidateInput=function(){},t.prototype.onInvalidateInput=function(){},t.prototype.didInvalidateInput=function(){},t.prototype.willReconcileInput=function(t){},t.prototype.onReconcileInput=function(t){},t.prototype.didReconcileInput=function(t){},t.prototype.memoize=function(){var t=new u.MemoizeValueCombinator;return t.bindInput(this),t},t.prototype.map=function(t){var n=new u.MapValueCombinator(t);return n.bindInput(this),n},t.prototype.watch=function(t){return new u.WatchValueCombinator(t).bindInput(this),this},t}(),f=function(){function t(){this._input=null,this._outputs=null,this._version=-1}return t.prototype.input=function(){return this._input},t.prototype.bindInput=function(t){null!==this._input&&this._input.unbindOutput(this),this._input=t,null!==this._input&&this._input.bindOutput(this)},t.prototype.unbindInput=function(){null!==this._input&&this._input.unbindOutput(this),this._input=null},t.prototype.disconnectInputs=function(){if(null===this._outputs){var t=this._input;null!==t&&(t.unbindOutput(this),this._input=null,t.disconnectInputs())}},t.prototype.outputIterator=function(){return null!==this._outputs?n.Cursor.array(this._outputs):n.Cursor.empty()},t.prototype.bindOutput=function(t){for(var n=this._outputs,i=null!==n?n.length:0,e=new Array(i+1),o=0;o<i;o+=1)e[o]=n[o];e[i]=t,this._outputs=e},t.prototype.unbindOutput=function(t){for(var n=this._outputs,i=null!==n?n.length:0,e=0;e<i;e+=1)if(n[e]===t){if(i>1){for(var o=new Array(i-1),u=0;u<e;u+=1)o[u]=n[u];for(u=e;u<i-1;u+=1)o[u]=n[u+1];this._outputs=o}else this._outputs=null;break}},t.prototype.unbindOutputs=function(){var t=this._outputs;if(null!==t){this._outputs=null;for(var n=0,i=t.length;n<i;n+=1){t[n].unbindInput()}}},t.prototype.disconnectOutputs=function(){if(null===this._input){var t=this._outputs;if(null!==t){this._outputs=null;for(var n=0,i=t.length;n<i;n+=1){var e=t[n];e.unbindInput(),e.disconnectOutputs()}}}},t.prototype.invalidateOutput=function(){this.invalidate()},t.prototype.invalidateInput=function(){this.invalidate()},t.prototype.invalidate=function(){if(this._version>=0){this.willInvalidate(),this._version=-1,this.onInvalidate();for(var t=null!==this._outputs?this._outputs.length:0,n=0;n<t;n+=1)this._outputs[n].invalidateOutput();this.didInvalidate()}},t.prototype.reconcileOutput=function(t){this.reconcile(t)},t.prototype.reconcileInput=function(t){this.reconcile(t)},t.prototype.reconcile=function(t){if(this._version<0){this.willReconcile(t),this._version=t,null!==this._input&&this._input.reconcileInput(t),this.onReconcile(t);for(var n=null!==this._outputs?this._outputs.length:0,i=0;i<n;i+=1)this._outputs[i].reconcileOutput(t);this.didReconcile(t)}},t.prototype.willInvalidate=function(){},t.prototype.onInvalidate=function(){},t.prototype.didInvalidate=function(){},t.prototype.willReconcile=function(t){},t.prototype.onReconcile=function(t){},t.prototype.didReconcile=function(t){},t.prototype.memoize=function(){var t=new u.MemoizeValueCombinator;return t.bindInput(this),t},t.prototype.map=function(t){var n=new u.MapValueCombinator(t);return n.bindInput(this),n},t.prototype.watch=function(t){return new u.WatchValueCombinator(t).bindInput(this),this},t}(),d=function(t){function n(n,i){var e=t.call(this)||this;return e._input=n,e._key=i,e}return s(n,t),n.prototype.input=function(){return this._input},n.prototype.key=function(){return this._key},n.prototype.get=function(){return this._input.get(this._key)},n}(h),_=function(){function t(){this._input=null,this._effects=new i.BTree,this._version=-1}return t.prototype.input=function(){return this._input},t.prototype.bindInput=function(t){if(!p.is(t))throw new TypeError(""+t);null!==this._input&&this._input.unbindOutput(this),this._input=t,null!==this._input&&this._input.bindOutput(this)},t.prototype.unbindInput=function(){null!=this._input&&this._input.unbindOutput(this),this._input=null},t.prototype.disconnectInputs=function(){var t=this._input;null!==t&&(t.unbindOutput(this),this._input=null,t.disconnectInputs())},t.prototype.disconnectOutputs=function(){},t.prototype.invalidateOutputKey=function(t,n){var i=this._effects;i.get(t)!==n&&(this.willInvalidateOutputKey(t,n),this._effects=i.updated(t,n),this._version=-1,this.onInvalidateOutputKey(t,n),this.didInvalidateOutputKey(t,n))},t.prototype.invalidateOutput=function(){this._version>=0&&(this.willInvalidateOutput(),this._version=-1,this.onInvalidateOutput(),this.didInvalidateOutput())},t.prototype.reconcileOutputKey=function(t,n){if(this._version<0){var i=this._effects,e=i.get(t);void 0!==e&&(this.willReconcileOutputKey(t,e,n),this._effects=i.removed(t),null!==this._input&&this._input.reconcileInputKey(t,n),this.onReconcileOutputKey(t,e,n),this.didReconcileOutputKey(t,e,n))}},t.prototype.reconcileOutput=function(t){this._version<0&&(this.willReconcileOutput(t),this._effects.forEach((function(n){this.reconcileOutputKey(n,t)}),this),this._version=t,this.onReconcileOutput(t),this.didReconcileOutput(t))},t.prototype.willInvalidateOutputKey=function(t,n){},t.prototype.onInvalidateOutputKey=function(t,n){},t.prototype.didInvalidateOutputKey=function(t,n){},t.prototype.willInvalidateOutput=function(){},t.prototype.onInvalidateOutput=function(){},t.prototype.didInvalidateOutput=function(){},t.prototype.willReconcileOutputKey=function(t,n,i){},t.prototype.onReconcileOutputKey=function(t,n,i){},t.prototype.didReconcileOutputKey=function(t,n,i){},t.prototype.willReconcileOutput=function(t){},t.prototype.onReconcileOutput=function(t){},t.prototype.didReconcileOutput=function(t){},t}(),y=function(){function t(){this._effects=new i.BTree,this._outlets=new i.BTree,this._outputs=null,this._version=-1}return t.prototype.outlet=function(t){var n=this._outlets.get(t);return void 0===n&&(n=new d(this,t),this._outlets=this._outlets.updated(t,n)),n},t.prototype.outputIterator=function(){return null!==this._outputs?n.Cursor.array(this._outputs):n.Cursor.empty()},t.prototype.bindOutput=function(t){for(var n=this._outputs,i=null!==n?n.length:0,e=new Array(i+1),o=0;o<i;o+=1)e[o]=n[o];e[i]=t,this._outputs=e},t.prototype.unbindOutput=function(t){for(var n=this._outputs,i=null!==n?n.length:0,e=0;e<i;e+=1)if(n[e]===t){if(i>1){for(var o=new Array(i-1),u=0;u<e;u+=1)o[u]=n[u];for(u=e;u<i-1;u+=1)o[u]=n[u+1];this._outputs=o}else this._outputs=null;break}},t.prototype.unbindOutputs=function(){var t=this._outlets;t.isEmpty()&&(this._outlets=new i.BTree,t.forEach((function(t,n){n.unbindOutputs()}),this));var n=this._outputs;if(null!==n){this._outputs=null;for(var e=0,o=n.length;e<o;e+=1){n[e].unbindInput()}}},t.prototype.disconnectOutputs=function(){var t=this._outlets;t.isEmpty()&&(this._outlets=new i.BTree,t.forEach((function(t,n){n.disconnectOutputs()}),this));var n=this._outputs;if(null!==n){this._outputs=null;for(var e=0,o=n.length;e<o;e+=1){var u=n[e];u.unbindInput(),u.disconnectOutputs()}}},t.prototype.disconnectInputs=function(){},t.prototype.invalidateInputKey=function(t,n){var i=this._effects;if(i.get(t)!==n){this.willInvalidateInputKey(t,n),this._effects=i.updated(t,n),this._version=-1,this.onInvalidateInputKey(t,n);for(var e=null!==this._outputs?this._outputs.length:0,o=0;o<e;o+=1){var u=this._outputs[o];r.is(u)?u.invalidateOutputKey(t,n):u.invalidateOutput()}var p=this._outlets.get(t);void 0!==p&&p.invalidateInput(),this.didInvalidateInputKey(t,n)}},t.prototype.invalidateInput=function(){if(this._version>=0){this.willInvalidateInput(),this._version=-1,this.onInvalidateInput();for(var t=null!==this._outputs?this._outputs.length:0,n=0;n<t;n+=1)this._outputs[n].invalidateOutput();this._outlets.forEach((function(t,n){n.invalidateInput()}),this),this.didInvalidateInput()}},t.prototype.reconcileInputKey=function(t,n){if(this._version<0){var i=this._effects,e=i.get(t);if(void 0!==e){this.willReconcileInputKey(t,e,n),this._effects=i.removed(t),this.onReconcileInputKey(t,e,n);for(var o=0,u=null!==this._outputs?this._outputs.length:0;o<u;o+=1){var p=this._outputs[o];r.is(p)&&p.reconcileOutputKey(t,n)}var l=this._outlets.get(t);void 0!==l&&l.reconcileInput(n),this.didReconcileInputKey(t,e,n)}}},t.prototype.reconcileInput=function(t){if(this._version<0){this.willReconcileInput(t),this._effects.forEach((function(n){this.reconcileInputKey(n,t)}),this),this._version=t,this.onReconcileInput(t);for(var n=0,i=null!==this._outputs?this._outputs.length:0;n<i;n+=1)this._outputs[n].reconcileOutput(t);this.didReconcileInput(t)}},t.prototype.willInvalidateInputKey=function(t,n){},t.prototype.onInvalidateInputKey=function(t,n){},t.prototype.didInvalidateInputKey=function(t,n){},t.prototype.willInvalidateInput=function(){},t.prototype.onInvalidateInput=function(){},t.prototype.didInvalidateInput=function(){},t.prototype.willReconcileInputKey=function(t,n,i){},t.prototype.onReconcileInputKey=function(t,n,i){},t.prototype.didReconcileInputKey=function(t,n,i){},t.prototype.willReconcileInput=function(t){},t.prototype.onReconcileInput=function(t){},t.prototype.didReconcileInput=function(t){},t.prototype.memoize=function(){var t=new p.MemoizeMapCombinator;return t.bindInput(this),t},t.prototype.filter=function(t){var n=new p.FilterFieldsCombinator(t);return n.bindInput(this),n},t.prototype.map=function(t){var n;return 1===t.length?((n=new u.MapValueCombinator(t)).bindInput(this),n):((n=new p.MapFieldValuesCombinator(t)).bindInput(this),n)},t.prototype.reduce=function(t,n,i){var e=new p.ReduceFieldsCombinator(t,n,i);return e.bindInput(this),e},t.prototype.watch=function(t){return 1===t.length?(new u.WatchValueCombinator(t).bindInput(this),this):(new p.WatchFieldsCombinator(t).bindInput(this),this)},t}(),v=function(){function t(){this._input=null,this._effects=new i.BTree,this._outlets=new i.BTree,this._outputs=null,this._version=-1}return t.prototype.input=function(){return this._input},t.prototype.bindInput=function(t){if(!p.is(t))throw new TypeError(""+t);null!==this._input&&this._input.unbindOutput(this),this._input=t,null!==this._input&&this._input.bindOutput(this)},t.prototype.unbindInput=function(){null!==this._input&&this._input.unbindOutput(this),this._input=null},t.prototype.disconnectInputs=function(){if(null===this._outputs&&this._outlets.isEmpty()){var t=this._input;null!==t&&(t.unbindOutput(this),this._input=null,t.disconnectInputs())}},t.prototype.outlet=function(t){var n=this._outlets.get(t);return void 0===n&&(n=new d(this,t),this._outlets=this._outlets.updated(t,n)),n},t.prototype.outputIterator=function(){return null!==this._outputs?n.Cursor.array(this._outputs):n.Cursor.empty()},t.prototype.bindOutput=function(t){for(var n=this._outputs,i=null!==n?n.length:0,e=new Array(i+1),o=0;o<i;o+=1)e[o]=n[o];e[i]=t,this._outputs=e},t.prototype.unbindOutput=function(t){for(var n=this._outputs,i=null!==n?n.length:0,e=0;e<i;e+=1)if(n[e]===t){if(i>1){for(var o=new Array(i-1),u=0;u<e;u+=1)o[u]=n[u];for(u=e;u<i-1;u+=1)o[u]=n[u+1];this._outputs=o}else this._outputs=null;break}},t.prototype.unbindOutputs=function(){var t=this._outlets;t.isEmpty()&&(this._outlets=new i.BTree,t.forEach((function(t,n){n.unbindOutputs()}),this));var n=this._outputs;if(null!==n){this._outputs=null;for(var e=0,o=n.length;e<o;e+=1){n[e].unbindInput()}}},t.prototype.disconnectOutputs=function(){if(null===this._input){var t=this._outlets;t.isEmpty()&&(this._outlets=new i.BTree,t.forEach((function(t,n){n.disconnectOutputs()}),this));var n=this._outputs;if(null!==n){this._outputs=null;for(var e=0,o=n.length;e<o;e+=1){var u=n[e];u.unbindInput(),u.disconnectOutputs()}}}},t.prototype.invalidateOutputKey=function(t,n){this.invalidateKey(t,n)},t.prototype.invalidateInputKey=function(t,n){this.invalidateKey(t,n)},t.prototype.invalidateKey=function(t,n){var i=this._effects;if(i.get(t)!==n){this.willInvalidateKey(t,n),this._effects=i.updated(t,n),this._version=-1,this.onInvalidateKey(t,n);for(var e=null!==this._outputs?this._outputs.length:0,o=0;o<e;o+=1){var u=this._outputs[o];r.is(u)?u.invalidateOutputKey(t,n):u.invalidateOutput()}var p=this._outlets.get(t);void 0!==p&&p.invalidateInput(),this.didInvalidateKey(t,n)}},t.prototype.invalidateOutput=function(){this.invalidate()},t.prototype.invalidateInput=function(){this.invalidate()},t.prototype.invalidate=function(){if(this._version>=0){this.willInvalidate(),this._version=-1,this.onInvalidate();for(var t=null!==this._outputs?this._outputs.length:0,n=0;n<t;n+=1)this._outputs[n].invalidateOutput();this._outlets.forEach((function(t,n){n.invalidateInput()}),this),this.didInvalidate()}},t.prototype.reconcileOutputKey=function(t,n){this.reconcileKey(t,n)},t.prototype.reconcileInputKey=function(t,n){this.reconcileKey(t,n)},t.prototype.reconcileKey=function(t,n){if(this._version<0){var i=this._effects,e=i.get(t);if(void 0!==e){this.willReconcileKey(t,e,n),this._effects=i.removed(t),null!==this._input&&this._input.reconcileInputKey(t,n),this.onReconcileKey(t,e,n);for(var o=0,u=null!==this._outputs?this._outputs.length:0;o<u;o+=1){var p=this._outputs[o];r.is(p)&&p.reconcileOutputKey(t,n)}var l=this._outlets.get(t);void 0!==l&&l.reconcileInput(n),this.didReconcileKey(t,e,n)}}},t.prototype.reconcileOutput=function(t){this.reconcile(t)},t.prototype.reconcileInput=function(t){this.reconcile(t)},t.prototype.reconcile=function(t){if(this._version<0){this.willReconcile(t),this._effects.forEach((function(n){this.reconcileKey(n,t)}),this),this._version=t,this.onReconcile(t);for(var n=0,i=null!==this._outputs?this._outputs.length:0;n<i;n+=1)this._outputs[n].reconcileOutput(t);this.didReconcile(t)}},t.prototype.willInvalidateKey=function(t,n){},t.prototype.onInvalidateKey=function(t,n){},t.prototype.didInvalidateKey=function(t,n){},t.prototype.willInvalidate=function(){},t.prototype.onInvalidate=function(){},t.prototype.didInvalidate=function(){},t.prototype.willReconcileKey=function(t,n,i){},t.prototype.onReconcileKey=function(t,n,i){},t.prototype.didReconcileKey=function(t,n,i){},t.prototype.willReconcile=function(t){},t.prototype.onReconcile=function(t){},t.prototype.didReconcile=function(t){},t.prototype.memoize=function(){var t=new p.MemoizeMapCombinator;return t.bindInput(this),t},t.prototype.filter=function(t){var n=new p.FilterFieldsCombinator(t);return n.bindInput(this),n},t.prototype.map=function(t){var n;return 1===t.length?((n=new u.MapValueCombinator(t)).bindInput(this),n):((n=new p.MapFieldValuesCombinator(t)).bindInput(this),n)},t.prototype.reduce=function(t,n,i){var e=new p.ReduceFieldsCombinator(t,n,i);return e.bindInput(this),e},t.prototype.watch=function(t){return 1===t.length?(new u.WatchValueCombinator(t).bindInput(this),this):(new p.WatchFieldsCombinator(t).bindInput(this),this)},t}(),I=function(){function t(){this._input=null,this._effects=new i.BTree,this._outputs=null,this._version=-1}return t.prototype.input=function(){return this._input},t.prototype.bindInput=function(t){if(!p.is(t))throw new TypeError(""+t);null!==this._input&&this._input.unbindOutput(this),this._input=t,null!==this._input&&this._input.bindOutput(this)},t.prototype.unbindInput=function(){null!==this._input&&this._input.unbindOutput(this),this._input=null},t.prototype.disconnectInputs=function(){if(null===this._outputs){var t=this._input;null!==t&&(t.unbindOutput(this),this._input=null,t.disconnectInputs())}},t.prototype.outputIterator=function(){return null!==this._outputs?n.Cursor.array(this._outputs):n.Cursor.empty()},t.prototype.bindOutput=function(t){for(var n=this._outputs,i=null!==n?n.length:0,e=new Array(i+1),o=0;o<i;o+=1)e[o]=n[o];e[i]=t,this._outputs=e},t.prototype.unbindOutput=function(t){for(var n=this._outputs,i=null!==n?n.length:0,e=0;e<i;e+=1)if(n[e]===t){if(i>1){for(var o=new Array(i-1),u=0;u<e;u+=1)o[u]=n[u];for(u=e;u<i-1;u+=1)o[u]=n[u+1];this._outputs=o}else this._outputs=null;break}},t.prototype.unbindOutputs=function(){var t=this._outputs;if(null!==t){this._outputs=null;for(var n=0,i=t.length;n<i;n+=1){t[n].unbindInput()}}},t.prototype.disconnectOutputs=function(){if(null===this._input){var t=this._outputs;if(null!==t){this._outputs=null;for(var n=0,i=t.length;n<i;n+=1){var e=t[n];e.unbindInput(),e.disconnectOutputs()}}}},t.prototype.invalidateOutputKey=function(t,n){var i=this._effects;if(i.get(t)!==n){this.willInvalidateOutputKey(t,n),this._effects=i.updated(t,n),this._version=-1,this.onInvalidateOutputKey(t,n);for(var e=null!==this._outputs?this._outputs.length:0,o=0;o<e;o+=1){this._outputs[o].invalidateOutput()}this.didInvalidateOutputKey(t,n)}},t.prototype.invalidateOutput=function(){this.invalidate()},t.prototype.invalidateInput=function(){this.invalidate()},t.prototype.invalidate=function(){if(this._version>=0){this.willInvalidate(),this._version=-1,this.onInvalidate();for(var t=null!==this._outputs?this._outputs.length:0,n=0;n<t;n+=1)this._outputs[n].invalidateOutput();this.didInvalidate()}},t.prototype.reconcileOutputKey=function(t,n){if(this._version<0){var i=this._effects,e=i.get(t);void 0!==e&&(this.willReconcileOutputKey(t,e,n),this._effects=i.removed(t),null!==this._input&&this._input.reconcileInputKey(t,n),this.onReconcileOutputKey(t,e,n),this.didReconcileOutputKey(t,e,n))}},t.prototype.reconcileOutput=function(t){this.reconcile(t)},t.prototype.reconcileInput=function(t){this.reconcile(t)},t.prototype.reconcile=function(t){if(this._version<0){this.willReconcile(t),this._effects.forEach((function(n){this.reconcileOutputKey(n,t)}),this),this._version=t,this.onReconcile(t);for(var n=0,i=null!==this._outputs?this._outputs.length:0;n<i;n+=1)this._outputs[n].reconcileOutput(t);this.didReconcile(t)}},t.prototype.willInvalidateOutputKey=function(t,n){},t.prototype.onInvalidateOutputKey=function(t,n){},t.prototype.didInvalidateOutputKey=function(t,n){},t.prototype.willInvalidate=function(){},t.prototype.onInvalidate=function(){},t.prototype.didInvalidate=function(){},t.prototype.willReconcileOutputKey=function(t,n,i){},t.prototype.onReconcileOutputKey=function(t,n,i){},t.prototype.didReconcileOutputKey=function(t,n,i){},t.prototype.willReconcile=function(t){},t.prototype.onReconcile=function(t){},t.prototype.didReconcile=function(t){},t.prototype.memoize=function(){var t=new u.MemoizeValueCombinator;return t.bindInput(this),t},t.prototype.map=function(t){var n=new u.MapValueCombinator(t);return n.bindInput(this),n},t.prototype.watch=function(t){return new u.WatchValueCombinator(t).bindInput(this),this},t}(),O=function(){function t(){this._input=null,this._outputEffects=new i.BTree,this._inputEffects=new i.BTree,this._outlets=new i.BTree,this._outputs=null,this._version=-1}return t.prototype.input=function(){return this._input},t.prototype.bindInput=function(t){if(!p.is(t))throw new TypeError(""+t);null!==this._input&&this._input.unbindOutput(this),this._input=t,null!==this._input&&this._input.bindOutput(this)},t.prototype.unbindInput=function(){null!==this._input&&this._input.unbindOutput(this),this._input=null},t.prototype.disconnectInputs=function(){if(null===this._outputs&&this._outlets.isEmpty()){var t=this._input;null!==t&&(t.unbindOutput(this),this._input=null,t.disconnectInputs())}},t.prototype.outlet=function(t){var n=this._outlets.get(t);return void 0===n&&(n=new d(this,t),this._outlets=this._outlets.updated(t,n)),n},t.prototype.outputIterator=function(){return null!==this._outputs?n.Cursor.array(this._outputs):n.Cursor.empty()},t.prototype.bindOutput=function(t){for(var n=this._outputs,i=null!==n?n.length:0,e=new Array(i+1),o=0;o<i;o+=1)e[o]=n[o];e[i]=t,this._outputs=e},t.prototype.unbindOutput=function(t){for(var n=this._outputs,i=null!==n?n.length:0,e=0;e<i;e+=1)if(n[e]===t){if(i>1){for(var o=new Array(i-1),u=0;u<e;u+=1)o[u]=n[u];for(u=e;u<i-1;u+=1)o[u]=n[u+1];this._outputs=o}else this._outputs=null;break}},t.prototype.unbindOutputs=function(){var t=this._outlets;t.isEmpty()&&(this._outlets=new i.BTree,t.forEach((function(t,n){n.unbindOutputs()}),this));var n=this._outputs;if(null!==n){this._outputs=null;for(var e=0,o=n.length;e<o;e+=1){n[e].unbindInput()}}},t.prototype.disconnectOutputs=function(){if(null===this._input){var t=this._outlets;t.isEmpty()&&(this._outlets=new i.BTree,t.forEach((function(t,n){n.disconnectOutputs()}),this));var n=this._outputs;if(null!==n){this._outputs=null;for(var e=0,o=n.length;e<o;e+=1){var u=n[e];u.unbindInput(),u.disconnectOutputs()}}}},t.prototype.invalidateOutputKey=function(t,n){var i=this._outputEffects;i.get(t)!==n&&(this.willInvalidateOutputKey(t,n),this._outputEffects=i.updated(t,n),this._version=-1,this.onInvalidateOutputKey(t,n),this.didInvalidateOutputKey(t,n))},t.prototype.invalidateInputKey=function(t,n){var i=this._inputEffects;if(i.get(t)!==n){this.willInvalidateInputKey(t,n),this._inputEffects=i.updated(t,n),this._version=-1,this.onInvalidateInputKey(t,n);for(var e=null!==this._outputs?this._outputs.length:0,o=0;o<e;o+=1){var u=this._outputs[o];r.is(u)?u.invalidateOutputKey(t,n):u.invalidateOutput()}var p=this._outlets.get(t);void 0!==p&&p.invalidateInput(),this.didInvalidateInputKey(t,n)}},t.prototype.invalidateOutput=function(){this.invalidate()},t.prototype.invalidateInput=function(){this.invalidate()},t.prototype.invalidate=function(){if(this._version>=0){this.willInvalidate(),this._version=-1,this.onInvalidate();for(var t=null!==this._outputs?this._outputs.length:0,n=0;n<t;n+=1)this._outputs[n].invalidateOutput();this._outlets.forEach((function(t,n){n.invalidateInput()}),this),this.didInvalidate()}},t.prototype.reconcileOutputKey=function(t,n){if(this._version<0){var i=this._outputEffects,e=i.get(t);void 0!==e&&(this.willReconcileOutputKey(t,e,n),this._outputEffects=i.removed(t),null!==this._input&&this._input.reconcileInputKey(t,n),this.onReconcileOutputKey(t,e,n),this.didReconcileOutputKey(t,e,n))}},t.prototype.reconcileInputKey=function(t,n){if(this._version<0){var i=this._inputEffects,e=i.get(t);if(void 0!==e){var o=this.willReconcileInputKey(t,e,n);e!==o&&this.invalidateInputKey(t,o),this._inputEffects=i.removed(t),this.onReconcileInputKey(t,o,n);for(var u=0,p=null!==this._outputs?this._outputs.length:0;u<p;u+=1){var l=this._outputs[u];r.is(l)&&l.reconcileOutputKey(t,n)}var s=this._outlets.get(t);void 0!==s&&s.reconcileInput(n),this.didReconcileInputKey(t,o,n)}}},t.prototype.reconcileOutput=function(t){this.reconcile(t)},t.prototype.reconcileInput=function(t){this.reconcile(t)},t.prototype.reconcile=function(t){if(this._version<0){this.willReconcile(t),this._outputEffects.forEach((function(n){this.reconcileOutputKey(n,t)}),this),this._inputEffects.forEach((function(n){this.reconcileInputKey(n,t)}),this),this._version=t,this.onReconcile(t);for(var n=0,i=null!==this._outputs?this._outputs.length:0;n<i;n+=1)this._outputs[n].reconcileOutput(t);this.didReconcile(t)}},t.prototype.willInvalidateOutputKey=function(t,n){},t.prototype.onInvalidateOutputKey=function(t,n){},t.prototype.didInvalidateOutputKey=function(t,n){},t.prototype.willInvalidateInputKey=function(t,n){},t.prototype.onInvalidateInputKey=function(t,n){},t.prototype.didInvalidateInputKey=function(t,n){},t.prototype.willInvalidate=function(){},t.prototype.onInvalidate=function(){},t.prototype.didInvalidate=function(){},t.prototype.willReconcileOutputKey=function(t,n,i){},t.prototype.onReconcileOutputKey=function(t,n,i){},t.prototype.didReconcileOutputKey=function(t,n,i){},t.prototype.willReconcileInputKey=function(t,n,i){return n},t.prototype.onReconcileInputKey=function(t,n,i){},t.prototype.didReconcileInputKey=function(t,n,i){},t.prototype.willReconcile=function(t){},t.prototype.onReconcile=function(t){},t.prototype.didReconcile=function(t){},t.prototype.memoize=function(){var t=new p.MemoizeMapCombinator;return t.bindInput(this),t},t.prototype.filter=function(t){var n=new p.FilterFieldsCombinator(t);return n.bindInput(this),n},t.prototype.map=function(t){var n;return 1===t.length?((n=new u.MapValueCombinator(t)).bindInput(this),n):((n=new p.MapFieldValuesCombinator(t)).bindInput(this),n)},t.prototype.reduce=function(t,n,i){var e=new p.ReduceFieldsCombinator(t,n,i);return e.bindInput(this),e},t.prototype.watch=function(t){return 1===t.length?(new u.WatchValueCombinator(t).bindInput(this),this):(new p.WatchFieldsCombinator(t).bindInput(this),this)},t}(),m=function(t){function n(n){var i=t.call(this)||this;return i._outlet=n,i}return s(n,t),n.prototype.outlet=function(){return this._outlet},n.prototype.onInvalidateOutput=function(){this._outlet.invalidateInput()},n.prototype.onReconcileOutput=function(t){this._outlet.reconcileInput(t)},n}(a),w=function(t){function n(n){var i=t.call(this)||this;return i._outlet=n,i}return s(n,t),n.prototype.outlet=function(){return this._outlet},n.prototype.onInvalidateOutputKey=function(t,n){this._outlet.invalidateInput()},n.prototype.onInvalidateOutput=function(){this._outlet.invalidateInput()},n.prototype.onReconcileOutputKey=function(t,n,i){this._outlet.reconcileInput(i)},n.prototype.onReconcileOutput=function(t){this._outlet.reconcileInput(t)},n}(_),b=function(t){function n(n){var i=t.call(this)||this;return i._state=n,i}return s(n,t),n.prototype.get=function(){return this._state},n.prototype.set=function(t){var n=this._state;return this._state=t,this.invalidateInput(),n},n}(h),R=function(t){function n(n){var i=t.call(this)||this;return i._state=n,i}return s(n,t),n.prototype.get=function(){return this._state},n.prototype.onReconcileOutput=function(t){null!==this._input&&(this._state=this._input.get())},n}(a),K=function(t){function n(n){void 0===n&&(n=new i.BTree);var e=t.call(this)||this;return e._state=n,n.forEach((function(t){this._effects=this._effects.updated(t,0)}),e),e}return s(n,t),n.prototype.has=function(t){return this._state.has(t)},n.prototype.get=function(t){return void 0===t?this._state:this._state.get(t)},n.prototype.set=function(t,n){var i=this._state.get(t);return this._state=this._state.updated(t,n),this.invalidateInputKey(t,0),i},n.prototype.delete=function(t){var n=this._state,i=n.removed(t);return n!==i&&(this._state=i,this.invalidateInputKey(t,1)),this},n.prototype.keyIterator=function(){return this._state.keys()},n}(y),g=function(t){function n(){var n=t.call(this)||this;return n._state=new i.BTree,n}return s(n,t),n.prototype.get=function(){return this._state},n.prototype.onReconcileOutputKey=function(t,n,i){if(0===n){if(null!==this._input){var e=this._input.get(t);this._state=void 0!==e?this._state.updated(t,e):this._state.removed(t)}}else 1===n&&(this._state=this._state.removed(t))},n}(_),C=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return s(n,t),n.prototype.get=function(){return this._state},n.prototype.onReconcile=function(t){null!==this._input&&(this._state=this._input.get())},n.prototype.memoize=function(){return this},n}(f);u.MemoizeValueCombinator=C;var F=function(t){function n(){var n=t.call(this)||this;return n._cache=new i.BTree,n}return s(n,t),n.prototype.has=function(t){return this._cache.has(t)},n.prototype.get=function(t){return void 0===t?(void 0===this._state&&null!=this._input&&(this._state=this._input.get()),this._state):this._cache.get(t)},n.prototype.keyIterator=function(){return this._cache.keys()},n.prototype.onReconcileKey=function(t,n,i){if(0===n){if(null!==this._input){var e=this._input.get(t);this._cache=void 0!==e?this._cache.updated(t,e):this._cache.removed(t)}}else 1===n&&(this._cache=this._cache.removed(t))},n.prototype.onReconcile=function(t){this._state=void 0},n.prototype.memoize=function(){return this},n}(v);p.MemoizeMapCombinator=F;var M=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.has=function(t){if(null!==this._input){var n=this._input.get(t);return void 0!==n&&this.evaluate(t,n)}return!1},e.prototype.get=function(t){if(void 0===t){for(var n=new i.BTree,e=this.keyIterator();;){var o=e.next();if(o.done)break;var u=o.value;void 0!==(r=this._input.get(u))&&this.evaluate(u,r)&&n.set(u,r)}return n}var r;if(null!==this._input&&void 0!==(r=this._input.get(t))&&this.evaluate(t,r))return r},e.prototype.keyIterator=function(){return null!==this._input?this._input.keyIterator():n.Cursor.empty()},e.prototype.onInvalidateOutputKey=function(t,n){this.invalidateInputKey(t,n)},e.prototype.onReconcileOutputKey=function(t,n,i){this.reconcileInputKey(t,i)},e.prototype.willReconcileInputKey=function(t,n,i){if(0===n&&null!==this._input){var e=this._input.get(t);if(void 0===e||!this.evaluate(t,e))return 1}return n},e}(O),E=function(t){function n(n){var i=t.call(this)||this;return i._func=n,i}return s(n,t),n.prototype.evaluate=function(t,n){return this._func(t,n)},n}(M);p.FilterFieldsCombinator=E;var V=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return s(n,t),n.prototype.get=function(){return null!==this._input?this.evaluate(this._input.get()):void 0},n}(f),k=function(t){function n(n){var i=t.call(this)||this;return i._func=n,i}return s(n,t),n.prototype.evaluate=function(t){return void 0!==t?this._func(t):void 0},n}(V);u.MapValueCombinator=k;var T=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e.prototype.has=function(t){return null!==this._input&&this._input.has(t)},e.prototype.get=function(t){if(void 0===t){for(var n=new i.BTree,e=this.keyIterator();;){var o=e.next();if(o.done)break;var u=o.value,r=this.evaluate(u,this._input.get(u));void 0!==r&&n.set(u,r)}return n}return null!==this._input?this.evaluate(t,this._input.get(t)):void 0},e.prototype.keyIterator=function(){return null!==this._input?this._input.keyIterator():n.Cursor.empty()},e}(v),A=function(t){function n(n){var i=t.call(this)||this;return i._func=n,i}return s(n,t),n.prototype.evaluate=function(t,n){return void 0!==n?this._func(t,n):void 0},n}(T);p.MapFieldValuesCombinator=A;var B=function(t){function n(){var n=t.call(this)||this;return n._state=new i.BTree,n}return s(n,t),n.prototype.get=function(){return this._state.reduced(this.identity(),this.accumulate.bind(this),this.combine.bind(this))},n.prototype.onReconcileOutputKey=function(t,n,i){if(0===n){if(null!==this._input){var e=this._input.get(t);void 0!==e?this._state.set(t,e):this._state.delete(t)}}else 1===n&&this._state.delete(t)},n}(I),z=function(t){function n(n,i,e){var o=t.call(this)||this;return o._identity=n,o._accumulator=i,o._combiner=e,o}return s(n,t),n.prototype.get=function(){return this._state.reduced(this._identity,this._accumulator,this._combiner)},n.prototype.identity=function(){return this._identity},n.prototype.accumulate=function(t,n){return this._accumulator(t,n)},n.prototype.combine=function(t,n){return this._combiner(t,n)},n}(B);p.ReduceFieldsCombinator=z;var P=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return s(n,t),n.prototype.onReconcileOutput=function(t){null!==this._input&&this.evaluate(this._input.get())},n}(a),S=function(t){function n(n){var i=t.call(this)||this;return i._func=n,i}return s(n,t),n.prototype.evaluate=function(t){if(void 0!==t)return this._func(t)},n}(P);u.WatchValueCombinator=S;var x=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return s(n,t),n.prototype.onReconcileOutputKey=function(t,n,i){0===n?null!==this._input?this.evaluate(t,this._input.get(t)):this.evaluate(t,void 0):1===n&&this.evaluate(t,void 0)},n}(_),W=function(t){function n(n){var i=t.call(this)||this;return i._func=n,i}return s(n,t),n.prototype.evaluate=function(t,n){if(void 0!==n)return this._func(t,n)},n}(x);p.WatchFieldsCombinator=W;var j=function(t){function n(n){var i=t.call(this)||this;return i._streamlet=n,i}return s(n,t),n.prototype.streamlet=function(){return this._streamlet},n.prototype.willInvalidateOutput=function(){var t=this._streamlet;t.willInvalidateInlet&&t.willInvalidateInlet(this)},n.prototype.didInvalidateOutput=function(){var t=this._streamlet;t.didInvalidateInlet?t.didInvalidateInlet(this):t.invalidate()},n.prototype.willReconcileOutput=function(t){var n=this._streamlet;n.willReconcileInlet&&n.willReconcileInlet(this,t)},n.prototype.didReconcileOutput=function(t){var n=this._streamlet;n.didReconcileInlet?n.didReconcileInlet(this,t):n.reconcile(t)},n}(a),U=function(t){function n(n){var i=t.call(this)||this;return i._streamlet=n,i}return s(n,t),n.prototype.streamlet=function(){return this._streamlet},n.prototype.get=function(){var t=this._streamlet;if(t.getOutput)return t.getOutput(this)},n.prototype.willInvalidateInput=function(){var t=this._streamlet;t.willInvalidateOutlet&&t.willInvalidateOutlet(this)},n.prototype.didInvalidateInput=function(){var t=this._streamlet;t.didInvalidateOutlet?t.didInvalidateOutlet(this):t.invalidate()},n.prototype.willReconcileInput=function(t){var n=this._streamlet;n.willReconcileOutlet&&n.willReconcileOutlet(this,t)},n.prototype.didReconcileInput=function(t){var n=this._streamlet;n.didReconcileOutlet&&n.didReconcileOutlet(this,t)},n}(h),q=function(t){function n(n){var i=t.call(this)||this;return i._streamlet=n,i}return s(n,t),n.prototype.streamlet=function(){return this._streamlet},n.prototype.get=function(){var t=this._streamlet;if(t.getOutput){var n=t.getOutput(this);if(void 0!==n)return n}if(null!==this._input)return this._input.get()},n.prototype.willInvalidate=function(){var t=this._streamlet;t.willInvalidateOutlet&&t.willInvalidateOutlet(this)},n.prototype.didInvalidate=function(){var t=this._streamlet;t.didInvalidateOutlet?t.didInvalidateOutlet(this):t.invalidate()},n.prototype.willUpdate=function(t){var n=this._streamlet;n.willReconcileOutlet&&n.willReconcileOutlet(this,t)},n.prototype.didUpdate=function(t){var n=this._streamlet;n.didReconcileOutlet&&n.didReconcileOutlet(this,t)},n}(f),D=function(t,n,i){this.key=t,this.name=n,this.type=i},G=function(t,n,i){this.key=t,this.name=n,this.type=i},H=function(t,n,i){this.key=t,this.name=n,this.type=i},J=function(){function t(t){void 0===t&&(t=null),this.scope=t,this._version=-1}return t.prototype.streamletClass=function(){return this.__proto__},t.prototype.streamletScope=function(){return this.scope},t.prototype.setStreamletScope=function(t){this.scope=t},t.prototype.streamletContext=function(){if(this.context)return this.context;var t=this.streamletScope();return null!==t?t.streamletContext():null},t.prototype.setStreamletContext=function(t){this.context=t},t.prototype.inlet=function(n){return void 0===n?new j(this):t.reflectInletKey(n,this,this.streamletClass())},t.prototype.bindInput=function(t,n){var i=this.inlet(t);if(null===i)throw new Error(""+t);i.bindInput(n)},t.prototype.unbindInput=function(t){var n=this.inlet(t);if(null===n)throw new Error(""+t);n.unbindInput()},t.prototype.outlet=function(n){return void 0===n?new U(this):"string"==typeof n?t.reflectOutletKey(n,this,this.streamletClass()):n},t.prototype.inoutlet=function(){return new q(this)},t.prototype.invalidate=function(){this._version>=0&&(this.willInvalidate(),this._version=-1,this.onInvalidate(),this.onInvalidateOutlets(),this.didInvalidate())},t.prototype.reconcile=function(t){this._version<0&&(this.willReconcile(t),this._version=t,this.onReconcileInlets(t),this.onReconcile(t),this.onReconcileOutlets(t),this.didReconcile(t))},t.prototype.getInput=function(t,n){var i;if("string"==typeof t&&(t=this.inlet(t)),null!==t){var e=t.input();null!==e&&(i=e.get())}return void 0===i&&(i=n),i},t.prototype.getOutput=function(t){},t.prototype.disconnectInputs=function(){t.disconnectInputs(this,this.streamletClass())},t.disconnectInputs=function(n,i){for(;i;){if(i.hasOwnProperty("_inlets"))for(var e in i._inlets){var o=i._inlets[e];if(o instanceof D)t.reflectInletField(n,o).disconnectInputs();else if(o instanceof H){t.reflectInoutletField(n,o).disconnectInputs()}}i=i.__proto__}},t.prototype.disconnectOutputs=function(){t.disconnectOutputs(this,this.streamletClass())},t.disconnectOutputs=function(n,i){for(;i;){if(i.hasOwnProperty("_outlets"))for(var e in i._outlets){var o=i._outlets[e];if(o instanceof G)t.reflectOutletField(n,o).disconnectOutputs();else if(o instanceof H){t.reflectInoutletField(n,o).disconnectOutputs()}}i=i.__proto__}},t.prototype.willInvalidateInlet=function(t){},t.prototype.didInvalidateInlet=function(t){this.invalidate()},t.prototype.willReconcileInlet=function(t,n){},t.prototype.didReconcileInlet=function(t,n){this.reconcile(n)},t.prototype.willInvalidateOutlet=function(t){},t.prototype.didInvalidateOutlet=function(t){},t.prototype.willReconcileOutlet=function(t,n){},t.prototype.didReconcileOutlet=function(t,n){},t.prototype.willInvalidate=function(){},t.prototype.onInvalidate=function(){},t.prototype.onInvalidateOutlets=function(){t.invalidateOutlets(this,this.streamletClass())},t.invalidateOutlets=function(n,i){for(;i;){if(i.hasOwnProperty("_outlets"))for(var e in i._outlets){var o=i._outlets[e];if(o instanceof G)t.reflectOutletField(n,o).invalidateInput();else if(o instanceof H){t.reflectInoutletField(n,o).invalidateInput()}}i=i.__proto__}},t.prototype.didInvalidate=function(){},t.prototype.willReconcile=function(t){},t.prototype.onReconcileInlets=function(n){t.reconcileInlets(n,this,this.streamletClass())},t.reconcileInlets=function(n,i,e){for(;e;){if(e.hasOwnProperty("_inlets"))for(var o in e._inlets){var u=e._inlets[o];if(u instanceof D)t.reflectInletField(i,u).reconcileOutput(n);else if(u instanceof H){t.reflectInoutletField(i,u).reconcileOutput(n)}}e=e.__proto__}},t.prototype.onReconcile=function(t){},t.prototype.onReconcileOutlets=function(n){t.reconcileOutlets(n,this,this.streamletClass())},t.reconcileOutlets=function(n,i,e){for(;e;){if(e.hasOwnProperty("_outlets"))for(var o in e._outlets){var u=e._outlets[o];if(u instanceof G)t.reflectOutletField(i,u).reconcileInput(n);else if(u instanceof H){t.reflectInoutletField(i,u).reconcileInput(n)}}e=e.__proto__}},t.prototype.didReconcile=function(t){},t.reflectEachInlet=function(n,i,e,o){for(var u=0;i;){if(i.hasOwnProperty("_inlets"))for(var r in i._inlets){var p=i._inlets[r],l=void 0;l=p instanceof D?t.reflectInletField(n,p):p instanceof H?t.reflectInoutletField(n,p):null;var s=e.call(o,l,p.name,u);if(void 0!==s)return s;u+=1}i=i.__proto__}},t.reflectEachOutlet=function(n,i,e,o){for(var u=0;i;){if(i.hasOwnProperty("_outlets"))for(var r in i._outlets){var p=i._outlets[r],l=void 0;l=p instanceof G?t.reflectOutletField(n,p):p instanceof H?t.reflectInoutletField(n,p):null;var s=e.call(o,l,p.name,u);if(void 0!==s)return s;u+=1}i=i.__proto__}},t.reflectInletCount=function(t){for(var n=0;t;){if(t.hasOwnProperty("_inlets"))for(var i in t._inlets)n+=1;t=t.__proto__}return n},t.reflectOutletCount=function(t){for(var n=0;t;){if(t.hasOwnProperty("_outlets"))for(var i in t._outlets)n+=1;t=t.__proto__}return n},t.reflectInletIndex=function(n,i,e){for(;e;){if(e.hasOwnProperty("_inlets"))for(var o in e._inlets){if(0===n){var u=e._inlets[o];return u instanceof D?[u.name,t.reflectInletField(i,u)]:u instanceof H?[u.name,t.reflectInoutletField(i,u)]:null}n-=1}e=e.__proto__}return null},t.reflectOutletIndex=function(n,i,e){for(;e;){if(e.hasOwnProperty("_outlets"))for(var o in e._outlets){if(0===n){var u=e._outlets[o];return u instanceof G?[u.name,t.reflectOutletField(i,u)]:u instanceof H?[u.name,t.reflectInoutletField(i,u)]:null}n-=1}e=e.__proto__}return null},t.reflectInletKey=function(n,i,e){for(;e;){if(e.hasOwnProperty("_inlets")){var o=e._inlets[n];if(void 0!==o)return o instanceof D?t.reflectInletField(i,o):o instanceof H?t.reflectInoutletField(i,o):null}e=e.__proto__}return null},t.reflectOutletKey=function(n,i,e){for(;e;){if(e.hasOwnProperty("_outlets")){var o=e._outlets[n];if(void 0!==o)return o instanceof G?t.reflectOutletField(i,o):o instanceof H?t.reflectInoutletField(i,o):null}e=e.__proto__}return null},t.reflectInletField=function(n,i){if("value"===i.type)return t.reflectValueInletField(n,i.key);if("map"===i.type)return t.reflectMapInletField(n,i.key);throw new TypeError(i.type)},t.reflectValueInletField=function(n,i){var e=n[i];return e||(e=n instanceof t?n.inlet():new j(n),n[i]=e),e},t.reflectMapInletField=function(t,n){return null},t.reflectOutletField=function(n,i){if("value"===i.type)return t.reflectValueOutletField(n,i.key);if("map"===i.type)return t.reflectMapOutletField(n,i.key);throw new TypeError(i.type)},t.reflectValueOutletField=function(n,i){var e=n[i];return e||(e=n instanceof t?n.outlet():new U(n),n[i]=e),e},t.reflectMapOutletField=function(t,n){return null},t.reflectInoutletField=function(n,i){if("value"===i.type)return t.reflectValueInoutletField(n,i.key);if("map"===i.type)return t.reflectMapInoutletField(n,i.key);throw new TypeError(i.type)},t.reflectValueInoutletField=function(n,i){var e=n[i];return e||(e=n instanceof t?n.inoutlet():new q(n),n[i]=e),e},t.reflectMapInoutletField=function(t,n){return null},t.init=function(t){t.hasOwnProperty("_inlets")||(t._inlets={}),t.hasOwnProperty("_outlets")||(t._outlets={}),t.hasOwnProperty("_inoutlets")||(t._inoutlets={})},t.decorateInlet=function(n,i,e){t.init(i);var o=void 0!==n.name?n.name:e,u=void 0!==n.type?n.type:"value",r=new D(e,o,u);i._inlets[o]=r},t.decorateOutlet=function(n,i,e){t.init(i);var o=void 0!==n.name?n.name:e,u=void 0!==n.type?n.type:"value",r=new G(e,o,u);i._outlets[o]=r},t.decorateInoutlet=function(n,i,e){t.init(i);var o=void 0!==n.name?n.name:e,u=void 0!==n.type?n.type:"value",r=new H(e,o,u);i._inlets[o]=r,i._outlets[o]=r,i._inoutlets[o]=r},t}();t.AbstractInlet=a,t.AbstractInoutlet=f,t.AbstractMapInlet=_,t.AbstractMapInletMapOutlet=O,t.AbstractMapInletOutlet=I,t.AbstractMapInoutlet=v,t.AbstractMapOutlet=y,t.AbstractOutlet=h,t.AbstractStreamlet=J,t.FilterFieldsCombinator=E,t.FilterFieldsOperator=M,t.In=function(t,n){if(1===arguments.length)return"string"==typeof t&&(t={name:t}),J.decorateInlet.bind(void 0,t);J.decorateInlet({},t,n)},t.Inlet=o,t.InletDescriptor=D,t.Inout=function(t,n){if(1===arguments.length)return"string"==typeof t&&(t={name:t}),J.decorateInoutlet.bind(void 0,t);J.decorateInoutlet({},t,n)},t.KeyOutlet=d,t.MapFieldValuesCombinator=A,t.MapFieldValuesOperator=T,t.MapInlet=r,t.MapInput=K,t.MapOutlet=p,t.MapOutput=g,t.MapValueCombinator=k,t.MapValueOperator=V,t.MemoizeMapCombinator=F,t.MemoizeValueCombinator=C,t.Out=function(t,n){if(1===arguments.length)return"string"==typeof t&&(t={name:t}),J.decorateOutlet.bind(void 0,t);J.decorateOutlet({},t,n)},t.Outlet=u,t.OutletDescriptor=G,t.OutletInlet=m,t.OutletMapInlet=w,t.ReduceFieldsCombinator=z,t.ReduceFieldsOperator=B,t.Streamlet={is:function(t){if("object"==typeof t&&t){var n=t;return"function"==typeof n.streamletScope&&"function"==typeof n.setStreamletScope&&"function"==typeof n.streamletContext&&"function"==typeof n.setStreamletContext}return!1}},t.StreamletException=c,t.StreamletInlet=j,t.StreamletInoutlet=q,t.StreamletOutlet=U,t.StreamletScope={is:function(t){if("object"==typeof t&&t){var n=t;return"function"==typeof n.streamletScope&&"function"==typeof n.streamletContext&&"function"==typeof n.outlet}return!1}},t.ValueInput=b,t.ValueOutput=R,t.WatchFieldsCombinator=W,t.WatchFieldsOperator=x,t.WatchValueCombinator=S,t.WatchValueOperator=P,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=swim-streamlet.min.js.map