// swim-dataflow-3.10.2; copyright 2015-2020 SWIM.AI inc.
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@swim/streamlet"),require("@swim/util"),require("@swim/collections"),require("@swim/structure")):"function"==typeof define&&define.amd?define(["exports","@swim/streamlet","@swim/util","@swim/collections","@swim/structure"],e):e((t=t||self).swim=t.swim||{},t.swim,t.swim,t.swim,t.swim)}(this,(function(t,e,n,r,i){"use strict";var o={is:function(t){if("object"==typeof t&&t){var n=t;return e.MapOutlet.is(n)&&e.StreamletScope.is(n)}return!1},Streamlet:void 0,Model:void 0,Scope:void 0,Dataflow:void 0},u=function(t,e){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */function l(t,e){function n(){this.constructor=t}u(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var a=function(t){function u(){var e=t.call(this)||this;return e._effects=new r.BTree,e._outlets=new r.BTree,e._outputs=null,e._version=-1,e}return l(u,t),u.prototype.streamletScope=function(){return null},u.prototype.streamletContext=function(){var t=this.streamletScope();return null!==t?t.streamletContext():null},u.prototype.hasOwn=function(t){return this.has(t)},u.prototype.get=function(e){return void 0===e?this:t.prototype.get.call(this,e)},u.prototype.outlet=function(t){if("string"==typeof t&&(t=i.Text.from(t)),!this.hasOwn(t)){var n=this.streamletScope();if(o.is(n)&&n.has(t))return n.outlet(t)}var r=this._outlets.get(t);return void 0===r&&(r=new e.KeyOutlet(this,t),this._outlets=this._outlets.updated(t,r),this.invalidateInputKey(t,0)),r},u.prototype.outputIterator=function(){return null!==this._outputs?n.Cursor.array(this._outputs):n.Cursor.empty()},u.prototype.bindOutput=function(t){for(var e=this._outputs,n=null!==e?e.length:0,r=new Array(n+1),i=0;i<n;i+=1)r[i]=e[i];r[n]=t,this._outputs=r},u.prototype.unbindOutput=function(t){for(var e=this._outputs,n=null!==e?e.length:0,r=0;r<n;r+=1)if(e[r]===t){if(n>1){for(var i=new Array(n-1),o=0;o<r;o+=1)i[o]=e[o];for(o=r;o<n-1;o+=1)i[o]=e[o+1];this._outputs=i}else this._outputs=null;break}},u.prototype.unbindOutputs=function(){var t=this._outlets;t.isEmpty()&&(this._outlets=new r.BTree,t.forEach((function(t,e){e.unbindOutputs()}),this));var e=this._outputs;if(null!==e){this._outputs=null;for(var n=0,i=e.length;n<i;n+=1)e[n].unbindInput()}},u.prototype.disconnectOutputs=function(){var t=this._outlets;t.isEmpty()&&(this._outlets=new r.BTree,t.forEach((function(t,e){e.disconnectOutputs()}),this));var e=this._outputs;if(null!==e){this._outputs=null;for(var n=0,l=e.length;n<l;n+=1){var a=e[n];a.unbindInput(),a.disconnectOutputs()}}this.forEach((function(t){t instanceof i.Field&&(t=t.toValue()),t instanceof u?t.disconnectOutputs():t instanceof o.Streamlet?t.disconnectOutputs():o.is(t)&&t.disconnectOutputs()}),this)},u.prototype.disconnectInputs=function(){},u.prototype.invalidateInputKey=function(t,n){var r=this._effects;if(r.get(t)!==n){this.willInvalidateInputKey(t,n),this._effects=r.updated(t,n),this._version=-1,this.onInvalidateInputKey(t,n);for(var i=null!==this._outputs?this._outputs.length:0,o=0;o<i;o+=1){var u=this._outputs[o];e.MapInlet.is(u)?u.invalidateOutputKey(t,n):u.invalidateOutput()}var l=this._outlets.get(t);void 0!==l&&l.invalidateInput(),this.didInvalidateInputKey(t,n)}},u.prototype.invalidateInput=function(){if(this._version>=0){this.willInvalidateInput(),this._version=-1,this.onInvalidateInput();for(var t=null!==this._outputs?this._outputs.length:0,e=0;e<t;e+=1)this._outputs[e].invalidateOutput();this._outlets.forEach((function(t,e){e.invalidateInput()}),this),this.didInvalidateInput()}},u.prototype.reconcileInputKey=function(t,n){if(this._version<0){var r=this._effects,i=r.get(t);if(void 0!==i){this.willReconcileInputKey(t,i,n),this._effects=r.removed(t),this.onReconcileInputKey(t,i,n);for(var o=0,u=null!==this._outputs?this._outputs.length:0;o<u;o+=1){var l=this._outputs[o];e.MapInlet.is(l)&&l.reconcileOutputKey(t,n)}var a=this._outlets.get(t);void 0!==a&&a.reconcileInput(n),this.didReconcileInputKey(t,i,n)}}},u.prototype.reconcileInput=function(t){if(this._version<0){this.willReconcileInput(t),this._effects.forEach((function(e){this.reconcileInputKey(e,t)}),this),this._version=t,this.onReconcileInput(t);for(var e=0,n=null!==this._outputs?this._outputs.length:0;e<n;e+=1)this._outputs[e].reconcileOutput(t);this.forEach((function(e){e instanceof i.Field&&(e=e.toValue()),e instanceof u?e.reconcileInput(t):e instanceof o.Streamlet?e.reconcile(t):o.is(e)&&e.reconcileInput(t)}),this),this.didReconcileInput(t)}},u.prototype.willInvalidateInputKey=function(t,e){},u.prototype.onInvalidateInputKey=function(t,e){},u.prototype.didInvalidateInputKey=function(t,e){},u.prototype.willInvalidateInput=function(){},u.prototype.onInvalidateInput=function(){},u.prototype.didInvalidateInput=function(){},u.prototype.willReconcileInputKey=function(t,e,n){},u.prototype.onReconcileInputKey=function(t,e,n){},u.prototype.didReconcileInputKey=function(t,e,n){},u.prototype.willReconcileInput=function(t){},u.prototype.onReconcileInput=function(t){},u.prototype.didReconcileInput=function(t){},u.prototype.memoize=function(){var t=new e.MemoizeMapCombinator;return t.bindInput(this),t},u.prototype.filter=function(n){if("function"!=typeof n)return t.prototype.filter.call(this,n);var r=new e.FilterFieldsCombinator(n);return r.bindInput(this),r},u.prototype.map=function(t){var n;return 1===t.length?((n=new e.MapValueCombinator(t)).bindInput(this),n):((n=new e.MapFieldValuesCombinator(t)).bindInput(this),n)},u.prototype.reduce=function(t,n,r){var i=new e.ReduceFieldsCombinator(t,n,r);return i.bindInput(this),i},u.prototype.watch=function(t){return 1===t.length?(new e.WatchValueCombinator(t).bindInput(this),this):(new e.WatchFieldsCombinator(t).bindInput(this),this)},u}(i.Record),p=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return l(n,t),n.prototype.isConstant=function(){return!1},n.prototype.streamletClass=function(){return this.__proto__},n.prototype.compile=function(){e.AbstractStreamlet.reflectEachInlet(this,this.streamletClass(),(function(t,e){null===t.input()&&this.compileInlet(t,e)}),this)},n.prototype.compileInlet=function(t,e){var n=this.streamletScope();if(null!==n){var r=n.outlet(e);null!==r&&t.bindInput(r)}},n}(i.Record);o.Streamlet=p;var s=function(t){function n(e){void 0===e&&(e=null);var n=t.call(this)||this;return n.scope=e,n.context=null,n._version=-1,n}return l(n,t),n.prototype.streamletScope=function(){return this.scope},n.prototype.setStreamletScope=function(t){this.scope=t},n.prototype.streamletContext=function(){if(this.context)return this.context;var t=this.streamletScope();return null!==t?t.streamletContext():null},n.prototype.setStreamletContext=function(t){this.context=t},n.prototype.isEmpty=function(){return 0!==this.length},Object.defineProperty(n.prototype,"length",{get:function(){return e.AbstractStreamlet.reflectOutletCount(this.streamletClass())},enumerable:!0,configurable:!0}),n.prototype.has=function(t){if(t instanceof i.Text)t=t.value;else if("string"!=typeof t)return!1;return null!==this.outlet(t)},n.prototype.get=function(t){if(t instanceof i.Text)t=t.value;else if("string"!=typeof t)return i.Value.absent();var e=this.outlet(t);if(null!==e){var n=e.get();if(void 0!==n)return n}return i.Value.absent()},n.prototype.getAttr=function(t){return i.Value.absent()},n.prototype.getSlot=function(t){return this.get(t)},n.prototype.getField=function(t){if("string"==typeof t)t=i.Text.from(t);else if(!(t instanceof i.Text))return;var e=this.get(t);if(e.isDefined())return i.Slot.of(t,e)},n.prototype.getItem=function(t){t instanceof i.Num&&(t=t.value);var n=e.AbstractStreamlet.reflectOutletIndex(t,this,this.streamletClass());if(null!==n){var r=n[0],o=n[1].get();return void 0===o&&(o=i.Value.extant()),i.Slot.of(r,o)}return i.Item.absent()},n.prototype.set=function(t,e){throw new Error("unsupported")},n.prototype.setAttr=function(t,e){throw new Error("unsupported")},n.prototype.setSlot=function(t,e){throw new Error("unsupported")},n.prototype.setItem=function(t,e){throw new Error("unsupported")},n.prototype.push=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];throw new Error("unsupported")},n.prototype.splice=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];throw new Error("unsupported")},n.prototype.delete=function(t){throw new Error("unsupported")},n.prototype.clear=function(){throw new Error("unsupported")},n.prototype.forEach=function(t,n){return e.AbstractStreamlet.reflectEachOutlet(this,this.streamletClass(),(function(e,r,i){var o=e.get();if(void 0!==o){var u=t.call(n,o,i);if(void 0!==u)return u}}),this)},n.prototype.inlet=function(t){return void 0===t?new e.StreamletInlet(this):e.AbstractStreamlet.reflectInletKey(t,this,this.streamletClass())},n.prototype.bindInput=function(t,e){var n=this.inlet(t);if(null===n)throw new Error(""+t);n.bindInput(e)},n.prototype.unbindInput=function(t){var e=this.inlet(t);if(null===e)throw new Error(""+t);e.unbindInput()},n.prototype.outlet=function(t){return void 0===t?new e.StreamletOutlet(this):"string"==typeof t?e.AbstractStreamlet.reflectOutletKey(t,this,this.streamletClass()):t},n.prototype.inoutlet=function(){return new e.StreamletInoutlet(this)},n.prototype.invalidate=function(){this._version>=0&&(this.willInvalidate(),this._version=-1,this.onInvalidate(),this.onInvalidateOutlets(),this.didInvalidate())},n.prototype.reconcile=function(t){this._version<0&&(this.willReconcile(t),this._version=t,this.onReconcileInlets(t),this.onReconcile(t),this.onReconcileOutlets(t),this.didReconcile(t))},n.prototype.getInput=function(t,e){var n;if("string"==typeof t&&(t=this.inlet(t)),null!==t){var r=t.input();null!==r&&(n=r.get())}return void 0===n&&(n=e),n},n.prototype.castInput=function(t,e,n){var r,i=this.getInput(t);return void 0!==i&&(r=e.cast(i)),void 0===r&&(r=n),r},n.prototype.coerceInput=function(t,e,n){var r,i=this.getInput(t);return void 0!==i&&(r=e.cast(i)),void 0===r&&(r=e.unit()),void 0===r&&(r=n),r},n.prototype.getOutput=function(t){},n.prototype.disconnectInputs=function(){e.AbstractStreamlet.disconnectInputs(this,this.streamletClass())},n.prototype.disconnectOutputs=function(){e.AbstractStreamlet.disconnectOutputs(this,this.streamletClass())},n.prototype.willInvalidateInlet=function(t){},n.prototype.didInvalidateInlet=function(t){this.invalidate()},n.prototype.willReconcileInlet=function(t,e){},n.prototype.didReconcileInlet=function(t,e){this.reconcile(e)},n.prototype.willInvalidateOutlet=function(t){},n.prototype.didInvalidateOutlet=function(t){},n.prototype.willReconcileOutlet=function(t,e){},n.prototype.didReconcileOutlet=function(t,e){},n.prototype.willInvalidate=function(){},n.prototype.onInvalidate=function(){},n.prototype.didInvalidate=function(){},n.prototype.onInvalidateOutlets=function(){e.AbstractStreamlet.invalidateOutlets(this,this.streamletClass())},n.prototype.willReconcile=function(t){},n.prototype.onReconcileInlets=function(t){e.AbstractStreamlet.reconcileInlets(t,this,this.streamletClass())},n.prototype.onReconcile=function(t){},n.prototype.onReconcileOutlets=function(t){e.AbstractStreamlet.reconcileOutlets(t,this,this.streamletClass())},n.prototype.didReconcile=function(t){},n}(p),c=function(t){function e(e,n){var r=t.call(this)||this;return r._record=e,r._key=n,r}return l(e,t),e.prototype.onInvalidateOutput=function(){o.is(this._record)&&this._record.invalidateInputKey(this._key,0)},e.prototype.onReconcileOutput=function(t){if(null!==this._input){var e=this._input.get();void 0!==e?this._record.set(this._key,e):this._record.delete(this._key)}},e}(e.AbstractInlet),f=function(){function t(){}return t.system=function(){return null},t}(),h=function(t){function e(e){void 0===e&&(e=i.Record.create());var n=t.call(this)||this;return n._state=e,n._fieldUpdaters=new r.BTree,n}return l(e,t),e.prototype.isEmpty=function(){return this._state.isEmpty()},e.prototype.isArray=function(){return this._state.isArray()},e.prototype.isObject=function(){return this._state.isObject()},Object.defineProperty(e.prototype,"length",{get:function(){return this._state.length},enumerable:!0,configurable:!0}),e.prototype.fieldCount=function(){return this._state.fieldCount()},e.prototype.valueCount=function(){return this._state.valueCount()},e.prototype.has=function(t){if(this._state.has(t))return!0;var e=this.streamletScope();return e instanceof i.Record&&e.has(t)},e.prototype.hasOwn=function(t){return this._state.has(t)},e.prototype.indexOf=function(t,e){return this._state.indexOf(t,e)},e.prototype.lastIndexOf=function(t,e){return void 0===e&&(e=0),this._state.lastIndexOf(t,e)},e.prototype.get=function(t){if(void 0===t)return this;t=i.Value.fromAny(t);var e=this._state.get(t);if(!e.isDefined()){var n=this.streamletScope();n instanceof i.Record&&(e=n.get(t))}return e},e.prototype.getAttr=function(t){t=i.Text.fromAny(t);var e=this._state.getAttr(t);if(!e.isDefined()){var n=this.streamletScope();n instanceof i.Record&&(e=n.getAttr(t))}return e},e.prototype.getSlot=function(t){t=i.Value.fromAny(t);var e=this._state.getSlot(t);if(!e.isDefined()){var n=this.streamletScope();n instanceof i.Record&&(e=n.getSlot(t))}return e},e.prototype.getField=function(t){t=i.Value.fromAny(t);var e=this._state.getField(t);if(void 0===e){var n=this.streamletScope();n instanceof i.Record&&(e=n.getField(t))}return e},e.prototype.getItem=function(t){return this._state.getItem(t)},e.prototype.bindValue=function(t,e){var n=new c(this,t),r=o.Dataflow.compile(e,this);n.bindInput(r),this._fieldUpdaters=this._fieldUpdaters.updated(t,n)},e.prototype.set=function(t,e){if(t=i.Value.fromAny(t),this._state.has(t))this._state.set(t,e);else{var n=this.streamletScope();n instanceof i.Record&&n.has(t)?n.set(t,e):this._state.set(t,e)}return this.invalidateInputKey(t,0),this},e.prototype.setAttr=function(t,e){if(t=i.Text.fromAny(t),this._state.has(t))this._state.setAttr(t,e);else{var n=this.streamletScope();n instanceof i.Record&&n.has(t)?n.setAttr(t,e):this._state.setAttr(t,e)}return this.invalidateInputKey(t,0),this},e.prototype.setSlot=function(t,e){if(t=i.Value.fromAny(t),this._state.has(t))this._state.setSlot(t,e);else{var n=this.streamletScope();n instanceof i.Record&&n.has(t)?n.setSlot(t,e):this._state.setSlot(t,e)}return this.invalidateInputKey(t,0),this},e.prototype.setItem=function(t,e){var n=this._state.getItem(t);return e=i.Item.fromAny(e),this._state.setItem(t,e),n instanceof i.Field&&e instanceof i.Field?n.key.equals(e.key)?this.invalidateInputKey(n.key,0):(this.invalidateInputKey(n.key,1),this.invalidateInputKey(e.key,0)):n instanceof i.Field?this.invalidateInputKey(n.key,1):e instanceof i.Field?this.invalidateInputKey(e.key,0):this.invalidateInput(),this},e.prototype.push=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=this._state.length,r=this._state.push.apply(this._state,arguments);n<r;){var o=this._state.get(n);o instanceof i.Field&&this.invalidateInputKey(o.key,0),n+=1}return r},e.prototype.splice=function(t,e){void 0===e&&(e=0);for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var o=this._state.length;t<0&&(t=o+t),t=Math.max(0,t),e=Math.max(0,e);for(var u=this._state.splice.apply(this._state,arguments),l=0;l<u.length;l+=1){var a=u[l];a instanceof i.Field&&this.invalidateInputKey(a.key,1)}for(l=t;l<t+n.length;l+=1){var p=this._state.get(l);p instanceof i.Field&&this.invalidateInputKey(p.key,0)}return u},e.prototype.delete=function(t){var e=this._state.delete(t);return e instanceof i.Field&&this.invalidateInputKey(e.key,1),e},e.prototype.clear=function(){var t=this._state.branch();this._state.clear(),t.forEach((function(t){t instanceof i.Field&&this.invalidateInputKey(t.key,1)}),this)},e.prototype.forEach=function(t,e){return this._state.forEach(t,e)},e.prototype.keyIterator=function(){throw new Error},e.prototype.disconnectInputs=function(){var t=this._fieldUpdaters;t.isEmpty()||(this._fieldUpdaters=new r.BTree,t.forEach((function(t,e){e.disconnectInputs()}),this))},e.prototype.memoize=function(){return this},e.prototype.materialize=function(t){t.forEach((function(t){this.materializeItem(t)}),this)},e.prototype.materializeItem=function(t){t instanceof i.Field?this.materializeField(t):this.materializeValue(t)},e.prototype.materializeField=function(t){var e=t.value;if(e instanceof p)e.setStreamletScope(this),this._state.push(t);else if(e instanceof i.Record){var n=new o.Scope(this);n.materialize(e),this._state.push(t.updatedValue(n))}else this._state.push(t)},e.prototype.materializeValue=function(t){if(t instanceof p)t.setStreamletScope(this),this._state.push(t);else if(t instanceof i.Record){var e=new o.Scope(this);e.materialize(t),this._state.push(e)}else this._state.push(t)},e.prototype.compile=function(t){t.forEach((function(t,e){this.compileItem(t,e)}),this)},e.prototype.compileItem=function(t,e){t instanceof i.Field?this.compileField(t,e):this.compileValue(t,e)},e.prototype.compileField=function(t,e){var n=t.key,r=t.value;n.isConstant()&&(r.isConstant()?this.invalidateInputKey(n,0):r instanceof p?(r.compile(),this.invalidateInputKey(n,0)):r instanceof i.Record?(this._state.getItem(e).toValue().compile(r),this.invalidateInputKey(n,0)):(t.setValue(i.Value.extant()),this.bindValue(n,r)))},e.prototype.compileValue=function(t,e){t instanceof p?t.compile():t instanceof i.Record?this._state.getItem(e).compile(t):t.isConstant()},e.prototype.transmute=function(t){void 0===t&&(t=f.system()),this.forEach((function(e,n){var r=this.transmuteItem(e,t);e!==r&&this.setItem(n,r)}),this)},e.prototype.transmuteItem=function(t,e){return t instanceof i.Field?this.transmuteField(t,e):this.transmuteValue(t,e)},e.prototype.transmuteField=function(t,e){var n=t.value,r=this.transmuteValue(n,e);return n!==r?t.updatedValue(r):t},e.prototype.transmuteValue=function(t,n){if(t instanceof e){var r=this.transmuteModel(t);return t===r&&n&&(r=n.transmute(t)),r}return t},e.prototype.transmuteModel=function(t){var n=this.streamletScope();return n instanceof e?n.transmuteModel(t):t},e.from=function(t){var n=new e;return n.materialize(t),n.compile(t),n},e.of=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e.from(i.Record.of.apply(void 0,arguments))},e.globalScope=function(){var t=new e;return t.materializeField(i.Slot.of("math",i.MathModule.scope().branch())),t},e}(a);o.Model=h;var d=function(t){function e(e,n){var r=t.call(this,n)||this;return r.scope=e,r}return l(e,t),e.prototype.streamletScope=function(){return this.scope},e.from=function(t){var n=new e(e.globalScope());return n.materialize(t),n.compile(t),n},e.of=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e.from(i.Record.of.apply(void 0,arguments))},e}(h);o.Scope=d;var y=function(t){function n(){var n=t.call(this)||this;return n._keyInlet=new e.OutletInlet(n),n._mapInlet=new e.OutletMapInlet(n),n}return l(n,t),n.prototype.keyInlet=function(){return this._keyInlet},n.prototype.mapInlet=function(){return this._mapInlet},n.prototype.get=function(){var t=this._keyInlet.input();if(null!==t){var e=t.get();if(void 0!==e){var n=this._mapInlet.input();if(null!==n){var r=n.get(e);if(void 0!==r)return r}}}return i.Value.absent()},n}(e.AbstractOutlet),m=function(t){function n(){var n=t.call(this)||this;return n._operand1Inlet=new e.OutletInlet(n),n._operand2Inlet=new e.OutletInlet(n),n}return l(n,t),n.prototype.operand1Inlet=function(){return this._operand1Inlet},n.prototype.operand2Inlet=function(){return this._operand2Inlet},n.prototype.get=function(){var t=this._operand1Inlet.input(),e=this._operand2Inlet.input();if(null!==t&&null!==e){var n=t.get(),r=e.get();if(void 0!==n&&void 0!==r)return this.evaluate(n,r).toValue()}return i.Value.absent()},n}(e.AbstractOutlet),v=function(t){function n(){var n=t.call(this)||this;return n._operandInlet=new e.OutletInlet(n),n}return l(n,t),n.prototype.operandInlet=function(){return this._operandInlet},n.prototype.get=function(){var t=this._operandInlet.input();if(null!==t){var e=t.get();if(void 0!==e)return this.evaluate(e).toValue()}return i.Value.absent()},n}(e.AbstractOutlet),I=function(t){function n(){var n=t.call(this)||this;return n._ifInlet=new e.OutletInlet(n),n._thenInlet=new e.OutletInlet(n),n._elseInlet=new e.OutletInlet(n),n}return l(n,t),n.prototype.ifInlet=function(){return this._ifInlet},n.prototype.thenInlet=function(){return this._thenInlet},n.prototype.elseInlet=function(){return this._elseInlet},n.prototype.get=function(){var t=this._ifInlet.input();if(null!==t){var e=t.get();if(void 0!==e)if(e.booleanValue(!1)){var n=this._thenInlet.input();if(null!==n){var r=n.get();if(void 0!==r)return r}}else{var o=this._elseInlet.input();if(null!==o){var u=o.get();if(void 0!==u)return u}}}return i.Value.absent()},n}(e.AbstractOutlet),O=function(t){function n(){var n=t.call(this)||this;return n._operand1Inlet=new e.OutletInlet(n),n._operand2Inlet=new e.OutletInlet(n),n}return l(n,t),n.prototype.operand1Inlet=function(){return this._operand1Inlet},n.prototype.operand2Inlet=function(){return this._operand2Inlet},n.prototype.get=function(){var t=this._operand1Inlet.input(),e=null!==t?t.get():void 0;if(void 0!==e&&e.booleanValue(!1))return e;var n=this._operand2Inlet.input(),r=null!==n?n.get():void 0;return void 0!==r?r:i.Value.absent()},n}(e.AbstractOutlet),_=function(t){function n(){var n=t.call(this)||this;return n._operand1Inlet=new e.OutletInlet(n),n._operand2Inlet=new e.OutletInlet(n),n}return l(n,t),n.prototype.operand1Inlet=function(){return this._operand1Inlet},n.prototype.operand2Inlet=function(){return this._operand2Inlet},n.prototype.get=function(){var t=this._operand1Inlet.input(),e=null!==t?t.get():void 0;if(void 0!==e){if(e.booleanValue(!1)){var n=this._operand2Inlet.input(),r=null!==n?n.get():void 0;if(void 0!==r)return r}return e}return i.Value.absent()},n}(e.AbstractOutlet),w=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return l(e,t),e.prototype.evaluate=function(t,e){return t.bitwiseOr(e)},e}(m),g=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return l(e,t),e.prototype.evaluate=function(t,e){return t.bitwiseXor(e)},e}(m),b=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return l(e,t),e.prototype.evaluate=function(t,e){return t.bitwiseAnd(e)},e}(m),S=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return l(e,t),e.prototype.evaluate=function(t,e){return t.lt(e)},e}(m),V=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return l(e,t),e.prototype.evaluate=function(t,e){return t.le(e)},e}(m),A=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return l(e,t),e.prototype.evaluate=function(t,e){return t.eq(e)},e}(m),R=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return l(e,t),e.prototype.evaluate=function(t,e){return t.ne(e)},e}(m),E=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return l(e,t),e.prototype.evaluate=function(t,e){return t.ge(e)},e}(m),C=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return l(e,t),e.prototype.evaluate=function(t,e){return t.gt(e)},e}(m),K=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return l(e,t),e.prototype.evaluate=function(t,e){return t.plus(e)},e}(m),B=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return l(e,t),e.prototype.evaluate=function(t,e){return t.minus(e)},e}(m),F=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return l(e,t),e.prototype.evaluate=function(t,e){return t.times(e)},e}(m),k=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return l(e,t),e.prototype.evaluate=function(t,e){return t.divide(e)},e}(m),x=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return l(e,t),e.prototype.evaluate=function(t,e){return t.modulo(e)},e}(m),M=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return l(e,t),e.prototype.evaluate=function(t){return t.not()},e}(v),T=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return l(e,t),e.prototype.evaluate=function(t){return t.bitwiseNot()},e}(v),G=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return l(e,t),e.prototype.evaluate=function(t){return t.negative()},e}(v),N=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return l(e,t),e.prototype.evaluate=function(t){return t.positive()},e}(v),z=function(t){function n(n){var r=t.call(this)||this;return r._scope=n,r._funcInlet=new e.OutletInlet(r),r._argsInlet=new e.OutletInlet(r),r}return l(n,t),n.prototype.funcInlet=function(){return this._funcInlet},n.prototype.argsInlet=function(){return this._argsInlet},n.prototype.get=function(){var t=this._funcInlet.input(),e=this._argsInlet.input();if(null!==t&&null!==e){var n=t.get();if(n instanceof i.Func){var r=e.get();if(void 0!==r){var o=new i.Interpreter;return o.pushScope(this._scope),n.invoke(r,o,void 0).toValue()}}}return i.Value.absent()},n}(e.AbstractOutlet),D=function(){function t(){}return t.compile=function(n,r){if(r instanceof e.KeyOutlet){var o=r.get();e.Outlet.is(o)&&(r=o)}if(n.isConstant())return new e.ValueInput(n);if(n instanceof i.Selector)return t.compileSelector(n,r);if(n instanceof i.Operator)return t.compileOperator(n,r);throw new TypeError(""+n)},t.compileSelector=function(e,n){if(e instanceof i.IdentitySelector)return t.compileIdentitySelector(n);if(e instanceof i.GetSelector)return t.compileGetSelector(e,n);if(e instanceof i.GetAttrSelector)return t.compileGetAttrSelector(e,n);if(e instanceof i.GetItemSelector)return t.compileGetItemSelector(e,n);if(e instanceof i.KeysSelector)return t.compileKeysSelector(n);if(e instanceof i.ValuesSelector)return t.compileValuesSelector(n);if(e instanceof i.ChildrenSelector)return t.compileChildrenSelector(n);if(e instanceof i.DescendantsSelector)return t.compileDescendantsSelector(n);if(e instanceof i.FilterSelector)return t.compileFilterSelector(e,n);throw new TypeError(""+e)},t.compileIdentitySelector=function(t){return t},t.compileGetSelector=function(n,r){var i=n.accessor();if(!i.isConstant()){var u=new y;l=t.compile(i,r);return u.keyInlet().bindInput(l),u.mapInlet().bindInput(r),u}if(o.is(r)){if(null!==(l=r.outlet(i)))return t.compile(n.then(),l)}else if(e.StreamletScope.is(r)){var l,a=i.stringValue(void 0);if(void 0!==a)if(null!==(l=r.outlet(a)))return t.compile(n.then(),l)}return null},t.compileGetAttrSelector=function(t,e){throw new Error},t.compileGetItemSelector=function(t,e){throw new Error},t.compileKeysSelector=function(t){throw new Error},t.compileValuesSelector=function(t){throw new Error},t.compileChildrenSelector=function(t){throw new Error},t.compileDescendantsSelector=function(t){throw new Error},t.compileFilterSelector=function(t,e){throw new Error},t.compileOperator=function(e,n){if(e instanceof i.ConditionalOperator)return t.compileConditionalOperator(e,n);if(e instanceof i.BinaryOperator)return t.compileBinaryOperator(e,n);if(e instanceof i.UnaryOperator)return t.compileUnaryOperator(e,n);if(e instanceof i.InvokeOperator)return t.compileInvokeOperator(e,n);throw new TypeError(""+e)},t.compileConditionalOperator=function(e,n){var r=new I,i=e.ifTerm().toValue(),o=e.thenTerm().toValue(),u=e.elseTerm().toValue(),l=t.compile(i,n),a=t.compile(o,n),p=t.compile(u,n);return r.ifInlet().bindInput(l),r.thenInlet().bindInput(a),r.elseInlet().bindInput(p),r},t.compileBinaryOperator=function(e,n){if(e instanceof i.OrOperator)return t.compileOrOperator(e,n);if(e instanceof i.AndOperator)return t.compileAndOperator(e,n);if(e instanceof i.BitwiseOrOperator)return t.compileBitwiseOrOperator(e,n);if(e instanceof i.BitwiseXorOperator)return t.compileBitwiseXorOperator(e,n);if(e instanceof i.BitwiseAndOperator)return t.compileBitwiseAndOperator(e,n);if(e instanceof i.LtOperator)return t.compileLtOperator(e,n);if(e instanceof i.LeOperator)return t.compileLeOperator(e,n);if(e instanceof i.EqOperator)return t.compileEqOperator(e,n);if(e instanceof i.NeOperator)return t.compileNeOperator(e,n);if(e instanceof i.GeOperator)return t.compileGeOperator(e,n);if(e instanceof i.GtOperator)return t.compileGtOperator(e,n);if(e instanceof i.PlusOperator)return t.compilePlusOperator(e,n);if(e instanceof i.MinusOperator)return t.compileMinusOperator(e,n);if(e instanceof i.TimesOperator)return t.compileTimesOperator(e,n);if(e instanceof i.DivideOperator)return t.compileDivideOperator(e,n);if(e instanceof i.ModuloOperator)return t.compileModuloOperator(e,n);throw new TypeError(""+e)},t.compileBinaryOutlet=function(e,n,r){var i=e.operand1().toValue(),o=e.operand2().toValue(),u=t.compile(i,r),l=t.compile(o,r);return n.operand1Inlet().bindInput(u),n.operand2Inlet().bindInput(l),n},t.compileOrOperator=function(e,n){var r=new O,i=e.operand1().toValue(),o=e.operand2().toValue(),u=t.compile(i,n),l=t.compile(o,n);return r.operand1Inlet().bindInput(u),r.operand2Inlet().bindInput(l),r},t.compileAndOperator=function(e,n){var r=new _,i=e.operand1().toValue(),o=e.operand2().toValue(),u=t.compile(i,n),l=t.compile(o,n);return r.operand1Inlet().bindInput(u),r.operand2Inlet().bindInput(l),r},t.compileBitwiseOrOperator=function(e,n){return t.compileBinaryOutlet(e,new w,n)},t.compileBitwiseXorOperator=function(e,n){return t.compileBinaryOutlet(e,new g,n)},t.compileBitwiseAndOperator=function(e,n){return t.compileBinaryOutlet(e,new b,n)},t.compileLtOperator=function(e,n){return t.compileBinaryOutlet(e,new S,n)},t.compileLeOperator=function(e,n){return t.compileBinaryOutlet(e,new V,n)},t.compileEqOperator=function(e,n){return t.compileBinaryOutlet(e,new A,n)},t.compileNeOperator=function(e,n){return t.compileBinaryOutlet(e,new R,n)},t.compileGeOperator=function(e,n){return t.compileBinaryOutlet(e,new E,n)},t.compileGtOperator=function(e,n){return t.compileBinaryOutlet(e,new C,n)},t.compilePlusOperator=function(e,n){return t.compileBinaryOutlet(e,new K,n)},t.compileMinusOperator=function(e,n){return t.compileBinaryOutlet(e,new B,n)},t.compileTimesOperator=function(e,n){return t.compileBinaryOutlet(e,new F,n)},t.compileDivideOperator=function(e,n){return t.compileBinaryOutlet(e,new k,n)},t.compileModuloOperator=function(e,n){return t.compileBinaryOutlet(e,new x,n)},t.compileUnaryOperator=function(e,n){if(e instanceof i.NotOperator)return t.compileNotOperator(e,n);if(e instanceof i.BitwiseNotOperator)return t.compileBitwiseNotOperator(e,n);if(e instanceof i.NegativeOperator)return t.compileNegativeOperator(e,n);if(e instanceof i.PositiveOperator)return t.compilePositiveOperator(e,n);throw new TypeError(""+e)},t.compileUnaryOutlet=function(e,n,r){var i=e.operand().toValue(),o=t.compile(i,r);return n.operandInlet().bindInput(o),n},t.compileNotOperator=function(e,n){return t.compileUnaryOutlet(e,new M,n)},t.compileBitwiseNotOperator=function(e,n){return t.compileUnaryOutlet(e,new T,n)},t.compileNegativeOperator=function(e,n){return t.compileUnaryOutlet(e,new G,n)},t.compilePositiveOperator=function(e,n){return t.compileUnaryOutlet(e,new N,n)},t.compileInvokeOperator=function(e,n){var r=e.func(),i=e.args(),o=new z(n),u=t.compile(r,n),l=t.compile(i,n);return o.funcInlet().bindInput(u),o.argsInlet().bindInput(l),o},t}();o.Dataflow=D,t.AbstractRecordOutlet=a,t.AbstractRecordStreamlet=s,t.AndOutlet=_,t.BinaryOutlet=m,t.BitwiseAndOutlet=b,t.BitwiseNotOutlet=T,t.BitwiseOrOutlet=w,t.BitwiseXorOutlet=g,t.ConditionalOutlet=I,t.Dataflow=D,t.DivideOutlet=k,t.EqOutlet=A,t.GeOutlet=E,t.GetOutlet=y,t.GtOutlet=C,t.InvokeOutlet=z,t.LeOutlet=V,t.LtOutlet=S,t.MinusOutlet=B,t.ModuloOutlet=x,t.NeOutlet=R,t.NegativeOutlet=G,t.NotOutlet=M,t.OrOutlet=O,t.PlusOutlet=K,t.PositiveOutlet=N,t.RecordFieldUpdater=c,t.RecordModel=h,t.RecordOutlet=o,t.RecordScope=d,t.RecordStreamlet=p,t.TimesOutlet=F,t.Transmuter=f,t.UnaryOutlet=v,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=swim-dataflow.min.js.map